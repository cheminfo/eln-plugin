(function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?this:self:global:window,t.elnPlugin=e()}})(function(){var e=Math.ceil,t=Math.round,n=Number.isInteger,o=Math.max,r=Math.sin,u=Math.sqrt,s=Number.MAX_VALUE,l=Number.MIN_VALUE,a=Math.log,p=Math.floor,f=Math.pow,d=String.fromCharCode,_=Math.min,c=Math.exp,C=Math.abs,i,h,m;return function p(d,e,t){function r(i,o){if(!e[i]){if(!d[i]){var s="function"==typeof require&&require;if(!o&&s)return s(i,!0);if(n)return n(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var c=e[i]={exports:{}};d[i][0].call(c.exports,function(t){var e=d[i][1][t];return r(e?e:t)},c,c.exports,p,d,e,t)}return e[i].exports}for(var n="function"==typeof require&&require,i=0;i<t.length;i++)r(t[i]);return r}({1:[function(e,t,n){"use strict";function o(e){var t=e.length;if(0<t%4)throw new Error("Invalid string. Length must be a multiple of 4");return"="===e[t-2]?2:"="===e[t-1]?1:0}function s(e){return l[63&e>>18]+l[63&e>>12]+l[63&e>>6]+l[63&e]}function r(e,t,n){for(var o=[],r=t,i;r<n;r+=3)i=(e[r]<<16)+(e[r+1]<<8)+e[r+2],o.push(s(i));return o.join("")}n.byteLength=function(e){return 3*e.length/4-o(e)},n.toByteArray=function(e){var t=e.length,n,i,s,r,l;r=o(e),l=new p(3*t/4-r),i=0<r?t-4:t;var d=0;for(n=0;n<i;n+=4)s=a[e.charCodeAt(n)]<<18|a[e.charCodeAt(n+1)]<<12|a[e.charCodeAt(n+2)]<<6|a[e.charCodeAt(n+3)],l[d++]=255&s>>16,l[d++]=255&s>>8,l[d++]=255&s;return 2===r?(s=a[e.charCodeAt(n)]<<2|a[e.charCodeAt(n+1)]>>4,l[d++]=255&s):1===r&&(s=a[e.charCodeAt(n)]<<10|a[e.charCodeAt(n+1)]<<4|a[e.charCodeAt(n+2)]>>2,l[d++]=255&s>>8,l[d++]=255&s),l},n.fromByteArray=function(e){for(var t=e.length,n=t%3,o="",s=[],a=16383,p=0,i=t-n,d;p<i;p+=a)s.push(r(e,p,p+a>i?i:p+a));return 1==n?(d=e[t-1],o+=l[d>>2],o+=l[63&d<<4],o+="=="):2==n&&(d=(e[t-2]<<8)+e[t-1],o+=l[d>>10],o+=l[63&d>>4],o+=l[63&d<<2],o+="="),s.push(o),s.join("")};for(var l=[],a=[],p="undefined"==typeof Uint8Array?Array:Uint8Array,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=0,i=d.length;c<i;++c)l[c]=d[c],a[d.charCodeAt(c)]=c;a[45]=62,a[95]=63},{}],2:[function(e,t){"use strict";t.exports=function(e,t,i,n,o){var s,r;if(void 0===n)n=0;else if(n|=0,0>n||n>=e.length)throw new RangeError("invalid lower bound");if(void 0===o)o=e.length-1;else if(o|=0,o<n||o>=e.length)throw new RangeError("invalid upper bound");for(;n<=o;)if(s=n+(o-n>>1),r=+i(e[s],t,s,e),0>r)n=s+1;else if(0<r)o=s-1;else return s;return~n}},{}],3:[function(e,t){"use strict";function n(e,t){t=t||{};var n=new Date,r;if(e.ser||e["2rr"])r=s(e,t);else if(e["1r"]||e["1i"]||e.fid)r=o(e,t);else throw new RangeError("The current files are invalid");r.twoD&&!t.noContours&&(p(r),r.profiling&&r.profiling.push({action:"Finished countour plot calculation",time:new Date-n}),!t.keepSpectra&&delete r.spectra);var l=r.spectra;if(t.xy&&0<l.length)for(var a=0,i;a<l.length;a++)if(i=l[a],0<i.data.length)for(var d=0;d<i.data.length;d++){for(var c=i.data[d],u={x:Array(c.length/2),y:Array(c.length/2)},h=0;h<c.length;h+=2)u.x[h/2]=c[h],u.y[h/2]=c[h+1];i.data[d]=u}return r}function o(e,t){for(var n=l(e.procs,t),o=l(e.acqus,t),s=Object.keys(o.info),p=0,i;p<s.length;p++)i=s[p],void 0===n.info[i]&&(n.info[i]=o.info[i]);return e["1r"]||e["1i"]?(e["1r"]&&r(e["1r"],n,"1r",!0),e["1i"]&&r(e["1i"],n,"1i",!1)):e.fid&&a(e.fid,n),n}function s(e,t){var n,o,s;if(e["2rr"]){for(var p=l(e.procs,t),d=l(e.acqus,t),c=Object.keys(d.info),u=0,i;u<c.length;u++)i=c[u],void 0===p.info[i]&&(p.info[i]=d.info[i]);d=l(e.proc2s,t),p.info.nbSubSpectra=d.info.$SI=parseInt(d.info.$SI),n=d.info.$SF=parseFloat(d.info.$SF),o=d.info.$SWP=parseFloat(d.info.$SWP),s=d.info.$OFFSET=parseFloat(d.info.$OFFSET)}else e.ser&&(p=l(e.acqus,t),d=l(e.acqu2s,t),p.info.nbSubSpectra=d.info.$SI=parseInt(d.info.$TD),p.info.$SI=parseInt(p.info.$TD),o=d.info.$SW,p.info.$SWP=p.info.$SWH,p.info.$SF=parseFloat(d.info.$SFO1),p.info.$OFFSET=0,n=d.info.$SFO1=parseFloat(d.info.$SFO1),n=1,s=0,p.info.$AXNUC=p.info.$NUC1,d.info.$AXNUC=d.info.$NUC1);p.info.firstY=s,p.info.lastY=s-o/n,p.info.$BF2=n,p.info.$SFO1=n;var h=p.info.nbSubSpectra,m=p.info.firstY,g=(p.info.lastY-p.info.firstY)/(h-1);e["2rr"]?r(e["2rr"],p,"2rr",!0):e.ser&&a(e.ser,p,"ser",!0);for(var u=0;u<h;u++)m+=g,p.spectra[u].pageValue=m;e.ser?"TYPE_2DNMR_FID":"TYPE_2DNMR_SPECTRUM";return p.info["2D_Y_NUCLEUS"]=d.info.$AXNUC,p.info["2D_X_NUCLEUS"]=p.info.$AXNUC,p.info["2D_Y_FRECUENCY"]=n,p.info["2D_Y_OFFSET"]=s,p.info["2D_X_FRECUENCY"]=p.info.$SF,p.info["2D_X_OFFSET"]=p.info.$OFFSET,p.twoD=!0,p}function r(e,t,n,o){var s=t.info.$SI=parseInt(t.info.$SI),r=parseFloat(t.info.$SWP),l=parseFloat(t.info.$SF),a=l,p=t.shiftOffsetVal;t.info.observeFrequency=l,t.info.$BF1=a,t.info.$SFO1=l,t.info.brukerReference=a;var d=parseInt(t.info.$BYTORDP);d=d?0:1;var c=t.info.nbSubSpectra?t.info.nbSubSpectra:1;d?e.setLittleEndian():e.setBigEndian();for(var u=0;u<c;u++){var i={dataType:"NMR Spectrum",dataTable:"(X++(R..R))",nbPoints:s,firstX:p,lastX:p-r/l,xUnit:"PPM",yUnit:"Arbitrary",data:[Array(2*s)],isXYdata:!0,observeFrequency:l,title:t.info.TITLE,deltaX:-(r/l)/(s-1)},h=p,m=i.deltaX;if(o)for(var g=0;g<s;++g)i.data[0][2*g]=h,i.data[0][2*g+1]=e.readInt32(),(null===i.data[0][2*g+1]||isNaN(i.data[0][2*g+1]))&&(i.data[0][2*g+1]=0),h+=m;else for(g=s-1;0<=g;--g)i.data[0][2*g]=h,i.data[0][2*g+1]=e.readInt32(),(null===i.data[0][2*g+1]||isNaN(i.data[0][2*g+1]))&&(i.data[0][2*g+1]=0),h+=m;t.spectra.push(i)}}function l(e,t){var i=/.*/;return t.keepRecordsRegExp&&(i=t.keepRecordsRegExp),u.convert(e,{keepRecordsRegExp:i})}function a(e,t){var n=t.info.$TD=parseInt(t.info.$TD),o=t.info.$SWH=parseFloat(t.info.$SWH),s=t.info.$SW=parseFloat(t.info.$SW),r=t.info.$SFO1=parseFloat(t.info.$SFO1),l=parseFloat(t.info.$BF1);t.info.$BF1=l;var a=s,p=a/(n-1),d=parseInt(t.info.$BYTORDP);d=d?0:1,d?e.setLittleEndian():e.setBigEndian();var c=t.info.nbSubSpectra?t.info.nbSubSpectra:1;t.spectra=Array(c);for(var u=0,h;u<c/2;u++){h={dataType:"NMR FID",dataTable:"(X++(R..R))",nbPoints:n,firstX:0,lastX:a,nucleus:t.info.$NUC1?t.info.$NUC1:void 0,xUnit:"Sec",yUnit:"Arbitrary",data:[Array(2*n)],isXYdata:!0,observeFrequency:r,title:t.info.TITLE,deltaX:p},t.spectra[2*u]=h,h={dataType:"NMR FID",dataTable:"(X++(I..I))",nbPoints:n,firstX:0,lastX:a,nucleus:t.info.$NUC1?t.info.$NUC1:void 0,xUnit:"Sec",yUnit:"Arbitrary",data:[Array(2*n)],isXYdata:!0,observeFrequency:r,title:t.info.TITLE,deltaX:p},t.spectra[2*u+1]=h;for(var m=0,g=0,i;e.available(8)&&g<n;g++,m=g*p)i=e.readInt32(),(null===i||isNaN(i))&&(i=0),t.spectra[2*u].data[0][2*g+1]=i,t.spectra[2*u].data[0][2*g]=m,i=e.readInt32(),(null===i||isNaN(i))&&(i=0),t.spectra[2*u+1].data[0][2*g+1]=i,t.spectra[2*u+1].data[0][2*g]=m;for(;g<n;g++,m=g*p)t.spectra[2*u].data[0][2*g+1]=0,t.spectra[2*u].data[0][2*g]=m,t.spectra[2*u+1].data[0][2*g+1]=0,t.spectra[2*u+1].data[0][2*g]=m}}function i(e){for(var t=0,n=e[0].data[0][0],o=n,s=e.length,r=e[0].data[0].length/2,l=Array(s),a=0;a<s;a++){l[a]=Array(r);for(var i=0;i<r;i++)l[a][i]=e[a].data[0][2*i+1],l[a][i]<n&&(n=e[a].data[0][2*i+1]),l[a][i]>o&&(o=e[a].data[0][2*i+1]),0!==a&&0!==i&&(t+=C(l[a][i]-l[a][i-1])+C(l[a][i]-l[a-1][i]))}return{z:l,minX:e[0].data[0][0],maxX:e[0].data[0][e[0].data[0].length-2],minY:e[0].pageValue,maxY:e[s-1].pageValue,minZ:n,maxZ:o,noise:t/(2*((s-1)*(r-1)))}}function p(e){var t=i(e.spectra);e.contourLines=d(t),delete t.z,e.minMax=t}function d(e){for(var t=e.noise,n=e.z,o=[],s=7,r=new Float32Array(4),l=[],a=n.length,p=n[0].length,d=e.minX,u=e.maxX,h=(u-d)/(p-1),m=e.minY,g=e.maxY,f=(g-m)/(a-1),y=e.minZ,x=e.maxZ,b=0,_,k,j,w,C,v;b<2*s;b++){v={},o.push(v);var S=b%2;C=0==S?(x-5*t)*c(b/2-s)+5*t:-(x-5*t)*c(b/2-s)-5*t;var D=[];if(v.zValue=C,v.lines=D,!(C<=y||C>=x))for(var E=0;E<a-1;E++)for(var I=0;I<p-1;I++){r[0]=n[E][I],r[1]=n[E][I+1],r[2]=n[E+1][I],r[3]=n[E+1][I+1];for(var H=0;4>H;H++)l[H]=r[H]>C;l[0]!==l[1]&&l[0]!==l[2]&&(_=I+(C-r[0])/(r[1]-r[0]),k=E,j=I,w=E+(C-r[0])/(r[2]-r[0]),D.push(_*h+d,k*f+m,j*h+d,w*f+m)),l[3]!==l[1]&&l[3]!==l[2]&&(_=I+1,k=E+1-(C-r[3])/(r[1]-r[3]),j=I+1-(C-r[3])/(r[2]-r[3]),w=E+1,D.push(_*h+d,k*f+m,j*h+d,w*f+m)),l[1]!==l[2]&&(_=I+1-(C-r[1])/(r[2]-r[1]),k=E+(C-r[1])/(r[2]-r[1]),l[1]!==l[0]&&(j=I+1-(C-r[1])/(r[0]-r[1]),w=E,D.push(_*h+d,k*f+m,j*h+d,w*f+m)),l[2]!==l[0]&&(j=I,w=E+1-(C-r[2])/(r[0]-r[2]),D.push(_*h+d,k*f+m,j*h+d,w*f+m)),l[1]!==l[3]&&(j=I+1,w=E+(C-r[1])/(r[3]-r[1]),D.push(_*h+d,k*f+m,j*h+d,w*f+m)),l[2]!==l[3]&&(j=I+(C-r[2])/(r[3]-r[2]),w=E+1,D.push(_*h+d,k*f+m,j*h+d,w*f+m)))}}return{minX:e.minX,maxX:e.maxX,minY:e.minY,maxY:e.maxY,segments:o}}var u=e("jcampconverter"),h=e("iobuffer"),m=e("jszip"),g=1,f=2;t.exports={convertZip:function(e,t){t=t||{};var o=new m;o.load(e,t);for(var s={ser:g,fid:g,acqus:f,acqu2s:f,procs:f,proc2s:f,"1r":g,"1i":g,"2rr":g},r=o.filter(function(e){return 0<=e.indexOf("ser")||0<=e.indexOf("fid")||0<=e.indexOf("1r")||0<=e.indexOf("2rr")}),l=Array(r.length),a=0;a<r.length;++a){var i=r[a].name.length,p=r[a].name;p=p.substr(0,p.lastIndexOf("/")+1);var d=o.folder(p),c=d.filter(function(e){return!!s[e]}),u={};0<=p.indexOf("pdata")&&(u.acqus=o.file(p.replace(/pdata\/[0-9]\//,"acqus")).asText());for(var y=0;y<c.length;++y){var x=c[y].name.lastIndexOf("/"),p=c[y].name.substr(x+1);u[p]=s[p]===g?new h(c[y].asArrayBuffer()):c[y].asText()}l[a]={filename:r[a].name,value:n(u,t)}}return l},converFolder:n}},{iobuffer:9,jcampconverter:10,jszip:21}],4:[function(e,t,i){"use strict";function n(e){if(e>Q)throw new RangeError("Invalid typed array length");var t=new Uint8Array(e);return t.__proto__=o.prototype,t}function o(e,t,i){if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return a(e)}return s(e,t,i)}function s(e,t,i){if("number"==typeof e)throw new TypeError("\"value\" argument must not be a number");return e instanceof ArrayBuffer?u(e,t,i):"string"==typeof e?p(e,t):h(e)}function r(e){if("number"!=typeof e)throw new TypeError("\"size\" argument must be a number");else if(0>e)throw new RangeError("\"size\" argument must not be negative")}function l(e,t,i){return r(e),0>=e?n(e):void 0===t?n(e):"string"==typeof i?n(e).fill(t,i):n(e).fill(t)}function a(e){return r(e),n(0>e?0:0|m(e))}function p(e,t){if(("string"!=typeof t||""===t)&&(t="utf8"),!o.isEncoding(t))throw new TypeError("\"encoding\" must be a valid string encoding");var i=0|g(e,t),s=n(i),r=s.write(e,t);return r!==i&&(s=s.slice(0,r)),s}function c(e){for(var t=0>e.length?0:0|m(e.length),o=n(t),s=0;s<t;s+=1)o[s]=255&e[s];return o}function u(e,t,i){if(0>t||e.byteLength<t)throw new RangeError("'offset' is out of bounds");if(e.byteLength<t+(i||0))throw new RangeError("'length' is out of bounds");var n;return n=void 0===t&&void 0===i?new Uint8Array(e):void 0===i?new Uint8Array(e,t):new Uint8Array(e,t,i),n.__proto__=o.prototype,n}function h(e){if(o.isBuffer(e)){var t=0|m(e.length),i=n(t);return 0===i.length?i:(e.copy(i,0,0,t),i)}if(e){if($(e)||"length"in e)return"number"!=typeof e.length||Z(e.length)?n(0):c(e);if("Buffer"===e.type&&Array.isArray(e.data))return c(e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function m(e){if(e>=Q)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Q.toString(16)+" bytes");return 0|e}function g(e,t){if(o.isBuffer(e))return e.length;if($(e)||e instanceof ArrayBuffer)return e.byteLength;"string"!=typeof e&&(e=""+e);var i=e.length;if(0===i)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":case void 0:return Y(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return V(e).length;default:if(n)return Y(e).length;t=(""+t).toLowerCase(),n=!0;}}function y(e,t,i){var n=!1;if((void 0===t||0>t)&&(t=0),t>this.length)return"";if((void 0===i||i>this.length)&&(i=this.length),0>=i)return"";if(i>>>=0,t>>>=0,i<=t)return"";for(e||(e="utf8");;)switch(e){case"hex":return F(this,t,i);case"utf8":case"utf-8":return I(this,t,i);case"ascii":return A(this,t,i);case"latin1":case"binary":return z(this,t,i);case"base64":return E(this,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,t,i);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0;}}function x(e,t,n){var o=e[t];e[t]=e[n],e[n]=o}function b(e,t,i,n,s){if(0===e.length)return-1;if("string"==typeof i?(n=i,i=0):2147483647<i?i=2147483647:-2147483648>i&&(i=-2147483648),i=+i,Z(i)&&(i=s?0:e.length-1),0>i&&(i=e.length+i),i>=e.length){if(s)return-1;i=e.length-1}else if(0>i)if(s)i=0;else return-1;if("string"==typeof t&&(t=o.from(t,n)),o.isBuffer(t))return 0===t.length?-1:k(e,t,i,n,s);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?s?Uint8Array.prototype.indexOf.call(e,t,i):Uint8Array.prototype.lastIndexOf.call(e,t,i):k(e,[t],i,n,s);throw new TypeError("val must be string, number or Buffer")}function k(e,t,n,o,s){function r(e,t){return 1==l?e[t]:e.readUInt16BE(t*l)}var l=1,a=e.length,p=t.length;if(void 0!==o&&(o=(o+"").toLowerCase(),"ucs2"===o||"ucs-2"===o||"utf16le"===o||"utf-16le"===o)){if(2>e.length||2>t.length)return-1;l=2,a/=2,p/=2,n/=2}var d;if(s){var i=-1;for(d=n;d<a;d++)if(r(e,d)!==r(t,-1==i?0:d-i))-1!=i&&(d-=d-i),i=-1;else if(-1==i&&(i=d),d-i+1===p)return i*l}else for(n+p>a&&(n=a-p),d=n;0<=d;d--){for(var c=!0,u=0;u<p;u++)if(r(e,d+u)!==r(t,u)){c=!1;break}if(c)return d}return-1}function j(e,t,n,o){n=+n||0;var s=e.length-n;o?(o=+o,o>s&&(o=s)):o=s;var r=t.length;if(0!=r%2)throw new TypeError("Invalid hex string");o>r/2&&(o=r/2);for(var l=0,i;l<o;++l){if(i=parseInt(t.substr(2*l,2),16),Z(i))return l;e[n+l]=i}return l}function w(e,t,i,n){return q(Y(t,e.length-i),e,i,n)}function C(e,t,i,n){return q(U(t),e,i,n)}function v(e,t,i,n){return C(e,t,i,n)}function S(e,t,i,n){return q(V(t),e,i,n)}function D(e,t,i,n){return q(B(t,e.length-i),e,i,n)}function E(e,t,i){return 0===t&&i===e.length?W.fromByteArray(e):W.fromByteArray(e.slice(t,i))}function I(e,t,n){n=_(e.length,n);for(var o=[],s=t;s<n;){var i=e[s],r=null,l=239<i?4:223<i?3:191<i?2:1;if(s+l<=n){var a,p,d,c;1==l?128>i&&(r=i):2==l?(a=e[s+1],128==(192&a)&&(c=(31&i)<<6|63&a,127<c&&(r=c))):3==l?(a=e[s+1],p=e[s+2],128==(192&a)&&128==(192&p)&&(c=(15&i)<<12|(63&a)<<6|63&p,2047<c&&(55296>c||57343<c)&&(r=c))):4==l?(a=e[s+1],p=e[s+2],d=e[s+3],128==(192&a)&&128==(192&p)&&128==(192&d)&&(c=(15&i)<<18|(63&a)<<12|(63&p)<<6|63&d,65535<c&&1114112>c&&(r=c))):void 0}null===r?(r=65533,l=1):65535<r&&(r-=65536,o.push(55296|1023&r>>>10),r=56320|1023&r),o.push(r),s+=l}return H(o)}function H(e){var t=e.length;if(t<=G)return d.apply(String,e);for(var n="",o=0;o<t;)n+=d.apply(String,e.slice(o,o+=G));return n}function A(e,t,n){var o="";n=_(e.length,n);for(var s=t;s<n;++s)o+=d(127&e[s]);return o}function z(e,t,n){var o="";n=_(e.length,n);for(var s=t;s<n;++s)o+=d(e[s]);return o}function F(e,t,n){var o=e.length;(!t||0>t)&&(t=0),(!n||0>n||n>o)&&(n=o);for(var s="",r=t;r<n;++r)s+=L(e[r]);return s}function R(e,t,n){for(var o=e.slice(t,n),s="",r=0;r<o.length;r+=2)s+=d(o[r]+256*o[r+1]);return s}function P(e,t,i){if(0!=e%1||0>e)throw new RangeError("offset is not uint");if(e+t>i)throw new RangeError("Trying to access beyond buffer length")}function T(e,t,i,n,s,r){if(!o.isBuffer(e))throw new TypeError("\"buffer\" argument must be a Buffer instance");if(t>s||t<r)throw new RangeError("\"value\" argument is out of bounds");if(i+n>e.length)throw new RangeError("Index out of range")}function O(e,t,i,n){if(i+n>e.length)throw new RangeError("Index out of range");if(0>i)throw new RangeError("Index out of range")}function M(e,t,i,n,o){return t=+t,i>>>=0,o||O(e,t,i,4,3.4028234663852886e38,-3.4028234663852886e38),J.write(e,t,i,n,23,4),i+4}function N(e,t,i,n,o){return t=+t,i>>>=0,o||O(e,t,i,8,1.7976931348623157e308,-1.7976931348623157e308),J.write(e,t,i,n,52,8),i+8}function X(e){if(e=e.trim().replace(K,""),2>e.length)return"";for(;0!=e.length%4;)e+="=";return e}function L(e){return 16>e?"0"+e.toString(16):e.toString(16)}function Y(e,t){t=t||Infinity;for(var n=e.length,o=null,s=[],r=0,i;r<n;++r){if(i=e.charCodeAt(r),55295<i&&57344>i){if(!o){if(56319<i){-1<(t-=3)&&s.push(239,191,189);continue}else if(r+1===n){-1<(t-=3)&&s.push(239,191,189);continue}o=i;continue}if(56320>i){-1<(t-=3)&&s.push(239,191,189),o=i;continue}i=(o-55296<<10|i-56320)+65536}else o&&-1<(t-=3)&&s.push(239,191,189);if(o=null,128>i){if(0>(t-=1))break;s.push(i)}else if(2048>i){if(0>(t-=2))break;s.push(192|i>>6,128|63&i)}else if(65536>i){if(0>(t-=3))break;s.push(224|i>>12,128|63&i>>6,128|63&i)}else if(1114112>i){if(0>(t-=4))break;s.push(240|i>>18,128|63&i>>12,128|63&i>>6,128|63&i)}else throw new Error("Invalid code point")}return s}function U(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}function B(e,t){for(var n=[],o=0,i,s,r;o<e.length&&!(0>(t-=2));++o)i=e.charCodeAt(o),s=i>>8,r=i%256,n.push(r),n.push(s);return n}function V(e){return W.toByteArray(X(e))}function q(e,t,n,o){for(var s=0;s<o&&!(s+n>=t.length||s>=e.length);++s)t[s+n]=e[s];return s}function $(e){return"function"==typeof ArrayBuffer.isView&&ArrayBuffer.isView(e)}function Z(e){return e!==e}var W=e("base64-js"),J=e("ieee754");i.Buffer=o,i.SlowBuffer=function(e){return+e!=e&&(e=0),o.alloc(+e)},i.INSPECT_MAX_BYTES=50;var Q=2147483647;i.kMaxLength=Q,o.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()}catch(t){return!1}}(),o.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),"undefined"!=typeof Symbol&&Symbol.species&&o[Symbol.species]===o&&Object.defineProperty(o,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),o.poolSize=8192,o.from=function(e,t,i){return s(e,t,i)},o.prototype.__proto__=Uint8Array.prototype,o.__proto__=Uint8Array,o.alloc=function(e,t,i){return l(e,t,i)},o.allocUnsafe=function(e){return a(e)},o.allocUnsafeSlow=function(e){return a(e)},o.isBuffer=function(e){return null!=e&&!0===e._isBuffer},o.compare=function(e,t){if(!o.isBuffer(e)||!o.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,s=t.length,r=0,i=_(n,s);r<i;++r)if(e[r]!==t[r]){n=e[r],s=t[r];break}return n<s?-1:s<n?1:0},o.isEncoding=function(e){switch((e+"").toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1;}},o.concat=function(e,t){if(!Array.isArray(e))throw new TypeError("\"list\" argument must be an Array of Buffers");if(0===e.length)return o.alloc(0);var n;if(t===void 0)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var i=o.allocUnsafe(t),s=0;for(n=0;n<e.length;++n){var r=e[n];if(!o.isBuffer(r))throw new TypeError("\"list\" argument must be an Array of Buffers");r.copy(i,s),s+=r.length}return i},o.byteLength=g,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var e=this.length;if(0!=e%2)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)x(this,t,t+1);return this},o.prototype.swap32=function(){var e=this.length;if(0!=e%4)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)x(this,t,t+3),x(this,t+1,t+2);return this},o.prototype.swap64=function(){var e=this.length;if(0!=e%8)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)x(this,t,t+7),x(this,t+1,t+6),x(this,t+2,t+5),x(this,t+3,t+4);return this},o.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?I(this,0,e):y.apply(this,arguments)},o.prototype.equals=function(e){if(!o.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===o.compare(this,e)},o.prototype.inspect=function(){var e="",t=i.INSPECT_MAX_BYTES;return 0<this.length&&(e=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(e+=" ... ")),"<Buffer "+e+">"},o.prototype.compare=function(e,t,n,s,r){if(!o.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===s&&(s=0),void 0===r&&(r=this.length),0>t||n>e.length||0>s||r>this.length)throw new RangeError("out of range index");if(s>=r&&t>=n)return 0;if(s>=r)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,s>>>=0,r>>>=0,this===e)return 0;for(var l=r-s,a=n-t,p=_(l,a),d=this.slice(s,r),c=e.slice(t,n),u=0;u<p;++u)if(d[u]!==c[u]){l=d[u],a=c[u];break}return l<a?-1:a<l?1:0},o.prototype.includes=function(e,t,i){return-1!==this.indexOf(e,t,i)},o.prototype.indexOf=function(e,t,i){return b(this,e,t,i,!0)},o.prototype.lastIndexOf=function(e,t,i){return b(this,e,t,i,!1)},o.prototype.write=function(e,t,i,n){if(void 0===t)n="utf8",i=this.length,t=0;else if(void 0===i&&"string"==typeof t)n=t,i=this.length,t=0;else if(isFinite(t))t>>>=0,isFinite(i)?(i>>>=0,void 0===n&&(n="utf8")):(n=i,i=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var o=this.length-t;if((void 0===i||i>o)&&(i=o),0<e.length&&(0>i||0>t)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var s=!1;;)switch(n){case"hex":return j(this,e,t,i);case"utf8":case"utf-8":return w(this,e,t,i);case"ascii":return C(this,e,t,i);case"latin1":case"binary":return v(this,e,t,i);case"base64":return S(this,e,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D(this,e,t,i);default:if(s)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),s=!0;}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var G=4096;o.prototype.slice=function(e,t){var i=this.length;e=~~e,t=void 0===t?i:~~t,0>e?(e+=i,0>e&&(e=0)):e>i&&(e=i),0>t?(t+=i,0>t&&(t=0)):t>i&&(t=i),t<e&&(t=e);var n=this.subarray(e,t);return n.__proto__=o.prototype,n},o.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||P(e,t,this.length);for(var o=this[e],s=1,r=0;++r<t&&(s*=256);)o+=this[e+r]*s;return o},o.prototype.readUIntBE=function(e,t,i){e>>>=0,t>>>=0,i||P(e,t,this.length);for(var n=this[e+--t],o=1;0<t&&(o*=256);)n+=this[e+--t]*o;return n},o.prototype.readUInt8=function(e,t){return e>>>=0,t||P(e,1,this.length),this[e]},o.prototype.readUInt16LE=function(e,t){return e>>>=0,t||P(e,2,this.length),this[e]|this[e+1]<<8},o.prototype.readUInt16BE=function(e,t){return e>>>=0,t||P(e,2,this.length),this[e]<<8|this[e+1]},o.prototype.readUInt32LE=function(e,t){return e>>>=0,t||P(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},o.prototype.readUInt32BE=function(e,t){return e>>>=0,t||P(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},o.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||P(e,t,this.length);for(var o=this[e],s=1,r=0;++r<t&&(s*=256);)o+=this[e+r]*s;return s*=128,o>=s&&(o-=f(2,8*t)),o},o.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||P(e,t,this.length);for(var o=t,i=1,s=this[e+--o];0<o&&(i*=256);)s+=this[e+--o]*i;return i*=128,s>=i&&(s-=f(2,8*t)),s},o.prototype.readInt8=function(e,t){return e>>>=0,t||P(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},o.prototype.readInt16LE=function(e,t){e>>>=0,t||P(e,2,this.length);var i=this[e]|this[e+1]<<8;return 32768&i?4294901760|i:i},o.prototype.readInt16BE=function(e,t){e>>>=0,t||P(e,2,this.length);var i=this[e+1]|this[e]<<8;return 32768&i?4294901760|i:i},o.prototype.readInt32LE=function(e,t){return e>>>=0,t||P(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},o.prototype.readInt32BE=function(e,t){return e>>>=0,t||P(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},o.prototype.readFloatLE=function(e,t){return e>>>=0,t||P(e,4,this.length),J.read(this,e,!0,23,4)},o.prototype.readFloatBE=function(e,t){return e>>>=0,t||P(e,4,this.length),J.read(this,e,!1,23,4)},o.prototype.readDoubleLE=function(e,t){return e>>>=0,t||P(e,8,this.length),J.read(this,e,!0,52,8)},o.prototype.readDoubleBE=function(e,t){return e>>>=0,t||P(e,8,this.length),J.read(this,e,!1,52,8)},o.prototype.writeUIntLE=function(e,t,n,o){if(e=+e,t>>>=0,n>>>=0,!o){var s=f(2,8*n)-1;T(this,e,t,n,s,0)}var r=1,l=0;for(this[t]=255&e;++l<n&&(r*=256);)this[t+l]=255&e/r;return t+n},o.prototype.writeUIntBE=function(e,t,n,o){if(e=+e,t>>>=0,n>>>=0,!o){var s=f(2,8*n)-1;T(this,e,t,n,s,0)}var r=n-1,i=1;for(this[t+r]=255&e;0<=--r&&(i*=256);)this[t+r]=255&e/i;return t+n},o.prototype.writeUInt8=function(e,t,i){return e=+e,t>>>=0,i||T(this,e,t,1,255,0),this[t]=255&e,t+1},o.prototype.writeUInt16LE=function(e,t,i){return e=+e,t>>>=0,i||T(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},o.prototype.writeUInt16BE=function(e,t,i){return e=+e,t>>>=0,i||T(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},o.prototype.writeUInt32LE=function(e,t,i){return e=+e,t>>>=0,i||T(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},o.prototype.writeUInt32BE=function(e,t,i){return e=+e,t>>>=0,i||T(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},o.prototype.writeIntLE=function(e,t,n,o){if(e=+e,t>>>=0,!o){var s=f(2,8*n-1);T(this,e,t,n,s-1,-s)}var r=0,i=1,l=0;for(this[t]=255&e;++r<n&&(i*=256);)0>e&&0==l&&0!==this[t+r-1]&&(l=1),this[t+r]=255&(e/i>>0)-l;return t+n},o.prototype.writeIntBE=function(e,t,n,o){if(e=+e,t>>>=0,!o){var s=f(2,8*n-1);T(this,e,t,n,s-1,-s)}var r=n-1,i=1,l=0;for(this[t+r]=255&e;0<=--r&&(i*=256);)0>e&&0==l&&0!==this[t+r+1]&&(l=1),this[t+r]=255&(e/i>>0)-l;return t+n},o.prototype.writeInt8=function(e,t,i){return e=+e,t>>>=0,i||T(this,e,t,1,127,-128),0>e&&(e=255+e+1),this[t]=255&e,t+1},o.prototype.writeInt16LE=function(e,t,i){return e=+e,t>>>=0,i||T(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},o.prototype.writeInt16BE=function(e,t,i){return e=+e,t>>>=0,i||T(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},o.prototype.writeInt32LE=function(e,t,i){return e=+e,t>>>=0,i||T(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},o.prototype.writeInt32BE=function(e,t,i){return e=+e,t>>>=0,i||T(this,e,t,4,2147483647,-2147483648),0>e&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},o.prototype.writeFloatLE=function(e,t,i){return M(this,e,t,!0,i)},o.prototype.writeFloatBE=function(e,t,i){return M(this,e,t,!1,i)},o.prototype.writeDoubleLE=function(e,t,i){return N(this,e,t,!0,i)},o.prototype.writeDoubleBE=function(e,t,i){return N(this,e,t,!1,i)},o.prototype.copy=function(e,t,n,o){if(n||(n=0),o||0===o||(o=this.length),t>=e.length&&(t=e.length),t||(t=0),0<o&&o<n&&(o=n),o===n)return 0;if(0===e.length||0===this.length)return 0;if(0>t)throw new RangeError("targetStart out of bounds");if(0>n||n>=this.length)throw new RangeError("sourceStart out of bounds");if(0>o)throw new RangeError("sourceEnd out of bounds");o>this.length&&(o=this.length),e.length-t<o-n&&(o=e.length-t+n);var s=o-n,r;if(this===e&&n<t&&t<o)for(r=s-1;0<=r;--r)e[r+t]=this[r+n];else if(1e3>s)for(r=0;r<s;++r)e[r+t]=this[r+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+s),t);return s},o.prototype.fill=function(e,t,n,s){if("string"==typeof e){if("string"==typeof t?(s=t,t=0,n=this.length):"string"==typeof n&&(s=n,n=this.length),1===e.length){var r=e.charCodeAt(0);256>r&&(e=r)}if(void 0!==s&&"string"!=typeof s)throw new TypeError("encoding must be a string");if("string"==typeof s&&!o.isEncoding(s))throw new TypeError("Unknown encoding: "+s)}else"number"==typeof e&&(e&=255);if(0>t||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;t>>>=0,n=n===void 0?this.length:n>>>0,e||(e=0);var l;if("number"==typeof e)for(l=t;l<n;++l)this[l]=e;else{var i=o.isBuffer(e)?e:new o(e,s),a=i.length;for(l=0;l<n-t;++l)this[l+t]=i[l%a]}return this};var K=/[^+/0-9A-Za-z-_]/g},{"base64-js":1,ieee754:8}],5:[function(e,t){"use strict";var i=Object.prototype.hasOwnProperty,n=Object.prototype.toString,o=function(e){return"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===n.call(e)},s=function(e){if(!e||"[object Object]"!==n.call(e))return!1;var t=i.call(e,"constructor"),o=e.constructor&&e.constructor.prototype&&i.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!t&&!o)return!1;for(var s in e);return"undefined"==typeof s||i.call(e,s)};t.exports=function e(){var t=arguments[0],n=1,i=arguments.length,r=!1,l,a,p,d,c,u;for("boolean"==typeof t?(r=t,t=arguments[1]||{},n=2):("object"!=typeof t&&"function"!=typeof t||null==t)&&(t={});n<i;++n)if(l=arguments[n],null!=l)for(a in l)p=t[a],d=l[a],t!==d&&(r&&d&&(s(d)||(c=o(d)))?(c?(c=!1,u=p&&o(p)?p:[]):u=p&&s(p)?p:{},t[a]=e(r,u,d)):"undefined"!=typeof d&&(t[a]=d));return t}},{}],6:[function(e,t){"use strict";t.exports=e("./lib/heap")},{"./lib/heap":7}],7:[function(e,t,n){"use strict";(function(){var e,o,s,r,l,a,d,c,u,h,m,g,f,y,x;s=p,h=_,o=function(e,t){return e<t?-1:e>t?1:0},u=function(e,t,i,n,r){var l;if(null==i&&(i=0),null==r&&(r=o),0>i)throw new Error("lo must be non-negative");for(null==n&&(n=e.length);i<n;)l=s((i+n)/2),0>r(t,e[l])?n=l:i=l+1;return[].splice.apply(e,[i,i-i].concat(t)),t},a=function(e,t,i){return null==i&&(i=o),e.push(t),y(e,0,e.length-1,i)},l=function(e,t){var i,n;return null==t&&(t=o),i=e.pop(),e.length?(n=e[0],e[0]=i,x(e,0,t)):n=i,n},c=function(e,t,i){var n;return null==i&&(i=o),n=e[0],e[0]=t,x(e,0,i),n},d=function(e,t,i){var n;return null==i&&(i=o),e.length&&0>i(e[0],t)&&(n=[e[0],t],t=n[0],e[0]=n[1],x(e,0,i)),t},r=function(e,t){var n,i,r,l,a,p;for(null==t&&(t=o),l=function(){p=[];for(var t=0,i=s(e.length/2);0<=i?t<i:t>i;0<=i?t++:t--)p.push(t);return p}.apply(this).reverse(),a=[],(i=0,r=l.length);i<r;i++)n=l[i],a.push(x(e,n,t));return a},f=function(e,t,i){var n;if(null==i&&(i=o),n=e.indexOf(t),-1!==n)return y(e,0,n,i),x(e,n,i)},m=function(e,t,i){var n,s,l,a,p;if(null==i&&(i=o),s=e.slice(0,t),!s.length)return s;for(r(s,i),p=e.slice(t),(l=0,a=p.length);l<a;l++)n=p[l],d(s,n,i);return s.sort(i).reverse()},g=function(e,t,n){var s,a,i,p,d,c,m,g,f,y;if(null==n&&(n=o),10*t<=e.length){if(p=e.slice(0,t).sort(n),!p.length)return p;for(i=p[p.length-1],g=e.slice(t),(d=0,m=g.length);d<m;d++)s=g[d],0>n(s,i)&&(u(p,s,0,null,n),p.pop(),i=p[p.length-1]);return p}for(r(e,n),y=[],(a=c=0,f=h(t,e.length));0<=f?c<f:c>f;a=0<=f?++c:--c)y.push(l(e,n));return y},y=function(e,t,i,n){var s,r,l;for(null==n&&(n=o),s=e[i];i>t;){if(l=i-1>>1,r=e[l],0>n(s,r)){e[i]=r,i=l;continue}break}return e[i]=s},x=function(e,t,i){var n,s,r,l,a;for(null==i&&(i=o),s=e.length,a=t,r=e[t],n=2*t+1;n<s;)l=n+1,l<s&&!(0>i(e[n],e[l]))&&(n=l),e[t]=e[n],t=n,n=2*t+1;return e[t]=r,y(e,a,t,i)},e=function(){function e(e){this.cmp=null==e?o:e,this.nodes=[]}return e.push=a,e.pop=l,e.replace=c,e.pushpop=d,e.heapify=r,e.updateItem=f,e.nlargest=m,e.nsmallest=g,e.prototype.push=function(e){return a(this.nodes,e,this.cmp)},e.prototype.pop=function(){return l(this.nodes,this.cmp)},e.prototype.peek=function(){return this.nodes[0]},e.prototype.contains=function(e){return-1!==this.nodes.indexOf(e)},e.prototype.replace=function(e){return c(this.nodes,e,this.cmp)},e.prototype.pushpop=function(e){return d(this.nodes,e,this.cmp)},e.prototype.heapify=function(){return r(this.nodes,this.cmp)},e.prototype.updateItem=function(e){return f(this.nodes,e,this.cmp)},e.prototype.clear=function(){return this.nodes=[]},e.prototype.empty=function(){return 0===this.nodes.length},e.prototype.size=function(){return this.nodes.length},e.prototype.clone=function(){var t;return t=new e,t.nodes=this.nodes.slice(0),t},e.prototype.toArray=function(){return this.nodes.slice(0)},e.prototype.insert=e.prototype.push,e.prototype.top=e.prototype.peek,e.prototype.front=e.prototype.peek,e.prototype.has=e.prototype.contains,e.prototype.copy=e.prototype.clone,e}(),function(e,o){return"function"==typeof i&&i.amd?i([],o):"object"==typeof n?t.exports=o():e.Heap=o()}(this,function(){return e})}).call(void 0)},{}],8:[function(e,t,i){"use strict";i.read=function(t,n,o,r,l){var a=8*l-r-1,p=(1<<a)-1,c=p>>1,u=-7,h=o?l-1:0,i=o?-1:1,d=t[n+h],s,e;for(h+=i,s=d&(1<<-u)-1,d>>=-u,u+=a;0<u;s=256*s+t[n+h],h+=i,u-=8);for(e=s&(1<<-u)-1,s>>=-u,u+=r;0<u;e=256*e+t[n+h],h+=i,u-=8);if(0===s)s=1-c;else{if(s===p)return e?NaN:(d?-1:1)*Infinity;e+=f(2,r),s-=c}return(d?-1:1)*e*f(2,s-r)},i.write=function(t,n,o,r,l,u){var h=8*u-l-1,g=(1<<h)-1,y=g>>1,x=23===l?5.960464477539063e-8-6.617444900424222e-24:0,b=r?0:u-1,i=r?1:-1,d=0>n||0===n&&0>1/n?1:0,s,_,m;for(n=C(n),isNaN(n)||n===Infinity?(_=isNaN(n)?1:0,s=g):(s=p(a(n)/Math.LN2),1>n*(m=f(2,-s))&&(s--,m*=2),n+=1<=s+y?x/m:x*f(2,1-y),2<=n*m&&(s++,m/=2),s+y>=g?(_=0,s=g):1<=s+y?(_=(n*m-1)*f(2,l),s+=y):(_=n*f(2,y-1)*f(2,l),s=0));8<=l;t[o+b]=255&_,b+=i,_/=256,l-=8);for(s=s<<l|_,h+=l;0<h;t[o+b]=255&s,b+=i,s/=256,h-=8);t[o+b-i]|=128*d}},{}],9:[function(e,t){"use strict";var i=8192,o=[];t.exports=class{constructor(e,t){t=t||{},e===void 0&&(e=i),"number"==typeof e&&(e=new ArrayBuffer(e));var n=e.byteLength,o=t.offset?t.offset>>>0:0;e.buffer&&(n=e.byteLength-o,e=e.byteLength===e.buffer.byteLength?o?e.buffer.slice(o):e.buffer:e.buffer.slice(e.byteOffset+o,e.byteOffset+e.byteLength)),this.buffer=e,this.length=n,this.byteLength=n,this.byteOffset=0,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer),this._increment=n||i,this._mark=0}available(e){return void 0===e&&(e=1),this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){this.littleEndian=!0}isBigEndian(){return!this.littleEndian}setBigEndian(){this.littleEndian=!1}skip(e){e===void 0&&(e=1),this.offset+=e}seek(e){this.offset=e}mark(){this._mark=this.offset}reset(){this.offset=this._mark}rewind(){this.offset=0}ensureAvailable(e){if(void 0===e&&(e=1),!this.available(e)){var t=this._increment+this._increment;this._increment=t;var i=this.length+t,n=new Uint8Array(i);n.set(new Uint8Array(this.buffer)),this.buffer=n.buffer,this.length=i,this._data=new DataView(this.buffer)}}readBoolean(){return 0!==this.readUint8()}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e){e===void 0&&(e=1);for(var t=new Uint8Array(e),n=0;n<e;n++)t[n]=this.readByte();return t}readInt16(){var e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){var e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){var e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){var e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){var e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){var e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return d(this.readInt8())}readChars(e){e===void 0&&(e=1),o.length=e;for(var t=0;t<e;t++)o[t]=this.readChar();return o.join("")}writeBoolean(e){this.writeUint8(e?255:0)}writeInt8(e){this.ensureAvailable(1),this._data.setInt8(this.offset++,e)}writeUint8(e){this.ensureAvailable(1),this._data.setUint8(this.offset++,e)}writeByte(e){this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(var t=0;t<e.length;t++)this._data.setUint8(this.offset++,e[t])}writeInt16(e){this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2}writeUint16(e){this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2}writeInt32(e){this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4}writeUint32(e){this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4}writeFloat32(e){this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4}writeFloat64(e){this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8}writeChar(e){this.writeUint8(e.charCodeAt(0))}writeChars(e){for(var t=0;t<e.length;t++)this.writeUint8(e.charCodeAt(t))}toArray(){return new Uint8Array(this.buffer,0,this.offset)}}},{}],10:[function(e,t){"use strict";function i(){function e(e){for(var t=e.length,n=Array(t),o=0;o<t;o++)n[o]=parseFloat(e[o]);return n}function t(){}function n(e){return e.toLowerCase().replace(/[^a-z0-9]/g,"")}function o(e){return-1!==b.indexOf(e)}function r(e){var t=e.spectra,o=t.length,s={times:Array(o),series:[{name:"ms",dimension:2,data:Array(o)}]},r=[],l;for(l=0;l<b.length;l++){var i=n(b[l]);t[0][i]&&(r.push(i),s.series.push({name:i,dimension:1,data:Array(o)}))}for(l=0;l<o;l++){var a=t[l];s.times[l]=a.pageValue;for(var p=0;p<r.length;p++)s.series[p+1].data[l]=parseFloat(a[r[p]]);a.data&&(s.series[0].data[l]=[a.data[0].x,a.data[0].y])}e.gcms=s}function l(e){var t=e.spectra,o=[],s;for(s=0;s<b.length;s++){var i=n(b[s]);t[0][i]&&o.push(i)}if(0!==o.length){var r={gc:{},ms:[]};for(s=0;s<o.length;s++)r.gc[o[s]]=[];for(s=0;s<t.length;s++){for(var l=t[s],a=0;a<o.length;a++)r.gc[o[a]].push(l.pageValue),r.gc[o[a]].push(parseFloat(l[o[a]]));l.data&&(r.ms[s]=l.data[0])}e.gcms=r}}function i(e,t){if(t.xFactor||(t.xFactor=1),t.yFactor||(t.yFactor=1),t.observeFrequency&&t.xUnit&&"HZ"===t.xUnit.toUpperCase()&&(t.xUnit="PPM",t.xFactor/=t.observeFrequency,t.firstX/=t.observeFrequency,t.lastX/=t.observeFrequency,t.deltaX/=t.observeFrequency),e.shiftOffsetVal){var i=t.firstX-e.shiftOffsetVal;t.firstX-=i,t.lastX-=i}}function a(e){e=e.sort(d);var t=e.length;return e[p(t/2)]}function d(e,t){return e-t}function u(e){for(var t=e[0].data[0][0],n=t,o=e.length,s=e[0].data[0].length/2,r=Array(o),l=0;l<o;l++){r[l]=Array(s);for(var i=e[l].data[0],p=0,d;p<s;p++)d=i[2*p+1],r[l][p]=d,d<t&&(t=d),d>n&&(n=d)}return{z:r,minX:e[0].data[0][0],maxX:e[0].data[0][e[0].data[0].length-2],minY:e[0].pageValue,maxY:e[o-1].pageValue,minZ:t,maxZ:n,noise:a(r[0].map(Math.abs))}}function h(e,t){var i=u(e.spectra);t.noContour||(e.contourLines=m(i,t),delete i.z),e.minMax=i}function m(e,t){for(var i=e.noise,n=e.z,o=t.nbContourLevels||7,s=void 0===t.noiseMultiplier?5:t.noiseMultiplier,r=n.length,l=n[0].length,a=e.minX,p=e.maxX,d=(p-a)/(l-1),u=e.minY,h=e.maxY,m=(h-u)/(r-1),g=e.minZ,f=e.maxZ,y=2*o,x=Array(y),b=0,_,k,j,w,C,v,S,D,E,I,H,A,z,F;b<y;b++){F={},x[b]=F;var R=b%2,P=(f-s*i)*c((b>>1)-o);z=0==R?P+s*i:0-P-s*i;var T=[];if(F.zValue=z,F.lines=T,!(z<=g||z>=f))for(var O=0;O<r-1;O++)for(var M=n[O],N=n[O+1],X=0;X<l-1;X++)_=M[X],k=M[X+1],j=N[X],w=N[X+1],C=_>z,v=k>z,S=j>z,D=w>z,C!==v&&C!==S&&(E=X+(z-_)/(k-_),I=O,H=X,A=O+(z-_)/(j-_),T.push(E*d+a),T.push(I*m+u),T.push(H*d+a),T.push(A*m+u)),D!==v&&D!==S&&(E=X+1,I=O+1-(z-w)/(k-w),H=X+1-(z-w)/(j-w),A=O+1,T.push(E*d+a),T.push(I*m+u),T.push(H*d+a),T.push(A*m+u)),v!==S&&(E=(X+1-(z-k)/(j-k))*d+a,I=(O+(z-k)/(j-k))*m+u,v!==C&&(H=X+1-(z-k)/(_-k),A=O,T.push(E),T.push(I),T.push(H*d+a),T.push(A*m+u)),S!==C&&(H=X,A=O+1-(z-j)/(_-j),T.push(E),T.push(I),T.push(H*d+a),T.push(A*m+u)),v!==D&&(H=X+1,A=O+(z-k)/(w-k),T.push(E),T.push(I),T.push(H*d+a),T.push(A*m+u)),S!==D&&(H=X+(z-j)/(w-j),A=O+1,T.push(E),T.push(I),T.push(H*d+a),T.push(A*m+u)))}return{minX:e.minX,maxX:e.maxX,minY:e.minY,maxY:e.maxY,segments:x}}function g(e,t){var n=e.yFactor,o=e.deltaX;e.isXYdata=!0;var s=[];e.data=[s];for(var r=e.firstX,l=e.firstY,a=!1,p=0,i;p<t.length;p++)if(i=t.charCodeAt(p),13===i||10===i)a=!0;else if(a)break;for(var d=!0,c=!1,u=!1,h=0,m=!1,g=!1,y=0,x=!1,b=!1,_=!1,k=0,i;p<=t.length;p++)if(i=p===t.length?13:t.charCodeAt(p),g)(13===i||10===i)&&(d=!0,g=!1);else if(57>=i&&48<=i)b=!0,0<k?y+=(i-48)/f(10,k++):(y*=10,y+=i-48);else if(44===i||46===i)b=!0,k++;else{if(b){if(d)d=!1,u&&(_=!0);else if(_)_=!1;else{c&&(h=x?0-y:y,u=!0,c=!1);for(var w=m?y-1:1,C=0;C<w;C++)u?l+=h:l=x?0-y:y,s.push(r),s.push(l*n),r+=o}x=!1,y=0,k=0,b=!1,m=!1}if(74>i&&63<i)b=!0,u=!1,y=i-64;else if(96<i&&106>i)b=!0,u=!1,y=i-96,x=!0;else if(115===i)b=!0,m=!0,y=9;else if(82<i&&91>i)b=!0,m=!0,y=i-82;else if(73<i&&83>i)b=!0,c=!0,y=i-73;else if(105<i&&115>i)b=!0,c=!0,y=i-105,x=!0;else if(36===i&&36===t.charCodeAt(p+1))b=!0,g=!0;else if(37===i)b=!0,c=!0,y=0,x=!1;else if(45===i){var j=t.charCodeAt(p+1);(48<=j&&57>=j||44===j||46===j)&&(b=!0,u=!1,x=!0)}else(13===i||10===i)&&(d=!0,g=!1)}}function y(e,t,n){var o=/\$\$.*/,s=/[,\t ]+/;e.isPeaktable=!0;var r=[],l,i,a,p,d;e.data=[r];var c=t.split(/,? *,?[;\r\n]+ */);for(l=1,i=c.length;l<i;l++)if(d=c[l].trim().replace(o,"").split(s),0==d.length%2)for(a=0,p=d.length;a<p;a+=2)r.push(parseFloat(d[a])*e.xFactor),r.push(parseFloat(d[a+1])*e.yFactor);else n.logs.push("Format error: "+d)}var x=/[, \t]{1,}/,b=["TIC",".RIC","SCANNUMBER"];return function(a,p){p=p||{};var d=/^$/;p.keepRecordsRegExp&&(d=p.keepRecordsRegExp);var c=!p.withoutXY,u=Date.now(),m={},f={},b,_,w,C,v,S,D,E,I;f.profiling=[],f.logs=[];var H=[];f.spectra=H,f.info={};var A=new t;if("string"!=typeof a)return f;for(f.profiling&&f.profiling.push({action:"Before split to LDRS",time:Date.now()-u}),C=a.split(/[\r\n]+##/),f.profiling&&f.profiling.push({action:"Split to LDRS",time:Date.now()-u}),C[0]&&(C[0]=C[0].replace(/^[\r\n ]*##/,"")),(v=0,S=C.length);v<S;v++){if(b=C[v],D=b.indexOf("="),0<D?(_=b.substring(0,D),w=b.substring(D+1).trim()):(_=b,w=""),_=_.replace(/[_ -]/g,"").toUpperCase(),"DATATABLE"===_&&(E=w.indexOf("\n"),-1===E&&(E=w.indexOf("\r")),0<E)){var z=-1,F=-1;if(I=w.substring(0,E).split(/[ ,;\t]+/),0<I[0].indexOf("++")){var R=I[0].replace(/.*\(([a-zA-Z0-9]+)\+\+.*/,"$1"),P=I[0].replace(/.*\.\.([a-zA-Z0-9]+).*/,"$1");z=m.symbol.indexOf(R),F=m.symbol.indexOf(P)}-1===z&&(z=0),-1===F&&(F=0),m.first&&(m.first.length>z&&(A.firstX=m.first[z]),m.first.length>F&&(A.firstY=m.first[F])),m.last&&(m.last.length>z&&(A.lastX=m.last[z]),m.last.length>F&&(A.lastY=m.last[F])),m.vardim&&m.vardim.length>z&&(A.nbPoints=m.vardim[z]),m.factor&&(m.factor.length>z&&(A.xFactor=m.factor[z]),m.factor.length>F&&(A.yFactor=m.factor[F])),m.units&&(m.units.length>z&&(A.xUnit=m.units[z]),m.units.length>F&&(A.yUnit=m.units[F])),A.datatable=I[0],I[1]&&-1<I[1].indexOf("PEAKS")?_="PEAKTABLE":I[1]&&(I[1].indexOf("XYDATA")||0<I[0].indexOf("++"))&&(_="XYDATA",A.deltaX=(A.lastX-A.firstX)/(A.nbPoints-1))}if("XYDATA"===_){c&&(i(f,A),w.match(/.*\+\+.*/)?!1===p.fastParse?s(A,w,f):(!A.deltaX&&(A.deltaX=(A.lastX-A.firstX)/(A.nbPoints-1)),g(A,w,f)):y(A,w,f),H.push(A),A=new t);continue}else if("PEAKTABLE"===_){c&&(i(f,A),y(A,w,f),H.push(A),A=new t);continue}if("TITLE"===_)A.title=w;else if("DATATYPE"===_)A.dataType=w,-1<w.indexOf("nD")&&(f.twoD=!0);else if("NTUPLES"===_)-1<w.indexOf("nD")&&(f.twoD=!0);else if("XUNITS"===_)A.xUnit=w;else if("YUNITS"===_)A.yUnit=w;else if("FIRSTX"===_)A.firstX=parseFloat(w);else if("LASTX"===_)A.lastX=parseFloat(w);else if("FIRSTY"===_)A.firstY=parseFloat(w);else if("LASTY"===_)A.lastY=parseFloat(w);else if("NPOINTS"===_)A.nbPoints=parseFloat(w);else if("XFACTOR"===_)A.xFactor=parseFloat(w);else if("YFACTOR"===_)A.yFactor=parseFloat(w);else if("DELTAX"===_)A.deltaX=parseFloat(w);else if(".OBSERVEFREQUENCY"===_||"$SFO1"===_)A.observeFrequency||(A.observeFrequency=parseFloat(w));else if(".OBSERVENUCLEUS"===_)A.xType||(f.xType=w.replace(/[^a-zA-Z0-9]/g,""));else if("$SFO2"===_)f.indirectFrequency||(f.indirectFrequency=parseFloat(w));else if("$OFFSET"===_)f.shiftOffsetNum=0,f.shiftOffsetVal||(f.shiftOffsetVal=parseFloat(w));else if("$REFERENCEPOINT"===_);else if("VARNAME"===_)m.varname=w.split(x);else if("SYMBOL"===_)m.symbol=w.split(x);else if("VARTYPE"===_)m.vartype=w.split(x);else if("VARFORM"===_)m.varform=w.split(x);else if("VARDIM"===_)m.vardim=e(w.split(x));else if("UNITS"===_)m.units=w.split(x);else if("FACTOR"===_)m.factor=e(w.split(x));else if("FIRST"===_)m.first=e(w.split(x));else if("LAST"===_)m.last=e(w.split(x));else if("MIN"===_)m.min=e(w.split(x));else if("MAX"===_)m.max=e(w.split(x));else if(".NUCLEUS"===_)f.twoD&&(f.yType=w.split(x)[0]);else if("PAGE"===_){A.page=w.trim(),A.pageValue=parseFloat(w.replace(/^.*=/,"")),A.pageSymbol=A.page.replace(/=.*/,"");var T=m.symbol.indexOf(A.pageSymbol),O="";m.units&&m.units[T]&&(O=m.units[T]),f.indirectFrequency&&"PPM"!==O&&(A.pageValue/=f.indirectFrequency)}else"RETENTIONTIME"===_?A.pageValue=parseFloat(w):o(_)&&(A[n(_)]=w);_.match(d)&&(f.info[_]=w.trim())}if(f.profiling&&f.profiling.push({action:"Finished parsing",time:Date.now()-u}),0<Object.keys(m).length){for(var M=[],N=Object.keys(m),v=0;v<N.length;v++)for(var X=N[v],L=m[X],Y=0;Y<L.length;Y++)M[Y]||(M[Y]={}),M[Y][X]=L[Y];f.ntuples=M}f.twoD&&c&&(h(f,p),f.profiling&&f.profiling.push({action:"Finished countour plot calculation",time:Date.now()-u}),!p.keepSpectra&&delete f.spectra);var j=1<H.length&&(!H[0].dataType||H[0].dataType.match(/.*mass.*/i));if(j&&p.newGCMS&&(p.xy=!0),p.xy&&c&&0<H.length)for(var v=0,A;v<H.length;v++)if(A=H[v],0<A.data.length)for(var Y=0;Y<A.data.length;Y++){for(var U=A.data[Y],B={x:Array(U.length/2),y:Array(U.length/2)},V=0;V<U.length;V+=2)B.x[V/2]=U[V],B.y[V/2]=U[V+1];A.data[Y]=B}return j&&c&&(p.newGCMS?r(f):l(f),f.profiling&&f.profiling.push({action:"Finished GCMS calculation",time:Date.now()-u})),f.profiling&&f.profiling.push({action:"Total time",time:Date.now()-u}),f}}function n(e,t){return a||o(),new Promise(function(i){var n=Date.now()+""+Math.random();l[n]=i,a.postMessage(JSON.stringify({stamp:n,input:e,options:t}))})}function o(){var e=URL.createObjectURL(new Blob(["var getConverter ="+i.toString()+";var convert = getConverter(); onmessage = function (event) { var data = JSON.parse(event.data); postMessage(JSON.stringify({stamp: data.stamp, output: convert(data.input, data.options)})); };"],{type:"application/javascript"}));a=new Worker(e),URL.revokeObjectURL(e),a.addEventListener("message",function(e){var t=JSON.parse(e.data),i=t.stamp;l[i]&&l[i](t.output)})}var s=e("./parseXYData.js"),r=i(),l={},a;t.exports={convert:function(e,t,i){return"boolean"==typeof t&&(i=t,t={}),i?n(e,t):r(e,t)}}},{"./parseXYData.js":11}],11:[function(e,t){"use strict";var n=/[,\t \+-]*(?=[^\d,\t \.])|[ \t]+(?=[\d+\.-])/,o=/\$\$.*/;t.exports=function(e,t){e.deltaX||(e.deltaX=(e.lastX-e.firstX)/(e.nbPoints-1)),e.isXYdata=!0;var s=[],r=0;e.data=[s];var a=e.firstX,p=e.firstY,c=t.split(/[\r\n]+/),u,h,m;h=[];for(var g=1,i=c.length;g<i;g++)if(h=c[g].trim().replace(o,"").split(n),0<h.length)for(var f=1,y=h.length;f<y;f++)if(1===f&&(u||0===u))u=null,m=h[f].charCodeAt(0),!1;else if(0<h[f].length)if(m=h[f].charCodeAt(0),43===m||45===m||46===m||47<m&&58>m)u=null,p=+h[f],s[r++]=a,s[r++]=p*e.yFactor,a+=e.deltaX;else if(63<m&&74>m)u=null,p=+(d(m-16)+h[f].substring(1)),s[r++]=a,s[r++]=p*e.yFactor,a+=e.deltaX;else if(96<m&&106>m)u=null,p=1*-(d(m-48)+h[f].substring(1)),s[r++]=a,s[r++]=p*e.yFactor,a+=e.deltaX;else if(82<m&&91>m||115===m){var x=d(m-34)+h[f].substring(1)-1;115===m&&(x="9"+h[f].substring(1)-1);for(var b=0;b<x;b++)u&&(p+=u),s[r++]=a,s[r++]=p*e.yFactor,a+=e.deltaX}else 37===m?(u=+("0"+h[f].substring(1)),p+=u,s[r++]=a,s[r++]=p*e.yFactor,a+=e.deltaX):73<m&&83>m?(u=1*(d(m-25)+h[f].substring(1)),p+=u,s[r++]=a,s[r++]=p*e.yFactor,a+=e.deltaX):105<m&&115>m&&(u=1*-(d(m-57)+h[f].substring(1)),p+=u,s[r++]=a,s[r++]=p*e.yFactor,a+=e.deltaX)}},{}],12:[function(e,t){"use strict";function i(e){if(e){this.data=e,this.length=this.data.length,this.index=0,this.zero=0;for(var t=0;t<this.data.length;t++)e[t]&=255}}var n=e("./dataReader");i.prototype=new n,i.prototype.byteAt=function(e){return this.data[this.zero+e]},i.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),n=e.charCodeAt(1),o=e.charCodeAt(2),s=e.charCodeAt(3),r=this.length-4;0<=r;--r)if(this.data[r]===t&&this.data[r+1]===n&&this.data[r+2]===o&&this.data[r+3]===s)return r-this.zero;return-1},i.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"./dataReader":17}],13:[function(e,t,i){"use strict";var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(e){for(var t="",o=0,i,s,r,l,a,p,d;o<e.length;)i=e.charCodeAt(o++),s=e.charCodeAt(o++),r=e.charCodeAt(o++),l=i>>2,a=(3&i)<<4|s>>4,p=(15&s)<<2|r>>6,d=63&r,isNaN(s)?p=d=64:isNaN(r)&&(d=64),t=t+n.charAt(l)+n.charAt(a)+n.charAt(p)+n.charAt(d);return t},i.decode=function(e){var t="",o=0,i,s,r,l,a,p,c;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");o<e.length;)l=n.indexOf(e.charAt(o++)),a=n.indexOf(e.charAt(o++)),p=n.indexOf(e.charAt(o++)),c=n.indexOf(e.charAt(o++)),i=l<<2|a>>4,s=(15&a)<<4|p>>2,r=(3&p)<<6|c,t+=d(i),64!=p&&(t+=d(s)),64!=c&&(t+=d(r));return t}},{}],14:[function(e,t){"use strict";function i(){this.compressedSize=0,this.uncompressedSize=0,this.crc32=0,this.compressionMethod=null,this.compressedContent=null}i.prototype={getContent:function(){return null},getCompressedContent:function(){return null}},t.exports=i},{}],15:[function(e,t,i){"use strict";i.STORE={magic:"\0\0",compress:function(e){return e},uncompress:function(e){return e},compressInputType:null,uncompressInputType:null},i.DEFLATE=e("./flate")},{"./flate":20}],16:[function(e,t){"use strict";var n=e("./utils"),o=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918000,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];t.exports=function(e,t){if("undefined"==typeof e||!e.length)return 0;var s="string"!==n.getTypeOf(e);"undefined"==typeof t&&(t=0);var r=0,l=0,a=0;t^=-1;for(var p=0,i=e.length;p<i;p++)a=s?e[p]:e.charCodeAt(p),l=255&(t^a),r=o[l],t=t>>>8^r;return-1^t}},{"./utils":33}],17:[function(e,t){"use strict";function i(){this.data=null,this.length=0,this.index=0,this.zero=0}var n=e("./utils");i.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||0>e)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var t=0,n;for(this.checkOffset(e),n=this.index+e-1;n>=this.index;n--)t=(t<<8)+this.byteAt(n);return this.index+=e,t},readString:function(e){return n.transformTo("string",this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date((127&e>>25)+1980,(15&e>>21)-1,31&e>>16,31&e>>11,63&e>>5,(31&e)<<1)}},t.exports=i},{"./utils":33}],18:[function(e,t,i){"use strict";i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!1,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],19:[function(e,t,i){"use strict";var n=e("./utils");i.string2binary=function(e){return n.string2binary(e)},i.string2Uint8Array=function(e){return n.transformTo("uint8array",e)},i.uint8Array2String=function(e){return n.transformTo("string",e)},i.string2Blob=function(e){var t=n.transformTo("arraybuffer",e);return n.arrayBuffer2Blob(t)},i.arrayBuffer2Blob=function(e){return n.arrayBuffer2Blob(e)},i.transformTo=function(e,t){return n.transformTo(e,t)},i.getTypeOf=function(e){return n.getTypeOf(e)},i.checkSupport=function(e){return n.checkSupport(e)},i.MAX_VALUE_16BITS=n.MAX_VALUE_16BITS,i.MAX_VALUE_32BITS=n.MAX_VALUE_32BITS,i.pretty=function(e){return n.pretty(e)},i.findCompression=function(e){return n.findCompression(e)},i.isRegExp=function(e){return n.isRegExp(e)}},{"./utils":33}],20:[function(e,t,i){"use strict";var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,o=e("pako");i.uncompressInputType=n?"uint8array":"array",i.compressInputType=n?"uint8array":"array",i.magic="\b\0",i.compress=function(e,t){return o.deflateRaw(e,{level:t.level||-1})},i.uncompress=function(e){return o.inflateRaw(e)}},{pako:114}],21:[function(e,t){"use strict";function n(e,t){return this instanceof n?void(this.files={},this.comment=null,this.root="",e&&this.load(e,t),this.clone=function(){var e=new n;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}):new n(e,t)}var i=e("./base64");n.prototype=e("./object"),n.prototype.load=e("./load"),n.support=e("./support"),n.defaults=e("./defaults"),n.utils=e("./deprecatedPublicUtils"),n.base64={encode:function(e){return i.encode(e)},decode:function(e){return i.decode(e)}},n.compressions=e("./compressions"),t.exports=n},{"./base64":13,"./compressions":15,"./defaults":18,"./deprecatedPublicUtils":19,"./load":22,"./object":25,"./support":29}],22:[function(e,t){"use strict";var n=e("./base64"),o=e("./utf8"),s=e("./utils"),r=e("./zipEntries");t.exports=function(e,t){var l,a,p,i;for(t=s.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),t.base64&&(e=n.decode(e)),a=new r(e,t),l=a.files,p=0;p<l.length;p++)i=l[p],this.file(i.fileNameStr,i.decompressed,{binary:!0,optimizedBinaryString:!0,date:i.date,dir:i.dir,comment:i.fileCommentStr.length?i.fileCommentStr:null,unixPermissions:i.unixPermissions,dosPermissions:i.dosPermissions,createFolders:t.createFolders});return a.zipComment.length&&(this.comment=a.zipComment),this}},{"./base64":13,"./utf8":32,"./utils":33,"./zipEntries":34}],23:[function(e,t){(function(e){"use strict";t.exports=function(t,i){return new e(t,i)},t.exports.test=function(t){return e.isBuffer(t)}}).call(this,e("buffer").Buffer)},{buffer:4}],24:[function(e,t){"use strict";function i(e){this.data=e,this.length=this.data.length,this.index=0,this.zero=0}var n=e("./uint8ArrayReader");i.prototype=new n,i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"./uint8ArrayReader":30}],25:[function(e,t){"use strict";var i=e("./support"),n=e("./utils"),s=e("./crc32"),r=e("./signature"),l=e("./defaults"),o=e("./base64"),a=e("./compressions"),p=e("./compressedObject"),c=e("./nodeBuffer"),u=e("./utf8"),h=e("./stringWriter"),m=e("./uint8ArrayWriter"),g=function(e){if(e._data instanceof p&&(e._data=e._data.getContent(),e.options.binary=!0,e.options.base64=!1,"uint8array"===n.getTypeOf(e._data))){var t=e._data;e._data=new Uint8Array(t.length),0!==t.length&&e._data.set(t,0)}return e._data},f=function(e){var t=g(e),o=n.getTypeOf(t);return"string"===o?!e.options.binary&&i.nodebuffer?c(t,"utf-8"):e.asBinary():t},y=function(e){var t=g(this);return null===t||"undefined"==typeof t?"":(this.options.base64&&(t=o.decode(t)),t=e&&this.options.binary?I.utf8decode(t):n.transformTo("string",t),e||this.options.binary||(t=n.transformTo("string",I.utf8encode(t))),t)},x=function(e,t,i){this.name=e,this.dir=i.dir,this.date=i.date,this.comment=i.comment,this.unixPermissions=i.unixPermissions,this.dosPermissions=i.dosPermissions,this._data=t,this.options=i,this._initialMetadata={dir:i.dir,date:i.date}};x.prototype={asText:function(){return y.call(this,!0)},asBinary:function(){return y.call(this,!1)},asNodeBuffer:function(){var e=f(this);return n.transformTo("nodebuffer",e)},asUint8Array:function(){var e=f(this);return n.transformTo("uint8array",e)},asArrayBuffer:function(){return this.asUint8Array().buffer}};var b=function(e,t){var n="",o;for(o=0;o<t;o++)n+=d(255&e),e>>>=8;return n},_=function(e){return e=e||{},!0===e.base64&&(null===e.binary||void 0===e.binary)&&(e.binary=!0),e=n.extend(e,l),e.date=e.date||new Date,null!==e.compression&&(e.compression=e.compression.toUpperCase()),e},k=function(e,t,i){var o=n.getTypeOf(t),s;if(i=_(i),"string"==typeof i.unixPermissions&&(i.unixPermissions=parseInt(i.unixPermissions,8)),i.unixPermissions&&16384&i.unixPermissions&&(i.dir=!0),i.dosPermissions&&16&i.dosPermissions&&(i.dir=!0),i.dir&&(e=w(e)),i.createFolders&&(s=j(e))&&C.call(this,s,!0),i.dir||null===t||"undefined"==typeof t)i.base64=!1,i.binary=!1,t=null,o=null;else if("string"===o)i.binary&&!i.base64&&!0!==i.optimizedBinaryString&&(t=n.string2binary(t));else{if(i.base64=!1,i.binary=!0,!o&&!(t instanceof p))throw new Error("The data of '"+e+"' is in an unsupported format !");"arraybuffer"===o&&(t=n.transformTo("uint8array",t))}var r=new x(e,t,i);return this.files[e]=r,r},j=function(e){"/"==e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return 0<t?e.substring(0,t):""},w=function(e){return"/"!=e.slice(-1)&&(e+="/"),e},C=function(e,t){return t="undefined"!=typeof t&&t,e=w(e),this.files[e]||k.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]},v=function(e,t,i){var o=new p,r;return e._data instanceof p?(o.uncompressedSize=e._data.uncompressedSize,o.crc32=e._data.crc32,0===o.uncompressedSize||e.dir?(t=a.STORE,o.compressedContent="",o.crc32=0):e._data.compressionMethod===t.magic?o.compressedContent=e._data.getCompressedContent():(r=e._data.getContent(),o.compressedContent=t.compress(n.transformTo(t.compressInputType,r),i))):(r=f(e),(!r||0===r.length||e.dir)&&(t=a.STORE,r=""),o.uncompressedSize=r.length,o.crc32=s(r),o.compressedContent=t.compress(n.transformTo(t.compressInputType,r),i)),o.compressedSize=o.compressedContent.length,o.compressionMethod=t.magic,o},S=function(e,t){var i=e;return e||(i=t?16893:33204),(65535&i)<<16},D=function(e){return 63&(e||0)},E=function(e,t,i,l,a,p){var d=i.compressedContent,c=p!==u.utf8encode,h=n.transformTo("string",p(t.name)),m=n.transformTo("string",u.utf8encode(t.name)),g=t.comment||"",f=n.transformTo("string",p(g)),y=n.transformTo("string",u.utf8encode(g)),x=m.length!==t.name.length,_=y.length!==g.length,k=t.options,o="",j="",w="",C,v,E,I;E=t._initialMetadata.dir===t.dir?k.dir:t.dir,I=t._initialMetadata.date===t.date?k.date:t.date;var H=0,A=0;E&&(H|=16),"UNIX"===a?(A=798,H|=S(t.unixPermissions,E)):(A=20,H|=D(t.dosPermissions,E)),C=I.getHours(),C<<=6,C|=I.getMinutes(),C<<=5,C|=I.getSeconds()/2,v=I.getFullYear()-1980,v<<=4,v|=I.getMonth()+1,v<<=5,v|=I.getDate(),x&&(j=b(1,1)+b(s(h),4)+m,o+="up"+b(j.length,2)+j),_&&(w=b(1,1)+b(this.crc32(f),4)+y,o+="uc"+b(w.length,2)+w);var z="";z+="\n\0",z+=!c&&(x||_)?"\0\b":"\0\0",z+=i.compressionMethod,z+=b(C,2),z+=b(v,2),z+=b(i.crc32,4),z+=b(i.compressedSize,4),z+=b(i.uncompressedSize,4),z+=b(h.length,2),z+=b(o.length,2);var F=r.LOCAL_FILE_HEADER+z+h+o,R=r.CENTRAL_FILE_HEADER+b(A,2)+z+b(f.length,2)+"\0\0\0\0"+b(H,4)+b(l,4)+h+o+f;return{fileRecord:F,dirRecord:R,compressedObject:i}},I={load:function(){throw new Error("Load method is not defined. Is the file jszip-load.js included ?")},filter:function(e){var t=[],i,o,s,r;for(i in this.files)this.files.hasOwnProperty(i)&&(s=this.files[i],r=new x(s.name,s._data,n.extend(s.options)),o=i.slice(this.root.length,i.length),i.slice(0,this.root.length)===this.root&&e(o,r)&&t.push(r));return t},file:function(e,t,i){if(1===arguments.length){if(n.isRegExp(e)){var o=e;return this.filter(function(e,t){return!t.dir&&o.test(e)})}return this.filter(function(t,i){return!i.dir&&t===e})[0]||null}return e=this.root+e,k.call(this,e,t,i),this},folder:function(e){if(!e)return this;if(n.isRegExp(e))return this.filter(function(t,i){return i.dir&&e.test(t)});var t=this.root+e,i=C.call(this,t),o=this.clone();return o.root=i.name,o},remove:function(e){e=this.root+e;var t=this.files[e];if(t||("/"!=e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var n=this.filter(function(t,i){return i.name.slice(0,e.length)===e}),o=0;o<n.length;o++)delete this.files[n[o].name];return this},generate:function(e){e=n.extend(e||{},{base64:!0,compression:"STORE",compressionOptions:null,type:"base64",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:u.utf8encode}),n.checkSupport(e.type),("darwin"===e.platform||"freebsd"===e.platform||"linux"===e.platform||"sunos"===e.platform)&&(e.platform="UNIX"),"win32"===e.platform&&(e.platform="DOS");var t=[],s=0,l=0,p=n.transformTo("string",e.encodeFileName(e.comment||this.comment||"")),d,c;for(var i in this.files)if(this.files.hasOwnProperty(i)){var g=this.files[i],f=g.options.compression||e.compression.toUpperCase(),y=a[f];if(!y)throw new Error(f+" is not a valid compression method !");var x=g.options.compressionOptions||e.compressionOptions||{},_=v.call(this,g,y,x),k=E.call(this,i,g,_,s,e.platform,e.encodeFileName);s+=k.fileRecord.length+_.compressedSize,l+=k.dirRecord.length,t.push(k)}var j="";j=r.CENTRAL_DIRECTORY_END+"\0\0\0\0"+b(t.length,2)+b(t.length,2)+b(l,4)+b(s,4)+b(p.length,2)+p;var w=e.type.toLowerCase();for(d="uint8array"===w||"arraybuffer"===w||"blob"===w||"nodebuffer"===w?new m(s+l+j.length):new h(s+l+j.length),c=0;c<t.length;c++)d.append(t[c].fileRecord),d.append(t[c].compressedObject.compressedContent);for(c=0;c<t.length;c++)d.append(t[c].dirRecord);d.append(j);var C=d.finalize();switch(e.type.toLowerCase()){case"uint8array":case"arraybuffer":case"nodebuffer":return n.transformTo(e.type.toLowerCase(),C);case"blob":return n.arrayBuffer2Blob(n.transformTo("arraybuffer",C),e.mimeType);case"base64":return e.base64?o.encode(C):C;default:return C;}},crc32:function(e,t){return s(e,t)},utf8encode:function(e){return n.transformTo("string",u.utf8encode(e))},utf8decode:function(e){return u.utf8decode(e)}};t.exports=I},{"./base64":13,"./compressedObject":14,"./compressions":15,"./crc32":16,"./defaults":18,"./nodeBuffer":23,"./signature":26,"./stringWriter":28,"./support":29,"./uint8ArrayWriter":31,"./utf8":32,"./utils":33}],26:[function(e,t,i){"use strict";i.LOCAL_FILE_HEADER="PK\x03\x04",i.CENTRAL_FILE_HEADER="PK\x01\x02",i.CENTRAL_DIRECTORY_END="PK\x05\x06",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x06\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK\x06\x06",i.DATA_DESCRIPTOR="PK\x07\b"},{}],27:[function(e,t){"use strict";function i(e,t){this.data=e,t||(this.data=o.string2binary(this.data)),this.length=this.data.length,this.index=0,this.zero=0}var n=e("./dataReader"),o=e("./utils");i.prototype=new n,i.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},i.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"./dataReader":17,"./utils":33}],28:[function(e,t){"use strict";var i=e("./utils"),n=function(){this.data=[]};n.prototype={append:function(e){e=i.transformTo("string",e),this.data.push(e)},finalize:function(){return this.data.join("")}},t.exports=n},{"./utils":33}],29:[function(e,t,i){(function(e){"use strict";if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,i.nodebuffer="undefined"!=typeof e,i.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)i.blob=!1;else{var t=new ArrayBuffer(0);try{i.blob=0===new Blob([t],{type:"application/zip"}).size}catch(s){try{var n=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,o=new n;o.append(t),i.blob=0===o.getBlob("application/zip").size}catch(t){i.blob=!1}}}}).call(this,e("buffer").Buffer)},{buffer:4}],30:[function(e,t){"use strict";function i(e){e&&(this.data=e,this.length=this.data.length,this.index=0,this.zero=0)}var n=e("./arrayReader");i.prototype=new n,i.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"./arrayReader":12}],31:[function(e,t){"use strict";var i=e("./utils"),n=function(e){this.data=new Uint8Array(e),this.index=0};n.prototype={append:function(e){0!==e.length&&(e=i.transformTo("uint8array",e),this.data.set(e,this.index),this.index+=e.length)},finalize:function(){return this.data}},t.exports=n},{"./utils":33}],32:[function(e,t,n){"use strict";for(var o=e("./utils"),s=e("./support"),r=e("./nodeBuffer"),l=Array(256),a=0;256>a;a++)l[a]=252<=a?6:248<=a?5:240<=a?4:224<=a?3:192<=a?2:1;l[254]=l[254]=1;var i=function(e){var t=e.length,n=0,o,r,l,a,p;for(a=0;a<t;a++)r=e.charCodeAt(a),55296==(64512&r)&&a+1<t&&(l=e.charCodeAt(a+1),56320==(64512&l)&&(r=65536+(r-55296<<10)+(l-56320),a++)),n+=128>r?1:2048>r?2:65536>r?3:4;for(o=s.uint8array?new Uint8Array(n):Array(n),p=0,a=0;p<n;a++)r=e.charCodeAt(a),55296==(64512&r)&&a+1<t&&(l=e.charCodeAt(a+1),56320==(64512&l)&&(r=65536+(r-55296<<10)+(l-56320),a++)),128>r?o[p++]=r:2048>r?(o[p++]=192|r>>>6,o[p++]=128|63&r):65536>r?(o[p++]=224|r>>>12,o[p++]=128|63&r>>>6,o[p++]=128|63&r):(o[p++]=240|r>>>18,o[p++]=128|63&r>>>12,o[p++]=128|63&r>>>6,o[p++]=128|63&r);return o},p=function(e,t){var i;for(t=t||e.length,t>e.length&&(t=e.length),i=t-1;0<=i&&128==(192&e[i]);)i--;return 0>i?t:0===i?t:i+l[e[i]]>t?i:t},d=function(e){var t=e.length,n=Array(2*t),s,i,r,a;for(i=0,s=0;s<t;){if(r=e[s++],128>r){n[i++]=r;continue}if(a=l[r],4<a){n[i++]=65533,s+=a-1;continue}for(r&=2===a?31:3===a?15:7;1<a&&s<t;)r=r<<6|63&e[s++],a--;if(1<a){n[i++]=65533;continue}65536>r?n[i++]=r:(r-=65536,n[i++]=55296|1023&r>>10,n[i++]=56320|1023&r)}return n.length!==i&&(n.subarray?n=n.subarray(0,i):n.length=i),o.applyFromCharCode(n)};n.utf8encode=function(e){return s.nodebuffer?r(e,"utf-8"):i(e)},n.utf8decode=function(e){if(s.nodebuffer)return o.transformTo("nodebuffer",e).toString("utf-8");e=o.transformTo(s.uint8array?"uint8array":"array",e);for(var t=[],i=0,n=e.length;i<n;){var r=p(e,_(i+65536,n));s.uint8array?t.push(d(e.subarray(i,r))):t.push(d(e.slice(i,r))),i=r}return t.join("")}},{"./nodeBuffer":23,"./support":29,"./utils":33}],33:[function(e,t,n){"use strict";function i(e){return e}function o(e,t){for(var n=0;n<e.length;++n)t[n]=255&e.charCodeAt(n);return t}function s(e){var t=65536,o=[],s=e.length,r=n.getTypeOf(e),l=0,a=!0;try{"uint8array"===r?d.apply(null,new Uint8Array(0)):"nodebuffer"===r?d.apply(null,c(0)):void 0}catch(t){a=!1}if(!a){for(var u="",h=0;h<e.length;h++)u+=d(e[h]);return u}for(;l<s&&1<t;)try{"array"===r||"nodebuffer"===r?o.push(d.apply(null,e.slice(l,_(l+t,s)))):o.push(d.apply(null,e.subarray(l,_(l+t,s)))),l+=t}catch(i){t=p(t/2)}return o.join("")}function r(e,t){for(var n=0;n<e.length;n++)t[n]=e[n];return t}var l=e("./support"),a=e("./compressions"),c=e("./nodeBuffer");n.string2binary=function(e){for(var t="",n=0;n<e.length;n++)t+=d(255&e.charCodeAt(n));return t},n.arrayBuffer2Blob=function(e,t){n.checkSupport("blob"),t=t||"application/zip";try{return new Blob([e],{type:t})}catch(n){try{var i=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,o=new i;return o.append(e),o.getBlob(t)}catch(t){throw new Error("Bug : can't construct the Blob.")}}},n.applyFromCharCode=s;var u={};u.string={string:i,array:function(e){return o(e,Array(e.length))},arraybuffer:function(e){return u.string.uint8array(e).buffer},uint8array:function(e){return o(e,new Uint8Array(e.length))},nodebuffer:function(e){return o(e,c(e.length))}},u.array={string:s,array:i,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return c(e)}},u.arraybuffer={string:function(e){return s(new Uint8Array(e))},array:function(e){return r(new Uint8Array(e),Array(e.byteLength))},arraybuffer:i,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return c(new Uint8Array(e))}},u.uint8array={string:s,array:function(e){return r(e,Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:i,nodebuffer:function(e){return c(e)}},u.nodebuffer={string:s,array:function(e){return r(e,Array(e.length))},arraybuffer:function(e){return u.nodebuffer.uint8array(e).buffer},uint8array:function(e){return r(e,new Uint8Array(e.length))},nodebuffer:i},n.transformTo=function(e,t){if(t||(t=""),!e)return t;n.checkSupport(e);var i=n.getTypeOf(t),o=u[i][e](t);return o},n.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":l.nodebuffer&&c.test(e)?"nodebuffer":l.uint8array&&e instanceof Uint8Array?"uint8array":l.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},n.checkSupport=function(e){var t=l[e.toLowerCase()];if(!t)throw new Error(e+" is not supported by this browser")},n.MAX_VALUE_16BITS=65535,n.MAX_VALUE_32BITS=-1,n.pretty=function(e){var t="",n,o;for(o=0;o<(e||"").length;o++)n=e.charCodeAt(o),t+="\\x"+(16>n?"0":"")+n.toString(16).toUpperCase();return t},n.findCompression=function(e){for(var t in a)if(a.hasOwnProperty(t)&&a[t].magic===e)return a[t];return null},n.isRegExp=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},n.extend=function(){var e={},t,i;for(t=0;t<arguments.length;t++)for(i in arguments[t])arguments[t].hasOwnProperty(i)&&"undefined"==typeof e[i]&&(e[i]=arguments[t][i]);return e}},{"./compressions":15,"./nodeBuffer":23,"./support":29}],34:[function(e,t){"use strict";function i(e,t){this.files=[],this.loadOptions=t,e&&this.load(e)}var n=e("./stringReader"),o=e("./nodeBufferReader"),s=e("./uint8ArrayReader"),r=e("./arrayReader"),l=e("./utils"),a=e("./signature"),p=e("./zipEntry"),d=e("./support"),c=e("./object");i.prototype={checkSignature:function(e){var t=this.reader.readString(4);if(t!==e)throw new Error("Corrupted zip or bug : unexpected signature ("+l.pretty(t)+", expected "+l.pretty(e)+")")},isSignature:function(e,t){var i=this.reader.index;this.reader.setIndex(e);var n=this.reader.readString(4);return this.reader.setIndex(i),n===t},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=d.uint8array?"uint8array":"array",i=l.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(i)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.versionMadeBy=this.reader.readString(2),this.versionNeeded=this.reader.readInt(2),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e=this.zip64EndOfCentralSize-44,t,i,n;0<e;)t=this.reader.readInt(2),i=this.reader.readInt(4),n=this.reader.readString(i),this.zip64ExtensibleData[t]={id:t,length:i,value:n}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readString(4)===a.CENTRAL_FILE_HEADER;)e=new p({zip64:this.zip64},this.loadOptions),e.readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length)if(0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length);else;},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(0>e){var t=!this.isSignature(0,a.LOCAL_FILE_HEADER);if(t)throw new Error("Can't find end of central directory : is this a zip file ? If it is, see http://stuk.github.io/jszip/documentation/howto/read_zip.html");else throw new Error("Corrupted zip : can't find end of central directory")}this.reader.setIndex(e);var i=e;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===l.MAX_VALUE_16BITS||this.diskWithCentralDirStart===l.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===l.MAX_VALUE_16BITS||this.centralDirRecords===l.MAX_VALUE_16BITS||this.centralDirSize===l.MAX_VALUE_32BITS||this.centralDirOffset===l.MAX_VALUE_32BITS){if(this.zip64=!0,e=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),0>e)throw new Error("Corrupted zip : can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),0>this.relativeOffsetEndOfZip64CentralDir))throw new Error("Corrupted zip : can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var n=this.centralDirOffset+this.centralDirSize;this.zip64&&(n+=20,n+=12+this.zip64EndOfCentralSize);var o=i-n;if(0<o)this.isSignature(i,a.CENTRAL_FILE_HEADER)||(this.reader.zero=o);else if(0>o)throw new Error("Corrupted zip: missing "+C(o)+" bytes.")},prepareReader:function(e){var t=l.getTypeOf(e);if(l.checkSupport(t),"string"===t&&!d.uint8array)this.reader=new n(e,this.loadOptions.optimizedBinaryString);else if("nodebuffer"===t)this.reader=new o(e);else if(d.uint8array)this.reader=new s(l.transformTo("uint8array",e));else if(d.array)this.reader=new r(l.transformTo("array",e));else throw new Error("Unexpected error: unsupported type '"+t+"'")},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=i},{"./arrayReader":12,"./nodeBufferReader":24,"./object":25,"./signature":26,"./stringReader":27,"./support":29,"./uint8ArrayReader":30,"./utils":33,"./zipEntry":35}],35:[function(e,t){"use strict";function i(e,t){this.options=e,this.loadOptions=t}var n=e("./stringReader"),o=e("./utils"),s=e("./compressedObject"),r=e("./object"),l=e("./support");i.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},prepareCompressedContent:function(e,t,i){return function(){var n=e.index;e.setIndex(t);var o=e.readData(i);return e.setIndex(n),o}},prepareContent:function(e,t,i,n,s){return function(){var e=o.transformTo(n.uncompressInputType,this.getCompressedContent()),t=n.uncompress(e);if(t.length!==s)throw new Error("Bug : uncompressed data size mismatch");return t}},readLocalPart:function(e){var t,i;if(e.skip(22),this.fileNameLength=e.readInt(2),i=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(i),-1==this.compressedSize||-1==this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize == -1 || uncompressedSize == -1)");if(t=o.findCompression(this.compressionMethod),null===t)throw new Error("Corrupted zip : compression "+o.pretty(this.compressionMethod)+" unknown (inner file : "+o.transformTo("string",this.fileName)+")");if(this.decompressed=new s,this.decompressed.compressedSize=this.compressedSize,this.decompressed.uncompressedSize=this.uncompressedSize,this.decompressed.crc32=this.crc32,this.decompressed.compressionMethod=this.compressionMethod,this.decompressed.getCompressedContent=this.prepareCompressedContent(e,e.index,this.compressedSize,t),this.decompressed.getContent=this.prepareContent(e,e.index,this.compressedSize,t,this.uncompressedSize),this.loadOptions.checkCRC32&&(this.decompressed=o.transformTo("string",this.decompressed.getContent()),r.crc32(this.decompressed)!==this.crc32))throw new Error("Corrupted zip : CRC32 mismatch")},readCentralPart:function(e){if(this.versionMadeBy=e.readInt(2),this.versionNeeded=e.readInt(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4),this.fileNameLength=e.readInt(2),this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");this.fileName=e.readData(this.fileNameLength),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),e==0&&(this.dosPermissions=63&this.externalFileAttributes),e==3&&(this.unixPermissions=65535&this.externalFileAttributes>>16),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var e=new n(this.extraFields[1].value);this.uncompressedSize===o.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===o.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===o.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===o.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(e){var t=e.index,i,n,o;for(this.extraFields=this.extraFields||{};e.index<t+this.extraFieldsLength;)i=e.readInt(2),n=e.readInt(2),o=e.readString(n),this.extraFields[i]={id:i,length:n,value:o}},handleUTF8:function(){var e=l.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=r.utf8decode(this.fileName),this.fileCommentStr=r.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var i=o.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(i)}var n=this.findExtraFieldUnicodeComment();if(null!==n)this.fileCommentStr=n;else{var s=o.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(s)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=new n(e.value);return 1===t.readInt(1)?r.crc32(this.fileName)===t.readInt(4)?r.utf8decode(t.readString(e.length-5)):null:null}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=new n(e.value);return 1===t.readInt(1)?r.crc32(this.fileComment)===t.readInt(4)?r.utf8decode(t.readString(e.length-5)):null:null}return null}},t.exports=i},{"./compressedObject":14,"./object":25,"./stringReader":27,"./support":29,"./utils":33}],36:[function(e,t){"use strict";function i(e){for(var t=Array(e[0].length),n=0;n<t.length;++n)t[n]=Array(e.length);for(n=0;n<e.length;++n)for(var i=0;i<e[0].length;++i)t[i][n]=e[n][i];return t}var n=e("ml-stat").array;t.exports={coordArrayToPoints:function(e,t){if(0!=e.length%t)throw new RangeError("Dimensions number must be accordance with the size of the array.");for(var n=e.length/t,o=Array(n),s=0,r=0,i;r<e.length;r+=t){i=Array(t);for(var l=0;l<t;++l)i[l]=e[r+l];o[s]=i,s++}return o},coordArrayToCoordMatrix:function(e,t){if(0!=e.length%t)throw new RangeError("Dimensions number must be accordance with the size of the array.");for(var n=Array(t),o=e.length/t,s=0;s<n.length;s++)n[s]=Array(o);for(s=0;s<e.length;s+=t)for(var i=0,r;i<t;++i)r=p(s/t),n[i][r]=e[s+i];return n},coordMatrixToCoordArray:function(e){for(var t=Array(e.length*e[0].length),n=0,o=0;o<e[0].length;++o)for(var i=0;i<e.length;++i)t[n]=e[i][o],++n;return t},coordMatrixToPoints:i,pointsToCoordArray:function(e){for(var t=Array(e.length*e[0].length),n=0,o=0;o<e.length;++o)for(var i=0;i<e[0].length;++i)t[n]=e[o][i],++n;return t},pointsToCoordMatrix:i,applyDotProduct:function(e,t){var n,o;e.length<=t.length?(o=e,n=t):(o=t,n=e);for(var s=n.length-o.length+1,r=Array(s),l=0,i;l<s;++l){i=0;for(var a=0;a<o.length;++a)i+=o[a]*n[l+a];r[l]=i}return r},scale:function(e,t){var o=t.inPlace?e:Array(e.length);var s=t.max,r=t.min;if("number"==typeof s){if("number"==typeof r)for(var l=n.minMax(e),a=(s-r)/(l.max-l.min),p=0;p<o.length;p++)o[p]=(e[p]-l.min)*a+r;else for(var i=n.max(e),a=s/i,p=0;p<o.length;p++)o[p]=e[p]*a;}else if("number"==typeof r)for(var i=n.min(e),a=r/i,p=0;p<o.length;p++)o[p]=e[p]*a;return o}}},{"ml-stat":102}],37:[function(e,t,i){"use strict";function n(e,t,n,o,s){function a(e,t,i,n){return(n-t)/(i-e)}var p=e.length,d=(o-n)/(s-1),c=n-d/2,u=Array(s),h=e[1]-e[0],m=e[e.length-1]-e[e.length-2],g=c,f=c+d,y=l,x=0,b=e[0]-h,_=0,k=0,w=0,C=0,v=0,S=0,D=0,i=0;main:for(;;){for(;0<=b-f;){var j=r(0,f-y,w,x);if(S=k+j,u[i]=(S-v)/d,i++,i===s)break main;g=f,f+=d,v=S}y<=g&&g<=b&&(j=r(0,g-y,w,x),v=k+j),k+=r(y,b,w,C),y=b,x=_,D<p?(b=e[D],_=t[D],D++):D===p&&(b+=m,_=0),w=a(y,x,b,_),C=-w*y+x}return u}function o(e,t,n,o,r){var l=e.length,a=(o-n)/(r-1),p=e[e.length-1]-e[e.length-2],d=n-a/2,c=Array(r),u=d,h=d+a,m=-s,g=0,f=e[0],y=t[0],x=0,b=!0,_=0,k=0,w=1,i=0;main:for(;;){if(m>=f)throw new Error("x must be an increasing serie");for(;0<m-h;){if(b&&(k++,b=!1),c[i]=0>=k?0:_/k,i++,i===r)break main;u=h,h+=a,_=0,k=0}m>u&&(_+=g,k++),(m==-s||1<x)&&k--,m=f,g=y,w<l?(f=e[w],y=t[w],w++):(f+=p,y=0,x++)}return c}function r(e,t,i,n){return 0.5*i*t*t+n*t-(0.5*i*e*e+n*e)}i.getEquallySpacedData=function(e,t,i){1<e.length&&e[0]>e[1]&&(e=e.slice().reverse(),t=t.slice().reverse());var s=e.length;if(s!==t.length)throw new RangeError("the x and y vector doesn't have the same size.");i===void 0&&(i={});var r=i.from===void 0?e[0]:i.from;if(isNaN(r)||!isFinite(r))throw new RangeError("'From' value must be a number");var l=i.to===void 0?e[e.length-1]:i.to;if(isNaN(l)||!isFinite(l))throw new RangeError("'To' value must be a number");var a=r>l;if(a){var p=r;r=l,l=p}var d=i.numberOfPoints===void 0?100:i.numberOfPoints;if(isNaN(d)||!isFinite(d))throw new RangeError("'Number of points' value must be a number");if(1>d)throw new RangeError("the number of point must be higher than 1");var c="slot"===i.variant?"slot":"smooth",u="slot"==c?o(e,t,r,l,d):n(e,t,r,l,d);return a?u.reverse():u},i.integral=r},{}],38:[function(e,t,i){"use strict";t.exports=i=e("./ArrayUtils"),i.getEquallySpacedData=e("./getEquallySpaced").getEquallySpacedData,i.SNV=e("./snv").SNV},{"./ArrayUtils":36,"./getEquallySpaced":37,"./snv":39}],39:[function(e,t,i){"use strict";i.SNV=function(e){for(var t=n.mean(e),o=n.standardDeviation(e),s=e.slice(),r=0;r<e.length;r++)s[r]=(s[r]-t)/o;return s};var n=e("ml-stat").array},{"ml-stat":102}],40:[function(e,t){"use strict";function i(e){this.value=e,this.parent=null,this.rank=0}t.exports=class{constructor(){this.nodes=new Map}add(e){var t=this.nodes.get(e);return t||(t=new i(e),this.nodes.set(e,t)),t}union(e,t){var i=this.find(e),n=this.find(t);i===n||(i.rank<n.rank?i.parent=n:i.rank>n.rank?n.parent=i:(n.parent=i,i.rank++))}find(e){for(var t=e;null!==t.parent;)t=t.parent;for(var i=e;null!==i.parent;){var n=i;i=i.parent,n.parent=t}return t}connected(e,t){return this.find(e)===this.find(t)}}},{}],41:[function(e,t){"use strict";function i(e,t){for(var n=0,o=0;o<e.length;o++)n+=(e[o]-t[o])*(e[o]-t[o]);return n}function n(e,t){return u(i(e,t))}t.exports=n,n.squared=i},{}],42:[function(e,t){"use strict";t.exports=function(e,t){for(var n=e.length,o=Array.from({length:n}).map(()=>Array.from({length:n})),s=0;s<n;s++)for(var i=0;i<=s;i++)o[s][i]=t(e[s],e[i]);for(var r=0;r<n;r++)for(var l=r+1;l<n;l++)o[r][l]=o[l][r];return o}},{}],43:[function(e,t){"use strict";var i=e("./fftlib");t.exports={DEBUG:!1,ifft2DArray:function(e,t,n){var o=Array(t*n),s=t/2,r=2*(n-1);i.init(s);for(var l={re:Array(s),im:Array(s)},a=0;a<n;a++){for(var p=s-1;0<=p;p--)l.re[p]=e[2*p*n+a],l.im[p]=e[(2*p+1)*n+a];i.bt(l.re,l.im);for(var p=s-1;0<=p;p--)o[2*p*n+a]=l.re[p],o[(2*p+1)*n+a]=l.im[p]}var d=Array(s*r);i.init(r);for(var c={re:Array(r),im:Array(r)},p=0;p<t;p+=2){c.re[0]=o[p*n],c.im[0]=o[(p+1)*n];for(var a=1;a<n;a++)c.re[a]=o[p*n+a],c.im[a]=o[(p+1)*n+a],c.re[r-a]=o[p*n+a],c.im[r-a]=-o[(p+1)*n+a];i.bt(c.re,c.im);for(var u=p/2*r,a=r-1;0<=a;a--)d[u+a]=c.re[a]/(r*s)}return d},fft2DArray:function(e,t,n){var o=Object.assign({},{inplace:!0}),s=n/2+1,r=2*t,l=Array(r*s);i.init(n);for(var a={re:Array(n),im:Array(n)},p={re:Array(n),im:Array(n)},d={re:Array(n),im:Array(n)},c=0,u,h,m,g,f;c<t/2;c++){u=2*c*n,a.re=e.slice(u,u+n),u=(2*c+1)*n,a.im=e.slice(u,u+n),i.fft1d(a.re,a.im),this.reconstructTwoRealFFT(a,p,d),h=4*c*s,m=(4*c+1)*s,g=(4*c+2)*s,f=(4*c+3)*s;for(var y=s-1;0<=y;y--)l[h+y]=p.re[y],l[m+y]=p.im[y],l[g+y]=d.re[y],l[f+y]=d.im[y]}p=null,d=null;var x=Array(r*s);i.init(t);for(var b={re:Array(t),im:Array(t)},_=s-1;0<=_;_--){for(var c=t-1;0<=c;c--)b.re[c]=l[2*c*s+_],b.im[c]=l[(2*c+1)*s+_],isNaN(b.re[c])&&(b.re[c]=0),isNaN(b.im[c])&&(b.im[c]=0);i.fft1d(b.re,b.im);for(var c=t-1;0<=c;c--)x[2*c*s+_]=b.re[c],x[(2*c+1)*s+_]=b.im[c]}return x},reconstructTwoRealFFT:function(e,t,n){var o=e.re.length;t.re[0]=e.re[0],t.im[0]=0,n.re[0]=e.im[0],n.im[0]=0;for(var s=o/2,i,r,l,a,p;0<s;s--)p=o-s,i=0.5*(e.re[s]-e.re[p]),r=0.5*(e.re[s]+e.re[p]),l=0.5*(e.im[s]-e.im[p]),a=0.5*(e.im[s]+e.im[p]),t.re[s]=r,t.im[s]=l,t.re[p]=r,t.im[p]=-l,n.re[s]=a,n.im[s]=-i,n.re[p]=a,n.im[p]=i},convolute2DI:function(e,t,i,n){for(var o=0,s,r;o<i/2;o++)for(var l=0;l<n;l++)s=e[2*o*n+l]*t[2*o*n+l]-e[(2*o+1)*n+l]*t[(2*o+1)*n+l],r=e[2*o*n+l]*t[(2*o+1)*n+l]+e[(2*o+1)*n+l]*t[2*o*n+l],e[2*o*n+l]=s,e[(2*o+1)*n+l]=r},convolute:function(e,t,n,o){for(var s=Array(o*n),r=0;r<n*o;r++)s[r]=e[r];s=this.fft2DArray(s,n,o);for(var i=t.length,l=t[0].length,a=Array(o*n),r=0;r<o*n;r++)a[r]=0;for(var d=p((i-1)/2),c=p((l-1)/2),u=0,h,m;u<i;u++){h=(u-d+n)%n;for(var g=0;g<l;g++)m=(g-c+o)%o,a[h*o+m]=t[u][g]}a=this.fft2DArray(a,n,o);var f=2*n,y=o/2+1;return this.convolute2DI(s,a,f,y),this.ifft2DArray(s,f,y)},toRadix2:function(e,t,n){var o=n,s=t,r=0,l=0,a,i,d,c;if(0===n||0!=(n&n-1)){for(o=0;0!=n>>++o;);o=1<<o,l=o-n}if(0===t||0!=(t&t-1)){for(s=0;0!=t>>++s;);s=1<<s,r=(s-t)*o}if(s==t&&o==n)return{data:e,rows:t,cols:n};var u=Array(s*o),h=p((s-t)/2)-t,m=p((o-n)/2)-n;for(a=0;a<s;a++)for(d=a*o,c=(a-h)%t*n,i=0;i<o;i++)u[d+i]=e[c+(i-m)%n];return{data:u,rows:s,cols:o}},crop:function(e,t,n,o,s,r){if(t==o&&n==s)return e;var l=Object.assign({},r),a=Array(s*o),d=p((t-o)/2),c=p((n-s)/2),u,h,m,i;for(m=0;m<o;m++)for(u=m*s,h=(m+d)*n,i=0;i<s;i++)a[u+i]=e[h+(i+c)];return a}}},{"./fftlib":44}],44:[function(e,t,n){"use strict";(function(){var e="undefined"==typeof n?{}:n;var t={release:"0.3.0",date:"2013-03"};e.toString=function(){return"version "+t.release+", released "+t.date};for(var o=0,s=null,l=null,a={init:function(e){if(0!==e&&0==(e&e-1))o=e,a._initArray(),a._makeBitReversalTable(),a._makeCosSinTable();else throw new Error("init: radix-2 required")},fft1d:function(e,t){a.fft(e,t,1)},ifft1d:function(e,t){var s=1/o;a.fft(e,t,-1);for(var n=0;n<o;n++)e[n]*=s,t[n]*=s},bt1d:function(e,t){a.fft(e,t,-1)},fft2d:function(e,t){for(var n=[],s=[],r=0,i=0;i<o;i++){r=i*o;for(var l=0;l<o;l++)n[l]=e[l+r],s[l]=t[l+r];a.fft1d(n,s);for(var p=0;p<o;p++)e[p+r]=n[p],t[p+r]=s[p]}for(var d=0;d<o;d++){for(var c=0;c<o;c++)r=d+c*o,n[c]=e[r],s[c]=t[r];a.fft1d(n,s);for(var u=0;u<o;u++)r=d+u*o,e[r]=n[u],t[r]=s[u]}},ifft2d:function(e,t){for(var n=[],s=[],r=0,i=0;i<o;i++){r=i*o;for(var l=0;l<o;l++)n[l]=e[l+r],s[l]=t[l+r];a.ifft1d(n,s);for(var p=0;p<o;p++)e[p+r]=n[p],t[p+r]=s[p]}for(var d=0;d<o;d++){for(var c=0;c<o;c++)r=d+c*o,n[c]=e[r],s[c]=t[r];a.ifft1d(n,s);for(var u=0;u<o;u++)r=d+u*o,e[r]=n[u],t[r]=s[u]}},fft:function(e,t,n){for(var r=o>>2,a=0,p,d,c,u,h,m,g,f,y;a<o;a++)u=s[a],a<u&&(h=e[a],e[a]=e[u],e[u]=h,h=t[a],t[a]=t[u],t[u]=h);for(var x=1;x<o;x<<=1){d=0,p=o/(x<<1);for(var b=0;b<x;b++){m=l[d+r],g=n*l[d];for(var _=b;_<o;_+=x<<1)c=_+x,f=m*e[c]+g*t[c],y=m*t[c]-g*e[c],e[c]=e[_]-f,e[_]+=f,t[c]=t[_]-y,t[_]+=y;d+=p}}},_initArray:function(){s="undefined"==typeof Uint32Array?[]:new Uint32Array(o),l="undefined"==typeof Float64Array?[]:new Float64Array(1.25*o)},_paddingZero:function(){},_makeBitReversalTable:function(){var e=0,t=0,i=0;for(s[0]=0;++e<o;){for(i=o>>1;i<=t;)t-=i,i>>=1;t+=i,s[e]=t}},_makeCosSinTable:function(){var e=o>>1,n=o>>2,a=o>>3,p=r(Math.PI/o),t=2*p*p,d=u(t*(2-t)),h=l[n]=1,c=l[0]=0;p=2*t;for(var s=1;s<a;s++)h-=t,t+=p*h,c+=d,d-=p*c,l[s]=c,l[n-s]=h;0!=a&&(l[a]=0.7071067811865476);for(var i=0;i<n;i++)l[e-i]=l[i];for(var m=0;m<e+n;m++)l[m+e]=-l[m]}},p=["init","fft1d","ifft1d","fft2d","ifft2d"],d=0;d<p.length;d++)e[p[d]]=a[p[d]];return e.bt=a.bt1d,e.fft=a.fft1d,e.ifft=a.ifft1d,e}).call(void 0)},{}],45:[function(e,t,i){"use strict";i.FFTUtils=e("./FFTUtils"),i.FFT=e("./fftlib")},{"./FFTUtils":43,"./fftlib":44}],46:[function(e,t){"use strict";function n(e){for(var t=0,n=0,o=e.length,s=0;s<o;++s)t+=e[s];t/=o;for(var i=Array(o),r=0;r<o;++r)i[r]=C(e[r]-t);return i.sort(),n=1==o%2?i[(o-1)/2]/0.6745:0.5*(i[o/2]+i[o/2-1])/0.6745,n}function o(e,t,i){for(var n=Math.log10,o=0,s,r,l,a,p;o<e.length;o++)p=e[o].i,i[p-1]>=i[p-2]&&i[p-1]>=i[p]?p--:i[p+1]>=i[p]&&i[p+1]>=i[p+2]?p++:i[p-2]>=i[p-3]&&i[p-2]>=i[p-1]?p-=2:i[p+2]>=i[p+1]&&i[p+2]>=i[p+3]&&(p+=2),0<i[p-1]&&0<i[p+1]&&i[p]>=i[p-1]&&i[p]>=i[p+1]&&(s=20*n(i[p-1]),r=20*n(i[p]),l=20*n(i[p+1]),a=0.5*(s-l)/(s-2*r+l),e[o].x=t[p]+(t[p]-t[p-1])*a,e[o].y=i[p]-0.25*(i[p-1]-i[p+1])*a)}var r=e("extend"),l=e("ml-savitzky-golay-generalized"),a={sgOptions:{windowSize:9,polynomial:3},minMaxRatio:2.5e-4,broadRatio:0,maxCriteria:!0,smoothY:!0,realTopDetection:!1,heightFactor:0,boundaries:!1,derivativeThreshold:-1};t.exports=function(e,t,p){p=r({},a,p);var d=p.sgOptions,c=[].concat(t);if(!("noiseLevel"in p)){for(var u=0,h=s,m=0,i;m<e.length-1;++m)i=C(e[m+1]-e[m]),i<h&&(h=i),i>u&&(u=i);p.noiseLevel=0.05>(u-h)/u?n(c):0}var g={m:1,b:p.noiseLevel};p.maxCriteria||(g.m=-1,g.b*=-1);for(var f=0;f<c.length;f++)c[f]=g.m*c[f]-g.b;for(var y=0;y<c.length;y++)0>c[y]&&(c[y]=0);var x=c,b,_;0.05>(u-h)/u?(p.smoothY&&(x=l(c,e[1]-e[0],{windowSize:d.windowSize,polynomial:d.polynomial,derivative:0})),b=l(c,e[1]-e[0],{windowSize:d.windowSize,polynomial:d.polynomial,derivative:1}),_=l(c,e[1]-e[0],{windowSize:d.windowSize,polynomial:d.polynomial,derivative:2})):(p.smoothY&&(x=l(c,e,{windowSize:d.windowSize,polynomial:d.polynomial,derivative:0})),b=l(c,e,{windowSize:d.windowSize,polynomial:d.polynomial,derivative:1}),_=l(c,e,{windowSize:d.windowSize,polynomial:d.polynomial,derivative:2}));for(var w=e,v=e[1]-e[0],S=0,D=0,E=0;E<x.length;E++)C(_[E])>S&&(S=C(_[E])),C(x[E])>D&&(D=C(x[E]));for(var I=null,H=null,A=Array(x.length-2),z=Array(x.length),F=Array(x.length),R=Array(x.length-2),P=0,T=0,O=0,M=0,N=1;N<x.length-1;++N)C(b[N])>p.derivativeThreshold&&((b[N]<b[N-1]&&b[N]<=b[N+1]||b[N]<=b[N-1]&&b[N]<b[N+1])&&(H={x:w[N],index:N},0<v&&null!=I&&(z[T++]=I,F[O++]=H)),(b[N]>=b[N-1]&&b[N]>b[N+1]||b[N]>b[N-1]&&b[N]>=b[N+1])&&(I={x:w[N],index:N},0>v&&null!==H&&(z[T++]=I,F[O++]=H))),_[N]<_[N-1]&&_[N]<_[N+1]&&(A[P++]=N,R[M++]=C(_[N])<=p.broadRatio*S);A.length=P,z.length=T,F.length=O,R.length=M;for(var X=Array(A.length),L=0,Y=-1,U=void 0,B=void 0,V=void 0,q=void 0,$=void 0,Z=0;Z<A.length;++Z){B=w[A[Z]],U=-1;var j=Y+1;for(q=s,V=0,$=!0;-1===U&&j<z.length&&$;)V=C(B-(z[j].x+F[j].x)/2),V<q?q=V:$=!1,V<C(z[j].x-F[j].x)/2&&(U=j,Y=j),++j;if(-1!==U&&C(x[A[Z]])>p.minMaxRatio*D&&(X[L++]={index:A[Z],x:B,y:(x[A[Z]]+g.b)/g.m,width:C(F[U].x-z[U].x),soft:R[Z]},p.boundaries&&(X[L-1].left=z[U],X[L-1].right=F[U]),p.heightFactor)){var k=x[z[U].index],W=x[F[U].index];X[L-1].height=p.heightFactor*(X[L-1].y-(k+W)/2)}}X.length=L,p.realTopDetection&&o(X,w,x);for(var J=0;J<X.length;J++)X[J].base=p.noiseLevel;return X.sort(function(e,t){return e.x-t.x}),X}},{extend:5,"ml-savitzky-golay-generalized":98}],47:[function(e,t){"use strict";t.exports.post=e("../src/optimize"),t.exports.gsd=e("../src/gsd")},{"../src/gsd":46,"../src/optimize":48}],48:[function(e,t){"use strict";function o(e,t,i,n,o){var s=Math.sign,r=i.length,l=[],a=[],p=s(i[1]-i[0]);-1===p&&(o[0]=i.length-1);for(var d=C(t-e)/2,c=(e+t)/2,u=!1,h=o[0];!u&&h<r&&0<=h;)C(i[h]-c)<=d?(l.push(i[h]),a.push(n[h]),h+=p):1===s(c-i[h])?h+=p:u=!0;return o[0]=h,[l,a]}function r(e,t){var n=[],o=[],s=[e[0].x,t*e[0].width],r,i,l,a;for(r=0;r<e.length;r++)C(e[r].x-s[0])<t*e[r].width+s[1]?(n.push(e[r]),l=s[0]+s[1],e[r].x+t*e[r].width>l&&(l=e[r].x+t*e[r].width),a=s[0]-s[1],e[r].x-t*e[r].width<a&&(a=e[r].x-t*e[r].width),s=[(l+a)/2,C(l-a)/2]):(o.push({limits:s,group:n}),n=[e[r]],s=[e[r].x,t*e[r].width]);for(o.push({limits:s,group:n}),r=o.length-2;0<=r;r--)if(C(o[r].limits[0]-o[r+1].limits[0])<(o[r].limits[1]+o[r+1].limits[1])/2){for(i=0;i<o[r+1].group.length;i++)o[r].group.push(o[r+1].group[i]);l=o[r].limits[0]+o[r].limits[1],o[r+1].limits[0]+o[r+1].limits[1]>l&&(l=o[r+1].limits[0]+o[r+1].limits[1]),a=o[r].limits[0]-o[r].limits[1],o[r+1].limits[0]-o[r+1].limits[1]<a&&(a=o[r+1].limits[0]-o[r+1].limits[1]),o[r].limits=[(l+a)/2,C(l-a)/2],o.splice(r+1,1)}return o}var i=e("ml-optimize-lorentzian");t.exports={optimizePeaks:function(e,t,s,l,n){var a=[0],p=r(e,l),d=[],c=1,u,h;"gaussian"===n&&(c=1.17741);var m,g,f;for(u=0;u<p.length;u++){var y=p[u].group;if(1<y.length){if(m=o(p[u].limits[0]-p[u].limits[1],p[u].limits[0]+p[u].limits[1],t,s,a),5<m[0].length){g=y[0].width/1e3,f=[3,100,g,g,g,10*g,10*g,11,9,1];var x=[];for("gaussian"===n?x=i.optimizeGaussianSum(m,y,f):"lorentzian"===n&&(x=i.optimizeLorentzianSum(m,y,f)),h=0;h<x.length;h++)d.push({x:x[h][0][0],y:x[h][1][0],width:x[h][2][0]*c})}}else if(y=y[0],m=o(y.x-l*y.width,y.x+l*y.width,t,s,a),5<m[0].length){g=y.width/1e3,f=[3,100,g,g,g,10*g,10*g,11,9,1];var b=[];"gaussian"===n?b=i.optimizeSingleGaussian([m[0],m[1]],y,f):"lorentzian"===n&&(b=i.optimizeSingleLorentzian([m[0],m[1]],y,f)),d.push({x:b[0][0],y:b[1][0],width:b[2][0]*c})}}return d},joinBroadPeaks:function(e,t){for(var n=t.width,o=[],r=0,l=0,a=1,p=e.length-1;0<=p;p--)e[p].soft&&o.push(e.splice(p,1)[0]);o.push({x:s});for(var d=[[o[0].x,o[0].y]],c=[0],u=1;u<o.length;u++)if(C(o[u-1].x-o[u].x)<n)d.push([o[u].x,o[u].y]),o[u].y>r&&(r=o[u].y,l=u),c.push(u),a++;else{if(2<a){var h=i.optimizeSingleLorentzian(d,{x:o[l].x,y:r,width:C(d[0][0]-d[d.length-1][0])});e.push({x:h[0][0],y:h[1][0],width:h[2][0],soft:!1})}else c.map(function(t){e.push(o[t])});d=[[o[u].x,o[u].y]],c=[u],r=o[u].y,l=u,a=1}return e.sort(function(e,t){return e.x-t.x}),e}}},{"ml-optimize-lorentzian":94}],49:[function(e,t){"use strict";function n(e,t){return 0|e*t}function s(e,t){return _(e-2,0|e*t)}function i(e,t,i){return p(o(e+1,0|4*e/(3*t+i)))}function r(e,t,i){return p(o(e+1,0|4*e/(t+3*i)))}var l=e("new-array"),a=e("./primeFinder"),p=a.nextPrime,d=a.largestPrime,c=0,u=1,h=2;class m{constructor(e={}){if(e instanceof m)return this.table=e.table.slice(),this.values=e.values.slice(),this.state=e.state.slice(),this.minLoadFactor=e.minLoadFactor,this.maxLoadFactor=e.maxLoadFactor,this.distinct=e.distinct,this.freeEntries=e.freeEntries,this.lowWaterMark=e.lowWaterMark,void(this.highWaterMark=e.maxLoadFactor);var t=e.initialCapacity===void 0?150:e.initialCapacity;if(0>t)throw new RangeError(`initial capacity must not be less than zero: ${t}`);var i=e.minLoadFactor===void 0?1/6:e.minLoadFactor,n=e.maxLoadFactor===void 0?2/3:e.maxLoadFactor;if(0>i||1<=i)throw new RangeError(`invalid minLoadFactor: ${i}`);if(0>=n||1<=n)throw new RangeError(`invalid maxLoadFactor: ${n}`);if(i>=n)throw new RangeError(`minLoadFactor (${i}) must be smaller than maxLoadFactor (${n})`);var o=t;o=0|o/n,o=p(o),0===o&&(o=1),this.table=l(o,0),this.values=l(o,0),this.state=l(o,0),this.minLoadFactor=i,this.maxLoadFactor=o===d?1:n,this.distinct=0,this.freeEntries=o,this.lowWaterMark=0,this.highWaterMark=s(o,this.maxLoadFactor)}clone(){return new m(this)}get size(){return this.distinct}get(e){var t=this.indexOfKey(e);return 0>t?0:this.values[t]}set(e,t){var n=this.indexOfInsertion(e);if(0>n)return n=-n-1,this.values[n]=t,!1;if(this.distinct>this.highWaterMark){var o=i(this.distinct+1,this.minLoadFactor,this.maxLoadFactor);return this.rehash(o),this.set(e,t)}if(this.table[n]=e,this.values[n]=t,this.state[n]===c&&this.freeEntries--,this.state[n]=u,this.distinct++,1>this.freeEntries){var s=i(this.distinct+1,this.minLoadFactor,this.maxLoadFactor);this.rehash(s)}return!0}remove(e,t){var n=this.indexOfKey(e);return!(0>n)&&(this.state[n]=h,this.distinct--,t||this.maybeShrinkCapacity(),!0)}delete(e,t){var n=this.indexOfKey(e);return!(0>n)&&(this.state[n]=c,this.distinct--,t||this.maybeShrinkCapacity(),!0)}maybeShrinkCapacity(){if(this.distinct<this.lowWaterMark){var e=r(this.distinct,this.minLoadFactor,this.maxLoadFactor);this.rehash(e)}}containsKey(e){return 0<=this.indexOfKey(e)}indexOfKey(e){var t=this.table,n=this.state,o=this.table.length,s=2147483647&e,r=s%o,i=s%(o-2);for(0==i&&(i=1);n[r]!==c&&(n[r]===h||t[r]!==e);)r-=i,0>r&&(r+=o);return n[r]===c?-1:r}containsValue(e){return 0<=this.indexOfValue(e)}indexOfValue(e){for(var t=this.values,n=this.state,o=0;o<n.length;o++)if(n[o]===u&&t[o]===e)return o;return-1}indexOfInsertion(e){var t=this.table,n=this.state,o=t.length,s=2147483647&e,r=s%o,l=s%(o-2);for(0==l&&(l=1);n[r]===u&&t[r]!==e;)r-=l,0>r&&(r+=o);if(n[r]===h){for(var a=r;n[r]!==c&&(n[r]===h||t[r]!==e);)r-=l,0>r&&(r+=o);n[r]===c&&(r=a)}return n[r]===u?-r-1:r}ensureCapacity(e){if(this.table.length<e){var t=p(e);this.rehash(t)}}rehash(e){var t=this.table.length;if(e<=this.distinct)throw new Error("Unexpected");var o=this.table,r=this.values,a=this.state,p=l(e,0),d=l(e,0),c=l(e,0);this.lowWaterMark=n(e,this.minLoadFactor),this.highWaterMark=s(e,this.maxLoadFactor),this.table=p,this.values=d,this.state=c,this.freeEntries=e-this.distinct;for(var h=0;h<t;h++)if(a[h]===u){var i=o[h],m=this.indexOfInsertion(i);p[m]=i,d[m]=r[h],c[m]=u}}forEachKey(e){for(var t=0;t<this.state.length;t++)if(this.state[t]===u&&!e(this.table[t]))return!1;return!0}forEachValue(e){for(var t=0;t<this.state.length;t++)if(this.state[t]===u&&!e(this.values[t]))return!1;return!0}forEachPair(e){for(var t=0;t<this.state.length;t++)if(this.state[t]===u&&!e(this.table[t],this.values[t]))return!1;return!0}}t.exports=m},{"./primeFinder":50,"new-array":104}],50:[function(e,t,i){"use strict";var n=e("binary-search"),o=e("num-sort").asc,s=2147483647,r=[s,5,11,23,47,97,197,397,797,1597,3203,6421,12853,25717,51437,102877,205759,411527,823117,1646237,3292489,6584983,13169977,26339969,52679969,105359939,210719881,421439783,842879579,1685759167,433,877,1759,3527,7057,14143,28289,56591,113189,226379,452759,905551,1811107,3622219,7244441,14488931,28977863,57955739,115911563,231823147,463646329,927292699,1854585413,953,1907,3821,7643,15287,30577,61169,122347,244703,489407,978821,1957651,3915341,7830701,15661423,31322867,62645741,125291483,250582987,501165979,1002331963,2004663929,1039,2081,4177,8363,16729,33461,66923,133853,267713,535481,1070981,2141977,4283963,8567929,17135863,34271747,68543509,137087021,274174111,548348231,1096696463,31,67,137,277,557,1117,2237,4481,8963,17929,35863,71741,143483,286973,573953,1147921,2295859,4591721,9183457,18366923,36733847,73467739,146935499,293871013,587742049,1175484103,599,1201,2411,4831,9677,19373,38747,77509,155027,310081,620171,1240361,2480729,4961459,9922933,19845871,39691759,79383533,158767069,317534141,635068283,1270136683,311,631,1277,2557,5119,10243,20507,41017,82037,164089,328213,656429,1312867,2625761,5251529,10503061,21006137,42012281,84024581,168049163,336098327,672196673,1344393353,3,7,17,37,79,163,331,673,1361,2729,5471,10949,21911,43853,87719,175447,350899,701819,1403641,2807303,5614657,11229331,22458671,44917381,89834777,179669557,359339171,718678369,1437356741,43,89,179,359,719,1439,2879,5779,11579,23159,46327,92657,185323,370661,741337,1482707,2965421,5930887,11861791,23723597,47447201,94894427,189788857,379577741,759155483,1518310967,379,761,1523,3049,6101,12203,24407,48817,97649,195311,390647,781301,1562611,3125257,6250537,12501169,25002389,50004791,100009607,200019221,400038451,800076929,1600153859,13,29,59,127,257,521,1049,2099,4201,8419,16843,33703,67409,134837,269683,539389,1078787,2157587,4315183,8630387,17260781,34521589,69043189,138086407,276172823,552345671,1104691373,19,41,83,167,337,677,1361,2729,5471,10949,21911,43853,87719,175447,350899,701819,1403641,2807303,5614657,11229331,22458671,44917381,89834777,179669557,359339171,718678369,1437356741,53,107,223,449,907,1823,3659,7321,14653,29311,58631,117269,234539,469099,938207,1876417,3752839,7505681,15011389,30022781,60045577,120091177,240182359,480364727,960729461,1921458943];r.sort(o),i.nextPrime=function(e){var t=n(r,e,o);return 0>t&&(t=~t),r[t]},i.largestPrime=s},{"binary-search":2,"num-sort":112}],51:[function(e,t){"use strict";function i(){this.children=[],this.distance=-1,this.index=[]}var o=e("heap");i.prototype.cut=function(e){if(0>e)throw new RangeError("Threshold too small");var t=new i;t.children=this.children,t.distance=this.distance,t.index=this.index;for(var n=[t],o=[];0<n.length;){var s=n.shift();e>=s.distance?o.push(s):n=n.concat(s.children)}return o},i.prototype.group=function(e){if(!n(e)||1>e)throw new RangeError("Number of groups must be a positive integer");var t=new o(function(e,t){return t.distance-e.distance});for(t.push(this);t.size()<e;){var s=t.pop();if(0===s.children.length)break;s.children.forEach((e)=>t.push(e))}var r=new i;return r.children=t.toArray(),r.distance=this.distance,r},i.prototype.traverse=function(e){function t(e,n){if(n(e),e.children)for(var o=e.children.length-1;0<=o;o--)t(e.children[o],n)}t(this,e)},t.exports=i},{heap:6}],52:[function(e,t){"use strict";function i(e){n.call(this),this.index=e,this.distance=0,this.children=[]}var n=e("./Cluster"),o=e("util");o.inherits(i,n),t.exports=i},{"./Cluster":51,util:160}],53:[function(e,t){"use strict";function i(e,t,n){for(var o=1e101,s=0;s<e.length;s++)for(var i=0,r;i<t.length;i++)r=n[e[s]][t[i]],o=_(r,o);return o}function n(e,t,n){for(var s=-1,r=0;r<e.length;r++)for(var i=0,l;i<t.length;i++)l=n[e[r]][t[i]],s=o(l,s);return s}function s(e,t,n){for(var o=0,s=0;s<e.length;s++)for(var i=0;i<t.length;i++)o+=n[e[s]][t[i]];return o/(e.length*t.length)}function r(e,t,n){for(var o=Array(e.length*t.length),s=0;s<e.length;s++)for(var i=0;i<t.length;i++)o[s*t.length+i]=n[e[s]][t[i]];return d(o)}function l(e,t,i){return r(e,t,i)*e.length*t.length/(e.length+t.length)}function a(e,t){return e-t}function d(e,t){t===void 0&&(t=!1),t||(e=[].concat(e).sort(a));var i=e.length,n=p(i/2);return 0==i%2?0.5*(e[n-1]+e[n]):e[n]}var c=e("ml-distance-euclidean"),u=e("./ClusterLeaf"),h=e("./Cluster"),m=e("ml-distance-matrix"),g={disFunc:c,kind:"single",isDistanceMatrix:!1};t.exports=function(t,o){o=Object.assign({},g,o);var a=t.length,p=t;if(o.isDistanceMatrix||(p=m(t,o.disFunc)),"string"==typeof o.kind)switch(o.kind){case"single":o.kind=i;break;case"complete":o.kind=n;break;case"average":o.kind=s;break;case"centroid":o.kind=r;break;case"ward":o.kind=l;break;default:throw new RangeError("Unknown kind of similarity");}else if("function"!=typeof o.kind)throw new TypeError("Undefined kind of similarity");for(var c=Array(a),y=0;y<p.length;y++)c[y]=new u(y);for(var x=1e6,b={},d=0;1<c.length;){b={},x=1e6;for(var w=0;w<c.length;w++)for(var j=w+1;j<c.length;j++){var k,C;if(c[w]instanceof u)k=[c[w].index];else{k=Array(c[w].index.length);for(var v=0;v<k.length;v++)k[v]=c[w].index[v].index}if(c[j]instanceof u)C=[c[j].index];else{C=Array(c[j].index.length);for(var e=0;e<C.length;e++)C[e]=c[j].index[e].index}d=o.kind(k,C,p).toFixed(4),d in b?b[d].push([c[w],c[j]]):b[d]=[[c[w],c[j]]],x=_(d,x)}for(var f=b[x.toFixed(4)],S=Array(f.length),D=0,E;0<f.length;){E=f.shift();for(var I=0,H;I<f.length;I++)if(H=f[I].filter(function(e){return-1!==E.indexOf(e)}),0<H.length){var A=f[I].filter(function(e){return-1===E.indexOf(e)});E=E.concat(A),f.splice(I--,1)}S[D++]=E}S.length=D;for(var z=0,F;z<S.length;z++){F=new h,F.children=S[z].concat(),F.distance=x,F.index=Array(a);for(var R=0,P=0;P<S[z].length;P++)S[z][P]instanceof u?F.index[R++]=S[z][P]:(R+=S[z][P].index.length,F.index=S[z][P].index.concat(F.index)),c.splice(c.indexOf(S[z][P]),1);F.index.length=R,c.push(F)}}return c[0]}},{"./Cluster":51,"./ClusterLeaf":52,"ml-distance-euclidean":41,"ml-distance-matrix":42}],54:[function(e,t){"use strict";function i(e,t,n){for(var o=1e101,s=0;s<e.length;s++)for(var i=s,r;i<t.length;i++)r=n(e[s],t[i]),o=_(r,o);return o}function n(e,t,n){for(var s=-1,r=0;r<e.length;r++)for(var i=r,l;i<t.length;i++)l=n(e[r],t[i]),s=o(l,s);return s}function s(e,t,n){for(var o=0,s=0;s<e.length;s++)for(var i=0;i<t.length;i++)o+=n(e[s],t[i]);return o/(e.length*t.length)}function r(e,t,n){for(var o=0,s=0,r=0,l=0,a=0;a<e.length;a++)o+=e[a][0],s+=e[a][1];for(var i=0;i<t.length;i++)r+=t[i][0],l+=t[i][1];return o/=e.length,s/=e.length,r/=t.length,l/=t.length,n([o,s],[r,l])}function l(e,t,n){for(var o=0,s=0,r=0,l=0,a=0;a<e.length;a++)o+=e[a][0],s+=e[a][1];for(var i=0;i<t.length;i++)r+=t[i][0],l+=t[i][1];return o/=e.length,s/=e.length,r/=t.length,l/=t.length,n([o,s],[r,l])*e.length*t.length/(e.length+t.length)}function a(t,n,o){for(var s={d:0,p:0},r=Array(t[0].length),l=0;l<t[0].length;l++)r[l]=n[t[0][l]];for(var e=Array(t[1].length),a=0;a<t[1].length;a++)e[a]=n[t[1][a]];for(var p=0,i,d;p<r.length;p++){i=0;for(var c=0;c<r.length;c++)p!==c&&(i+=o(r[p],r[c]));i/=r.length-1,d=0;for(var u=0;u<e.length;u++)d+=o(r[p],e[u]);d/=e.length,i-d>s.d&&(s.d=i-d,s.p=p)}return s}function p(e,t,n){for(var o=0,s=0,r=0;r<e.length;r++)for(var i=r;i<e.length;i++)o+=n(t[e[r].index],t[e[i].index]),s++;return o/s}var d=e("ml-distance-euclidean"),c=e("./ClusterLeaf"),u=e("./Cluster"),h={dist:d,kind:"single"};t.exports=function(t,g){if(g=Object.assign({},h,g),"string"==typeof g.kind)switch(g.kind){case"single":g.kind=i;break;case"complete":g.kind=n;break;case"average":g.kind=s;break;case"centroid":g.kind=r;break;case"ward":g.kind=l;break;default:throw new RangeError("Unknown kind of similarity");}else if("function"!=typeof g.kind)throw new TypeError("Undefined kind of similarity");var y=new u;y.children=Array(t.length),y.index=Array(t.length);for(var x=0;x<t.length;x++)y.children[x]=new c(x),y.index[x]=new c(x);y.distance=p(y.index,t,g.dist);for(var b=[y],_,m,k,w,v;0<b.length;){m=0,k=0;for(var S=0;S<b.length;S++){_=0;for(var D=0;D<b[S].length;D++)for(var j=D+1;j<b[S].length;j++)_=o(g.dist(t[b[S].index[D].index],t[b[S].index[j].index]),_);_>m&&(m=_,k=S)}if(m=0,2===b[k].index.length)b[k].children=[b[k].index[0],b[k].index[1]],b[k].distance=g.dist(t[b[k].index[0].index],t[b[k].index[1].index]);else if(3===b[k].index.length){b[k].children=[b[k].index[0],b[k].index[1],b[k].index[2]];var E=[g.dist(t[b[k].index[0].index],t[b[k].index[1].index]),g.dist(t[b[k].index[1].index],t[b[k].index[2].index])];b[k].distance=(E[0]+E[1])/2}else{for(var d=new u,C=new u,I=[Array(b[k].index.length),[]],H=0;H<I[0].length;H++)I[0][H]=H;for(var A=0;A<I[0].length;A++){w=0;for(var z=0;z<I[0].length;z++)A!==z&&(w+=g.dist(t[b[k].index[I[0][z]].index],t[b[k].index[I[0][A]].index]));w/=I[0].length-1,w>m&&(m=w,v=A)}for(I[1]=[v],I[0].splice(v,1),w=a(I,t,g.dist);0<w.d;)I[1].push(I[0][w.p]),I[0].splice(w.p,1),w=a(I,t,g.dist);var F=Array(I[0].length);d.index=Array(I[0].length);for(var R=0;R<F.length;R++)F[R]=t[b[k].index[I[0][R]].index],d.index[R]=b[k].index[I[0][R]],d.children[R]=b[k].index[I[0][R]];var e=Array(I[1].length);C.index=Array(I[1].length);for(var P=0;P<e.length;P++)e[P]=t[b[k].index[I[1][P]].index],C.index[P]=b[k].index[I[1][P]],C.children[P]=b[k].index[I[1][P]];d.distance=p(d.index,t,g.dist),C.distance=p(C.index,t,g.dist),b.push(d),b.push(C),b[k].children=[d,C]}b.splice(k,1)}return y}},{"./Cluster":51,"./ClusterLeaf":52,"ml-distance-euclidean":41}],55:[function(e,t,i){"use strict";i.agnes=e("./agnes"),i.diana=e("./diana")},{"./agnes":53,"./diana":54}],56:[function(e,t){"use strict";var i=e("./fftlib");t.exports={DEBUG:!1,ifft2DArray:function(e,t,n){var o=Array(t*n),s=t/2,r=2*(n-1);i.init(s);for(var l={re:Array(s),im:Array(s)},a=0;a<n;a++){for(var p=s-1;0<=p;p--)l.re[p]=e[2*p*n+a],l.im[p]=e[(2*p+1)*n+a];i.bt(l.re,l.im);for(var p=s-1;0<=p;p--)o[2*p*n+a]=l.re[p],o[(2*p+1)*n+a]=l.im[p]}var d=Array(s*r);i.init(r);for(var c={re:Array(r),im:Array(r)},p=0;p<t;p+=2){c.re[0]=o[p*n],c.im[0]=o[(p+1)*n];for(var a=1;a<n;a++)c.re[a]=o[p*n+a],c.im[a]=o[(p+1)*n+a],c.re[r-a]=o[p*n+a],c.im[r-a]=-o[(p+1)*n+a];i.bt(c.re,c.im);for(var u=p/2*r,a=r-1;0<=a;a--)d[u+a]=c.re[a]/(r*s)}return d},fft2DArray:function(e,t,n){var o=Object.assign({},{inplace:!0}),s=n/2+1,r=2*t,l=Array(r*s);i.init(n);for(var a={re:Array(n),im:Array(n)},p={re:Array(n),im:Array(n)},d={re:Array(n),im:Array(n)},c=0,u,h,m,g,f;c<t/2;c++){u=2*c*n,a.re=e.slice(u,u+n),u=(2*c+1)*n,a.im=e.slice(u,u+n),i.fft1d(a.re,a.im),this.reconstructTwoRealFFT(a,p,d),h=4*c*s,m=(4*c+1)*s,g=(4*c+2)*s,f=(4*c+3)*s;for(var y=s-1;0<=y;y--)l[h+y]=p.re[y],l[m+y]=p.im[y],l[g+y]=d.re[y],l[f+y]=d.im[y]}p=null,d=null;var x=Array(r*s);i.init(t);for(var b={re:Array(t),im:Array(t)},_=s-1;0<=_;_--){for(var c=t-1;0<=c;c--)b.re[c]=l[2*c*s+_],b.im[c]=l[(2*c+1)*s+_],isNaN(b.re[c])&&(b.re[c]=0),isNaN(b.im[c])&&(b.im[c]=0);i.fft1d(b.re,b.im);for(var c=t-1;0<=c;c--)x[2*c*s+_]=b.re[c],x[(2*c+1)*s+_]=b.im[c]}return x},reconstructTwoRealFFT:function(e,t,n){var o=e.re.length;t.re[0]=e.re[0],t.im[0]=0,n.re[0]=e.im[0],n.im[0]=0;for(var s=o/2,i,r,l,a,p;0<s;s--)p=o-s,i=0.5*(e.re[s]-e.re[p]),r=0.5*(e.re[s]+e.re[p]),l=0.5*(e.im[s]-e.im[p]),a=0.5*(e.im[s]+e.im[p]),t.re[s]=r,t.im[s]=l,t.re[p]=r,t.im[p]=-l,n.re[s]=a,n.im[s]=-i,n.re[p]=a,n.im[p]=i},convolute2DI:function(e,t,i,n){for(var o=0,s,r;o<i/2;o++)for(var l=0;l<n;l++)s=e[2*o*n+l]*t[2*o*n+l]-e[(2*o+1)*n+l]*t[(2*o+1)*n+l],r=e[2*o*n+l]*t[(2*o+1)*n+l]+e[(2*o+1)*n+l]*t[2*o*n+l],e[2*o*n+l]=s,e[(2*o+1)*n+l]=r},convolute:function(e,t,n,o){for(var s=Array(o*n),r=0;r<n*o;r++)s[r]=e[r];s=this.fft2DArray(s,n,o);for(var i=t.length,l=t[0].length,a=Array(o*n),r=0;r<o*n;r++)a[r]=0;for(var d=p((i-1)/2),c=p((l-1)/2),u=0,h,m;u<i;u++){h=(u-d+n)%n;for(var g=0;g<l;g++)m=(g-c+o)%o,a[h*o+m]=t[u][g]}a=this.fft2DArray(a,n,o);var f=2*n,y=o/2+1;return this.convolute2DI(s,a,f,y),this.ifft2DArray(s,f,y)},toRadix2:function(e,t,n){var o=n,s=t,r=0,l=0,a,i,d,c;if(0===n||0!=(n&n-1)){for(o=0;0!=n>>++o;);o=1<<o,l=o-n}if(0===t||0!=(t&t-1)){for(s=0;0!=t>>++s;);s=1<<s,r=(s-t)*o}if(s==t&&o==n)return{data:e,rows:t,cols:n};var u=Array(s*o),h=p((s-t)/2)-t,m=p((o-n)/2)-n;for(a=0;a<s;a++)for(d=a*o,c=(a-h)%t*n,i=0;i<o;i++)u[d+i]=e[c+(i-m)%n];return{data:u,rows:s,cols:o}},crop:function(e,t,n,o,s,r){if(t==o&&n==s)return e;var l=Object.assign({},r),a=Array(s*o),d=p((t-o)/2),c=p((n-s)/2),u,h,m,i;for(m=0;m<o;m++)for(u=m*o,h=(m+d)*n,i=0;i<s;i++)a[u+i]=e[h+(i+c)];return a}}},{"./fftlib":57}],57:[function(e,t,i){arguments[4][44][0].apply(i,arguments)},{dup:44}],58:[function(e,t,i){arguments[4][45][0].apply(i,arguments)},{"./FFTUtils":56,"./fftlib":57,dup:45}],59:[function(e,i){"use strict";"use strict;";function o(e){var t=e,o,s;if("number"!=typeof e[0]){o=e.length,s=e[0].length,t=Array(o*s);for(var r=0;r<o;r++)for(var i=0;i<s;i++)t[r*s+i]=e[r][i]}else{var l=u(e.length);n(l)&&(o=l,s=l)}return{data:t,rows:o,cols:s}}var s=e("ml-fft").FFTUtils;i.exports={fft:function(e,t,n){var r=o(e),l=r.data,a=Object.assign({normalize:!1,divisor:1,rows:r.rows,cols:r.cols},n),p,d;if(a.rows&&a.cols)p=a.rows,d=a.cols;else throw new Error("Invalid number of rows or columns "+p+" "+d);var c=a.divisor,u=t.length,h=t[0].length,m,i;if(a.normalize)for(c=0,m=0;m<u;m++)for(i=0;i<h;i++)c+=t[m][i];if(0===c)throw new RangeError("convolution: The divisor is equal to zero");var g=s.toRadix2(l,p,d),f=s.convolute(g.data,t,g.rows,g.cols);if(f=s.crop(f,g.rows,g.cols,p,d),0!=c)for(m=0;m<f.length;m++)f[m]/c;return f},direct:function(e,t,n){var s=o(e),r=s.data,l=Object.assign({normalize:!1,divisor:1,rows:s.rows,cols:s.cols},n),a,d;if(l.rows&&l.cols)a=l.rows,d=l.cols;else throw new Error("Invalid number of rows or columns "+a+" "+d);var c=l.divisor,u=t.length,h=t[0].length,m,i,g,f,y,x,b,_,k;if(l.normalize)for(c=0,m=0;m<u;m++)for(i=0;i<h;i++)c+=t[m][i];if(0===c)throw new RangeError("convolution: The divisor is equal to zero");var j=Array(a*d),w=p(u/2),C=p(h/2);for(f=0;f<a;f++)for(g=0;g<d;g++){for(x=0,i=0;i<u;i++)for(m=0;m<h;m++)b=t[u-i-1][h-m-1],_=(f+i-w+a)%a,k=(g+m-C+d)%d,y=_*d+k,x+=r[y]*b;y=f*d+g,j[y]=x/c}return j},kernelFactory:{LoG:function(e,n,o){var s=1e3;o&&o.factor&&(s=o.factor);var r=Array(n),l,i,a,p;s*=-1;var d=(n-1)/2;for(l=0;l<n;l++)for(r[l]=Array(n),p=(l-d)*(l-d),i=0;i<n;i++)a=-((i-d)*(i-d)+p)/(2*e*e),r[l][i]=t(s*(1+a)*c(a));return r}},matrix2Array:o}},{"ml-fft":58}],60:[function(e,t){"use strict";var n=e("ml-disjoint-set"),o=[-1,0],s=[0,-1],r=[null,null],l=[-1,-1,0,1],a=[0,-1,-1,-1],p=[null,null,null,null];t.exports=function(e,t,d,c){c=c||{};var u=c.neighbours||8,h,m,g;if(8===u)h=l,m=a,g=p;else if(4===u)h=o,m=s,g=r;else throw new RangeError("unsupported neighbours count: "+u);for(var f=e.length,y=Array(f),x=new Int16Array(f),b=new n,_=1,w=0,j;w<d;w++)for(var C=0,i;C<t;C++)if(i=null,j=C+w*t,e[j]){for(var v=0;v<g.length;v++){var k=C+h[v],S=w+m[v];if(0<=k&&0<=S&&k<t&&S<d){var D=y[k+S*t];D?(g[v]=D,(!i||g[v].value<i.value)&&(i=g[v])):g[v]=null}}if(!i)y[j]=b.add(_++);else{y[j]=i;for(var v=0;v<g.length;v++)g[v]&&g[v]!==i&&b.union(i,g[v])}}for(var w=0;w<d;w++)for(var C=0;C<t;C++)j=C+w*t,e[j]&&(x[j]=b.find(y[j]).value);return x}},{"ml-disjoint-set":40}],61:[function(e,t){"use strict";function n(e,t,n,o){var s={},r,l,a,p;for(p=0;p<e.length;p++)0!=e[p]&&(l=p%o,r=(p-l)/o,s[e[p]]?(a=s[e[p]],a.x+=l*t[p],a.y+=r*t[p],a.z+=t[p],l<a.minX&&(a.minX=l),l>a.maxX&&(a.maxX=l),r<a.minY&&(a.minY=r),r>a.maxY&&(a.maxY=r)):s[e[p]]={x:l*t[p],y:r*t[p],z:t[p],minX:l,maxX:l,minY:r,maxY:r});var i=Object.keys(s),d=Array(i.length);for(p=0;p<i.length;p++)d[p]=s[i[p]],d[p].x/=d[p].z,d[p].y/=d[p].z;return d}var i=e("ml-stat").array,o=e("ml-matrix-convolution"),s=e("./ccLabeling"),r=[[0,0,1,2,2,2,1,0,0],[0,1,4,7,7,7,4,1,0],[1,4,5,3,0,3,5,4,1],[2,7,3,-12,-23,-12,3,7,2],[2,7,0,-23,-40,-23,0,7,2],[2,7,3,-12,-23,-12,3,7,2],[1,4,5,3,0,3,5,4,1],[0,1,3,7,7,7,3,1,0],[0,0,1,2,2,2,1,0,0]];t.exports={findPeaks2DRegion:function(e,t){var l=Object.assign({},{nStdev:3,kernel:r},t),a=o.matrix2Array(e),p=a.data,d;a.rows&&a.cols&&(l.rows=a.rows,l.cols=a.cols);var i=l.rows,c=l.cols;if(!i||!c)throw new Error("Invalid number of rows or columns "+i+" "+c);var h=l.kernel,m=l.filteredData;m||(m=o.fft(p,h,l));var g=l.nStdev,y=0;for(d=c*i-2;0<=d;d--)y+=f(m[d]-m[d+1],2);y=-u(y),y*=g/i;var x=Array(c*i);for(d=c*i-1;0<=d;d--)x[d]=0;var b=0;for(d=m.length-1;0<=d;d--)m[d]<y&&(x[d]=1,b++);var _=s(x,c,i,{neighbours:8}),k=n(_,p,i,c);return 0<k.length,k},findPeaks2DMax:function(e,t){var n=Object.assign({},{nStdev:3,kernel:r},t),s=o.matrix2Array(e),l=s.data;s.rows&&s.cols&&(n.rows=s.rows,n.cols=s.cols);var a=n.rows,d=n.cols;if(!a||!d)throw new Error("Invalid number of rows or columns "+a+" "+d);var c=n.kernel,h=n.filteredData;h||(h=o.fft(l,c,n));for(var m=n.nStdev,g=0,y=d*a-2;0<=y;y--)g+=f(h[y]-h[y+1],2);g=-u(g),g*=m/a;for(var i=[],x=0,y=0,b,_;y<h.length;y++)h[y]<g&&(b=p(y/d),_=y%d,0<b&&b+1<a&&_+1<d&&0<_&&h[y]<h[y+1]&&h[y]<h[y-1]&&(x=(b-1)*d+_,h[y]<h[x-1]&&h[y]<h[x]&&h[y]<h[x+1]&&(x=(b+1)*d+_,h[y]<h[x-1]&&h[y]<h[x]&&h[y]<h[x+1]&&i.push({x:_,y:b,z:l[y]}))));return i}}},{"./ccLabeling":60,"ml-matrix-convolution":59,"ml-stat":102}],62:[function(e,t,i){"use strict";function n(e){function t(e,t){if(e.rows!==t.rows||e.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal")}function n(e,t){return e-t}function y(e,t){for(var i in t)e=e.replace(new RegExp("%"+i+"%","g"),t[i]);return e}e===void 0&&(e=Object);class x extends e{static get[Symbol.species](){return this}static from1DArray(e,t,i){if(e*t!==i.length)throw new RangeError("Data length does not match given dimensions");for(var n=new this(e,t),o=0;o<e;o++)for(var s=0;s<t;s++)n.set(o,s,i[o*t+s]);return n}static rowVector(e){for(var t=new this(1,e.length),n=0;n<e.length;n++)t.set(0,n,e[n]);return t}static columnVector(e){for(var t=new this(e.length,1),n=0;n<e.length;n++)t.set(n,0,e[n]);return t}static empty(e,t){return new this(e,t)}static zeros(e,t){return this.empty(e,t).fill(0)}static ones(e,t){return this.empty(e,t).fill(1)}static rand(e,t,n){n===void 0&&(n=Math.random);for(var o=this.empty(e,t),s=0;s<e;s++)for(var i=0;i<t;i++)o.set(s,i,n());return o}static randInt(e,t,n,o){n===void 0&&(n=1e3),o===void 0&&(o=Math.random);for(var s=this.empty(e,t),r=0;r<e;r++)for(var i=0,l;i<t;i++)l=p(o()*n),s.set(r,i,l);return s}static eye(e,t,n){t===void 0&&(t=e),n===void 0&&(n=1);for(var o=_(e,t),s=this.zeros(e,t),r=0;r<o;r++)s.set(r,r,n);return s}static diag(e,t,n){var o=e.length;t===void 0&&(t=o),n===void 0&&(n=t);for(var s=_(o,t,n),r=this.zeros(t,n),l=0;l<s;l++)r.set(l,l,e[l]);return r}static min(e,t){e=this.checkMatrix(e),t=this.checkMatrix(t);for(var n=e.rows,o=e.columns,s=new this(n,o),r=0;r<n;r++)for(var i=0;i<o;i++)s.set(r,i,_(e.get(r,i),t.get(r,i)));return s}static max(e,t){e=this.checkMatrix(e),t=this.checkMatrix(t);for(var n=e.rows,s=e.columns,r=new this(n,s),l=0;l<n;l++)for(var i=0;i<s;i++)r.set(l,i,o(e.get(l,i),t.get(l,i)));return r}static checkMatrix(e){return x.isMatrix(e)?e:new this(e)}static isMatrix(e){return null!=e&&"Matrix"===e.klass}get size(){return this.rows*this.columns}apply(e){if("function"!=typeof e)throw new TypeError("callback must be a function");for(var t=this.rows,n=this.columns,o=0;o<t;o++)for(var i=0;i<n;i++)e.call(this,o,i);return this}to1DArray(){for(var e=Array(this.size),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e[t*this.columns+i]=this.get(t,i);return e}to2DArray(){for(var e=Array(this.rows),t=0;t<this.rows;t++){e[t]=Array(this.columns);for(var i=0;i<this.columns;i++)e[t][i]=this.get(t,i)}return e}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isSymmetric(){if(this.isSquare()){for(var e=0;e<this.rows;e++)for(var t=0;t<=e;t++)if(this.get(e,t)!==this.get(t,e))return!1;return!0}return!1}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(e,t){e=e||1,t=t||1;for(var n=new this.constructor[Symbol.species](this.rows*e,this.columns*t),o=0;o<e;o++)for(var i=0;i<t;i++)n.setSubMatrix(this,this.rows*o,this.columns*i);return n}fill(e){for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,e);return this}neg(){return this.mulS(-1)}getRow(e){a.checkRowIndex(this,e);for(var t=Array(this.columns),n=0;n<this.columns;n++)t[n]=this.get(e,n);return t}getRowVector(e){return this.constructor.rowVector(this.getRow(e))}setRow(e,t){a.checkRowIndex(this,e),t=a.checkRowVector(this,t);for(var n=0;n<this.columns;n++)this.set(e,n,t[n]);return this}swapRows(e,t){a.checkRowIndex(this,e),a.checkRowIndex(this,t);for(var n=0,i;n<this.columns;n++)i=this.get(e,n),this.set(e,n,this.get(t,n)),this.set(t,n,i);return this}getColumn(e){a.checkColumnIndex(this,e);for(var t=Array(this.rows),n=0;n<this.rows;n++)t[n]=this.get(n,e);return t}getColumnVector(e){return this.constructor.columnVector(this.getColumn(e))}setColumn(e,t){a.checkColumnIndex(this,e),t=a.checkColumnVector(this,t);for(var n=0;n<this.rows;n++)this.set(n,e,t[n]);return this}swapColumns(e,t){a.checkColumnIndex(this,e),a.checkColumnIndex(this,t);for(var n=0,i;n<this.rows;n++)i=this.get(n,e),this.set(n,e,this.get(n,t)),this.set(n,t,i);return this}addRowVector(e){e=a.checkRowVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)+e[i]);return this}subRowVector(e){e=a.checkRowVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)-e[i]);return this}mulRowVector(e){e=a.checkRowVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)*e[i]);return this}divRowVector(e){e=a.checkRowVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)/e[i]);return this}addColumnVector(e){e=a.checkColumnVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)+e[t]);return this}subColumnVector(e){e=a.checkColumnVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)-e[t]);return this}mulColumnVector(e){e=a.checkColumnVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)*e[t]);return this}divColumnVector(e){e=a.checkColumnVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)/e[t]);return this}mulRow(e,t){a.checkRowIndex(this,e);for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t);return this}mulColumn(e,t){a.checkColumnIndex(this,e);for(var n=0;n<this.rows;n++)this.set(n,e,this.get(n,e)*t);return this}max(){for(var e=this.get(0,0),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.get(t,i)>e&&(e=this.get(t,i));return e}maxIndex(){for(var e=this.get(0,0),t=[0,0],n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.get(n,i)>e&&(e=this.get(n,i),t[0]=n,t[1]=i);return t}min(){for(var e=this.get(0,0),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.get(t,i)<e&&(e=this.get(t,i));return e}minIndex(){for(var e=this.get(0,0),t=[0,0],n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.get(n,i)<e&&(e=this.get(n,i),t[0]=n,t[1]=i);return t}maxRow(e){a.checkRowIndex(this,e);for(var t=this.get(e,0),n=1;n<this.columns;n++)this.get(e,n)>t&&(t=this.get(e,n));return t}maxRowIndex(e){a.checkRowIndex(this,e);for(var t=this.get(e,0),n=[e,0],o=1;o<this.columns;o++)this.get(e,o)>t&&(t=this.get(e,o),n[1]=o);return n}minRow(e){a.checkRowIndex(this,e);for(var t=this.get(e,0),n=1;n<this.columns;n++)this.get(e,n)<t&&(t=this.get(e,n));return t}minRowIndex(e){a.checkRowIndex(this,e);for(var t=this.get(e,0),n=[e,0],o=1;o<this.columns;o++)this.get(e,o)<t&&(t=this.get(e,o),n[1]=o);return n}maxColumn(e){a.checkColumnIndex(this,e);for(var t=this.get(0,e),n=1;n<this.rows;n++)this.get(n,e)>t&&(t=this.get(n,e));return t}maxColumnIndex(e){a.checkColumnIndex(this,e);for(var t=this.get(0,e),n=[0,e],o=1;o<this.rows;o++)this.get(o,e)>t&&(t=this.get(o,e),n[0]=o);return n}minColumn(e){a.checkColumnIndex(this,e);for(var t=this.get(0,e),n=1;n<this.rows;n++)this.get(n,e)<t&&(t=this.get(n,e));return t}minColumnIndex(e){a.checkColumnIndex(this,e);for(var t=this.get(0,e),n=[0,e],o=1;o<this.rows;o++)this.get(o,e)<t&&(t=this.get(o,e),n[0]=o);return n}diag(){for(var e=_(this.rows,this.columns),t=Array(e),n=0;n<e;n++)t[n]=this.get(n,n);return t}sum(e){return"row"===e?a.sumByRow(this):"column"===e?a.sumByColumn(this):a.sumAll(this)}mean(){return this.sum()/this.size}prod(){for(var e=1,t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e*=this.get(t,i);return e}cumulativeSum(){for(var e=0,t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e+=this.get(t,i),this.set(t,i,e);return this}dot(e){x.isMatrix(e)&&(e=e.to1DArray());var t=this.to1DArray();if(t.length!==e.length)throw new RangeError("vectors do not have the same size");for(var n=0,o=0;o<t.length;o++)n+=t[o]*e[o];return n}mmul(e){e=this.constructor.checkMatrix(e),this.columns!==e.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");for(var t=this.rows,o=this.columns,n=e.columns,r=new this.constructor[Symbol.species](t,n),l=Array(o),a=0;a<n;a++){for(var p=0;p<o;p++)l[p]=e.get(p,a);for(var d=0,i;d<t;d++){for(i=0,p=0;p<o;p++)i+=this.get(d,p)*l[p];r.set(d,a,i)}}return r}strassen2x2(e){var t=new this.constructor[Symbol.species](2,2),i=this.get(0,0),n=e.get(0,0),o=this.get(0,1),s=e.get(0,1),r=this.get(1,0),l=e.get(1,0),a=this.get(1,1),p=e.get(1,1),d=(i+a)*(n+p),c=(r+a)*n,u=i*(s-p),h=a*(l-n),m=(i+o)*p;return t.set(0,0,d+h-m+(o-a)*(l+p)),t.set(0,1,u+m),t.set(1,0,c+h),t.set(1,1,d-c+u+(r-i)*(n+s)),t}strassen3x3(e){var t=new this.constructor[Symbol.species](3,3),i=this.get(0,0),n=this.get(0,1),o=this.get(0,2),s=this.get(1,0),r=this.get(1,1),l=this.get(1,2),a=this.get(2,0),p=this.get(2,1),d=this.get(2,2),c=e.get(0,0),u=e.get(0,1),h=e.get(0,2),m=e.get(1,0),g=e.get(1,1),f=e.get(1,2),y=e.get(2,0),x=e.get(2,1),b=e.get(2,2),_=(i-s)*(-u+g),k=(-i+s+r)*(c-u+g),j=(s+r)*(-c+u),w=i*c,C=(-i+a+p)*(c-h+f),v=(-i+a)*(h-f),S=(a+p)*(-c+h),D=(-o+p+d)*(g+y-x),E=(o-d)*(g-x),I=o*y,H=(p+d)*(-y+x),A=(-o+r+l)*(f+y-b),z=(o-l)*(f-b),F=(r+l)*(-y+b);return t.set(0,0,w+I+n*m),t.set(0,1,(i+n+o-s-r-p-d)*g+k+j+w+D+I+H),t.set(0,2,w+C+S+(i+n+o-r-l-a-p)*f+I+A+F),t.set(1,0,_+r*(-c+u+m-g-f-y+b)+k+w+I+A+z),t.set(1,1,_+k+j+w+l*x),t.set(1,2,I+A+z+F+s*h),t.set(2,0,w+C+v+p*(-c+h+m-g-f-y+x)+D+E+I),t.set(2,1,D+E+I+H+a*u),t.set(2,2,w+C+v+S+d*b),t}mmulStrassen(e){function t(e,t,i){var n=e.rows,o=e.columns;if(n===t&&o===i)return e;var s=x.zeros(t,i);return s=s.setSubMatrix(e,0,0),s}function i(e,n,o,s){if(512>=o||512>=s)return e.mmul(n);1==o%2&&1==s%2?(e=t(e,o+1,s+1),n=t(n,o+1,s+1)):1==o%2?(e=t(e,o+1,s),n=t(n,o+1,s)):1==s%2&&(e=t(e,o,s+1),n=t(n,o,s+1));var r=parseInt(e.rows/2),l=parseInt(e.columns/2),a=e.subMatrix(0,r-1,0,l-1),p=n.subMatrix(0,r-1,0,l-1),d=e.subMatrix(0,r-1,l,e.columns-1),c=n.subMatrix(0,r-1,l,n.columns-1),u=e.subMatrix(r,e.rows-1,0,l-1),h=n.subMatrix(r,n.rows-1,0,l-1),m=e.subMatrix(r,e.rows-1,l,e.columns-1),g=n.subMatrix(r,n.rows-1,l,n.columns-1),f=i(x.add(a,m),x.add(p,g),r,l),y=i(x.add(u,m),p,r,l),b=i(a,x.sub(c,g),r,l),_=i(m,x.sub(h,p),r,l),k=i(x.add(a,d),g,r,l),j=i(x.sub(u,a),x.add(p,c),r,l),w=i(x.sub(d,m),x.add(h,g),r,l),C=x.add(f,_);C.sub(k),C.add(w);var v=x.add(b,k),S=x.add(y,_),D=x.sub(f,y);D.add(b),D.add(j);var E=x.zeros(2*C.rows,2*C.columns);return E=E.setSubMatrix(C,0,0),E=E.setSubMatrix(v,C.rows,0),E=E.setSubMatrix(S,0,C.columns),E=E.setSubMatrix(D,C.rows,C.columns),E.subMatrix(0,o-1,0,s-1)}var n=this.clone(),s=n.rows,l=n.columns,a=e.rows,p=e.columns;l!==a&&console.warn(`Multiplying ${s} x ${l} and ${a} x ${p} matrix: dimensions do not match.`);var d=o(s,a),r=o(l,p);return n=t(n,d,r),e=t(e,d,r),i(n,e,d,r)}scaleRows(e,t){if(e=void 0===e?0:e,t=void 0===t?1:t,e>=t)throw new RangeError("min should be strictly smaller than max");for(var n=this.constructor.empty(this.rows,this.columns),o=0,i;o<this.rows;o++)i=l.scale(this.getRow(o),{min:e,max:t}),n.setRow(o,i);return n}scaleColumns(e,t){if(e=void 0===e?0:e,t=void 0===t?1:t,e>=t)throw new RangeError("min should be strictly smaller than max");for(var n=this.constructor.empty(this.rows,this.columns),o=0,i;o<this.columns;o++)i=l.scale(this.getColumn(o),{min:e,max:t}),n.setColumn(o,i);return n}kroneckerProduct(e){e=this.constructor.checkMatrix(e);for(var t=this.rows,o=this.columns,n=e.rows,s=e.columns,r=new this.constructor[Symbol.species](t*n,o*s),a=0;a<t;a++)for(var i=0;i<o;i++)for(var p=0;p<n;p++)for(var d=0;d<s;d++)r[n*a+p][s*i+d]=this.get(a,i)*e.get(p,d);return r}transpose(){for(var e=new this.constructor[Symbol.species](this.columns,this.rows),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e.set(i,t,this.get(t,i));return e}sortRows(e){e===void 0&&(e=n);for(var t=0;t<this.rows;t++)this.setRow(t,this.getRow(t).sort(e));return this}sortColumns(e){e===void 0&&(e=n);for(var t=0;t<this.columns;t++)this.setColumn(t,this.getColumn(t).sort(e));return this}subMatrix(e,t,n,o){a.checkRange(this,e,t,n,o);for(var s=new this.constructor[Symbol.species](t-e+1,o-n+1),r=e;r<=t;r++)for(var i=n;i<=o;i++)s[r-e][i-n]=this.get(r,i);return s}subMatrixRow(e,t,n){if(void 0===t&&(t=0),void 0===n&&(n=this.columns-1),t>n||0>t||t>=this.columns||0>n||n>=this.columns)throw new RangeError("Argument out of range");for(var o=new this.constructor[Symbol.species](e.length,n-t+1),s=0;s<e.length;s++)for(var i=t;i<=n;i++){if(0>e[s]||e[s]>=this.rows)throw new RangeError("Row index out of range: "+e[s]);o.set(s,i-t,this.get(e[s],i))}return o}subMatrixColumn(e,t,n){if(void 0===t&&(t=0),void 0===n&&(n=this.rows-1),t>n||0>t||t>=this.rows||0>n||n>=this.rows)throw new RangeError("Argument out of range");for(var o=new this.constructor[Symbol.species](n-t+1,e.length),s=0;s<e.length;s++)for(var i=t;i<=n;i++){if(0>e[s]||e[s]>=this.columns)throw new RangeError("Column index out of range: "+e[s]);o.set(i-t,s,this.get(i,e[s]))}return o}setSubMatrix(e,t,n){e=this.constructor.checkMatrix(e);var o=t+e.rows-1,s=n+e.columns-1;a.checkRange(this,t,o,n,s);for(var r=0;r<e.rows;r++)for(var i=0;i<e.columns;i++)this[t+r][n+i]=e.get(r,i);return this}selection(e,t){for(var n=a.checkIndices(this,e,t),o=new this.constructor[Symbol.species](e.length,t.length),s=0,i;s<n.row.length;s++){i=n.row[s];for(var r=0,l;r<n.column.length;r++)l=n.column[r],o[s][r]=this.get(i,l)}return o}trace(){for(var e=_(this.rows,this.columns),t=0,n=0;n<e;n++)t+=this.get(n,n);return t}transposeView(){return new d(this)}rowView(e){return a.checkRowIndex(this,e),new c(this,e)}columnView(e){return a.checkColumnIndex(this,e),new m(this,e)}flipRowView(){return new g(this)}flipColumnView(){return new f(this)}subMatrixView(e,t,i,n){return new u(this,e,t,i,n)}selectionView(e,t){return new h(this,e,t)}det(){if(this.isSquare()){var e,t,i,n;if(2===this.columns)return e=this.get(0,0),t=this.get(0,1),i=this.get(1,0),n=this.get(1,1),e*n-t*i;if(3===this.columns){var o,r,l;return o=this.selectionView([1,2],[1,2]),r=this.selectionView([1,2],[0,2]),l=this.selectionView([1,2],[0,1]),e=this.get(0,0),t=this.get(0,1),i=this.get(0,2),e*o.det()-t*r.det()+i*l.det()}return new s(this).determinant}throw Error("Determinant can only be calculated for a square matrix.")}pseudoInverse(e){void 0===e&&(e=Number.EPSILON);for(var t=new r(this,{autoTranspose:!0}),n=t.leftSingularVectors,o=t.rightSingularVectors,l=t.diagonal,s=0;s<l.length;s++)l[s]=C(l[s])>e?1/l[s]:0;return l=this.constructor[Symbol.species].diag(l),o.mmul(l.mmul(n.transposeView()))}}x.prototype.klass="Matrix",x.random=x.rand,x.diagonal=x.diag,x.prototype.diagonal=x.prototype.diag,x.identity=x.eye,x.prototype.negate=x.prototype.neg,x.prototype.tensorProduct=x.prototype.kroneckerProduct,x.prototype.determinant=x.prototype.det;var b=`
(function %name%(value) {
    if (typeof value === 'number') return this.%name%S(value);
    return this.%name%M(value);
})
`,k=`
(function %name%S(value) {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, this.get(i, j) %op% value);
        }
    }
    return this;
})
`,j=`
(function %name%M(matrix) {
    matrix = this.constructor.checkMatrix(matrix);
    checkDimensions(this, matrix);
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, this.get(i, j) %op% matrix.get(i, j));
        }
    }
    return this;
})
`,w=`
(function %name%(matrix, value) {
    var newMatrix = new this[Symbol.species](matrix);
    return newMatrix.%name%(value);
})
`,v=`
(function %name%() {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j)));
        }
    }
    return this;
})
`,S=`
(function %name%(matrix) {
    var newMatrix = new this[Symbol.species](matrix);
    return newMatrix.%name%();
})
`,D=`
(function %name%(%args%) {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j), %args%));
        }
    }
    return this;
})
`,E=`
(function %name%(matrix, %args%) {
    var newMatrix = new this[Symbol.species](matrix);
    return newMatrix.%name%(%args%);
})
`,I=`
(function %name%S(value) {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j), value));
        }
    }
    return this;
})
`,H=`
(function %name%M(matrix) {
    matrix = this.constructor.checkMatrix(matrix);
    checkDimensions(this, matrix);
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j), matrix.get(i, j)));
        }
    }
    return this;
})
`,A=`
(function %name%(value) {
    if (typeof value === 'number') return this.%name%S(value);
    return this.%name%M(value);
})
`,z=E,F=[["+","add"],["-","sub","subtract"],["*","mul","multiply"],["/","div","divide"],["%","mod","modulus"],["&","and"],["|","or"],["^","xor"],["<<","leftShift"],[">>","signPropagatingRightShift"],[">>>","rightShift","zeroFillRightShift"]],R=!0,P=!1,T,i;try{for(var O=F[Symbol.iterator](),M;!(R=(M=O.next()).done);R=!0){var N=M.value,X=eval(y(b,{name:N[1],op:N[0]})),L=eval(y(k,{name:N[1]+"S",op:N[0]})),Y=eval(y(j,{name:N[1]+"M",op:N[0]})),U=eval(y(w,{name:N[1]}));for(T=1;T<N.length;T++)x.prototype[N[T]]=X,x.prototype[N[T]+"S"]=L,x.prototype[N[T]+"M"]=Y,x[N[T]]=U}}catch(e){P=!0,i=e}finally{try{!R&&O.return&&O.return()}finally{if(P)throw i}}var B=[["~","not"]];["abs","acos","acosh","asin","asinh","atan","atanh","cbrt","ceil","clz32","cos","cosh","exp","expm1","floor","fround","log","log1p","log10","log2","round","sign","sin","sinh","sqrt","tan","tanh","trunc"].forEach(function(e){B.push(["Math."+e,e])});var V=!0,q=!1,$;try{for(var Z=B[Symbol.iterator](),W;!(V=(W=Z.next()).done);V=!0){var J=W.value,Q=eval(y(v,{name:J[1],method:J[0]})),G=eval(y(S,{name:J[1]}));for(T=1;T<J.length;T++)x.prototype[J[T]]=Q,x[J[T]]=G}}catch(e){q=!0,$=e}finally{try{!V&&Z.return&&Z.return()}finally{if(q)throw $}}var K=[["Math.pow",1,"pow"]],ee=!0,te=!1,ie;try{for(var ne=K[Symbol.iterator](),oe;!(ee=(oe=ne.next()).done);ee=!0){var se=oe.value,re="arg0";for(T=1;T<se[1];T++)re+=`, arg${T}`;if(1!==se[1]){var le=eval(y(D,{name:se[2],method:se[0],args:re})),ae=eval(y(E,{name:se[2],args:re}));for(T=2;T<se.length;T++)x.prototype[se[T]]=le,x[se[T]]=ae}else{var pe={name:se[2],args:re,method:se[0]},de=eval(y(A,pe)),ce=eval(y(I,pe)),ue=eval(y(H,pe)),he=eval(y(z,pe));for(T=2;T<se.length;T++)x.prototype[se[T]]=de,x.prototype[se[T]+"M"]=ue,x.prototype[se[T]+"S"]=ce,x[se[T]]=he}}}catch(e){te=!0,ie=e}finally{try{!ee&&ne.return&&ne.return()}finally{if(te)throw ie}}return x}t.exports=n;var s=e("./dc/lu"),r=e("./dc/svd"),l=e("ml-array-utils"),a=e("./util"),d=e("./views/transpose"),c=e("./views/row"),u=e("./views/sub"),h=e("./views/selection"),m=e("./views/column"),g=e("./views/flipRow"),f=e("./views/flipColumn")},{"./dc/lu":65,"./dc/svd":67,"./util":73,"./views/column":75,"./views/flipColumn":76,"./views/flipRow":77,"./views/row":78,"./views/selection":79,"./views/sub":80,"./views/transpose":81,"ml-array-utils":38}],63:[function(e,t){"use strict";function n(e){if(!(this instanceof n))return new n(e);if(e=r.checkMatrix(e),!e.isSymmetric())throw new Error("Matrix is not symmetric");var t=e,a=t.rows,p=new r(a,a),l=!0,c,i,h;for(i=0;i<a;i++){var m=p[i],g=0;for(h=0;h<i;h++){var d=p[h],f=0;for(c=0;c<h;c++)f+=d[c]*m[c];m[h]=f=(t[i][h]-f)/p[h][h],g+=f*f}for(g=t[i][i]-g,l&=0<g,p[i][i]=u(o(g,0)),h=i+1;h<a;h++)p[i][h]=0}if(!l)throw new Error("Matrix is not positive definite");this.L=p}var r=e("../matrix").Matrix;n.prototype={get lowerTriangularMatrix(){return this.L},solve:function(e){e=r.checkMatrix(e);var t=this.L,n=t.rows;if(e.rows!==n)throw new Error("Matrix dimensions do not match");var o=e.columns,s=e.clone(),l,i,a;for(a=0;a<n;a++)for(i=0;i<o;i++){for(l=0;l<a;l++)s[a][i]-=s[l][i]*t[a][l];s[a][i]/=t[a][a]}for(a=n-1;0<=a;a--)for(i=0;i<o;i++){for(l=a+1;l<n;l++)s[a][i]-=s[l][i]*t[l][a];s[a][i]/=t[a][a]}return s}},t.exports=n},{"../matrix":71}],64:[function(e,t){"use strict";function s(t,o){if(o=Object.assign({},f,o),!(this instanceof s))return new s(t,o);if(t=h.checkMatrix(t),!t.isSquare())throw new Error("Matrix is not a square matrix");var c=t.columns,n=g(c,c,0),u=Array(c),d=Array(c),e=t,m=!1,y,i;if(m=!!o.assumeSymmetric||t.isSymmetric(),m){for(y=0;y<c;y++)for(i=0;i<c;i++)n[y][i]=e.get(y,i);r(c,d,u,n),l(c,d,u,n)}else{var x=g(c,c,0),b=Array(c);for(i=0;i<c;i++)for(y=0;y<c;y++)x[y][i]=e.get(y,i);a(c,x,b,n),p(c,d,u,n,x)}this.n=c,this.e=d,this.d=u,this.V=n}function r(t,n,e,o){var s,r,l,a,i,p,d,c;for(i=0;i<t;i++)e[i]=o[t-1][i];for(a=t-1;0<a;a--){for(c=0,l=0,p=0;p<a;p++)c+=C(e[p]);if(0===c)for(n[a]=e[a-1],i=0;i<a;i++)e[i]=o[a-1][i],o[a][i]=0,o[i][a]=0;else{for(p=0;p<a;p++)e[p]/=c,l+=e[p]*e[p];for(s=e[a-1],r=u(l),0<s&&(r=-r),n[a]=c*r,l-=s*r,e[a-1]=s-r,i=0;i<a;i++)n[i]=0;for(i=0;i<a;i++){for(s=e[i],o[i][a]=s,r=n[i]+o[i][i]*s,p=i+1;p<=a-1;p++)r+=o[p][i]*e[p],n[p]+=o[p][i]*s;n[i]=r}for(s=0,i=0;i<a;i++)n[i]/=l,s+=n[i]*e[i];for(d=s/(l+l),i=0;i<a;i++)n[i]-=d*e[i];for(i=0;i<a;i++){for(s=e[i],r=n[i],p=i;p<=a-1;p++)o[p][i]-=s*n[p]+r*e[p];e[i]=o[a-1][i],o[a][i]=0}}e[a]=l}for(a=0;a<t-1;a++){if(o[t-1][a]=o[a][a],o[a][a]=1,l=e[a+1],0!==l){for(p=0;p<=a;p++)e[p]=o[p][a+1]/l;for(i=0;i<=a;i++){for(r=0,p=0;p<=a;p++)r+=o[p][a+1]*o[p][i];for(p=0;p<=a;p++)o[p][i]-=r*e[p]}}for(p=0;p<=a;p++)o[p][a+1]=0}for(i=0;i<t;i++)e[i]=o[t-1][i],o[t-1][i]=0;o[t-1][t-1]=1,n[0]=0}function l(t,n,e,a){var d,u,h,i,g,y,l,x,p,b,_,c,k,j,w,v,S;for(h=1;h<t;h++)n[h-1]=n[h];n[t-1]=0;var D=0,f=0,E=2.220446049250313e-16;for(y=0;y<t;y++){for(f=o(f,C(e[y])+C(n[y])),l=y;l<t&&!(C(n[l])<=E*f);)l++;if(l>y){S=0;do{for(++S,d=e[y],x=(e[y+1]-d)/(2*n[y]),p=m(x,1),0>x&&(p=-p),e[y]=n[y]/(x+p),e[y+1]=n[y]*(x+p),b=e[y+1],u=d-e[y],h=y+2;h<t;h++)e[h]-=u;for(D+=u,x=e[l],_=1,c=_,k=_,j=n[y+1],w=0,v=0,h=l-1;h>=y;h--)for(k=c,c=_,v=w,d=_*n[h],u=_*x,p=m(x,n[h]),n[h+1]=w*p,w=n[h]/p,_=x/p,x=_*e[h]-w*d,e[h+1]=u+w*(_*d+w*e[h]),g=0;g<t;g++)u=a[g][h+1],a[g][h+1]=w*a[g][h]+_*u,a[g][h]=_*a[g][h]-w*u;x=-w*v*k*j*n[y]/b,n[y]=w*x,e[y]=_*x}while(C(n[y])>E*f)}e[y]+=D,n[y]=0}for(h=0;h<t-1;h++){for(g=h,x=e[h],i=h+1;i<t;i++)e[i]<x&&(g=i,x=e[i]);if(g!==h)for(e[g]=e[h],e[h]=x,i=0;i<t;i++)x=a[i][h],a[i][h]=a[i][g],a[i][g]=x}}function a(e,t,n,o){var s=0,r=e-1,l,a,p,d,i,c,h;for(c=s+1;c<=r-1;c++){for(h=0,d=c;d<=r;d++)h+=C(t[d][c-1]);if(0!==h){for(p=0,d=r;d>=c;d--)n[d]=t[d][c-1]/h,p+=n[d]*n[d];for(a=u(p),0<n[c]&&(a=-a),p-=n[c]*a,n[c]-=a,i=c;i<e;i++){for(l=0,d=r;d>=c;d--)l+=n[d]*t[d][i];for(l/=p,d=c;d<=r;d++)t[d][i]-=l*n[d]}for(d=0;d<=r;d++){for(l=0,i=r;i>=c;i--)l+=n[i]*t[d][i];for(l/=p,i=c;i<=r;i++)t[d][i]-=l*n[i]}n[c]=h*n[c],t[c][c-1]=h*a}}for(d=0;d<e;d++)for(i=0;i<e;i++)o[d][i]=d===i?1:0;for(c=r-1;c>=s+1;c--)if(0!==t[c][c-1]){for(d=c+1;d<=r;d++)n[d]=t[d][c-1];for(i=c;i<=r;i++){for(a=0,d=c;d<=r;d++)a+=n[d]*o[d][i];for(a=a/n[c]/t[c][c-1],d=c;d<=r;d++)o[d][i]+=a*n[d]}}}function p(a,h,e,d,g){var f=a-1,n=0,b=a-1,v=2.220446049250313e-16,S=0,D=0,E=0,p=0,I=0,H=0,A=0,F=0,R,i,j,k,l,m,t,w,x,y,P,T,O,M,N;for(R=0;R<a;R++)for((R<n||R>b)&&(e[R]=g[R][R],h[R]=0),i=o(R-1,0);i<a;i++)D+=C(g[R][i]);for(;f>=n;){for(k=f;k>n&&(H=C(g[k-1][k-1])+C(g[k][k]),0===H&&(H=D),!(C(g[k][k-1])<v*H));)k--;if(k===f)g[f][f]+=S,e[f]=g[f][f],h[f]=0,f--,F=0;else if(k===f-1){if(t=g[f][f-1]*g[f-1][f],E=(g[f-1][f-1]-g[f][f])/2,p=E*E+t,A=u(C(p)),g[f][f]+=S,g[f-1][f-1]=g[f-1][f-1]+S,w=g[f][f],0<=p){for(A=0<=E?E+A:E-A,e[f-1]=w+A,e[f]=e[f-1],0!==A&&(e[f]=w-t/A),h[f-1]=0,h[f]=0,w=g[f][f-1],H=C(w)+C(A),E=w/H,p=A/H,I=u(E*E+p*p),E/=I,p/=I,i=f-1;i<a;i++)A=g[f-1][i],g[f-1][i]=p*A+E*g[f][i],g[f][i]=p*g[f][i]-E*A;for(R=0;R<=f;R++)A=g[R][f-1],g[R][f-1]=p*A+E*g[R][f],g[R][f]=p*g[R][f]-E*A;for(R=n;R<=b;R++)A=d[R][f-1],d[R][f-1]=p*A+E*d[R][f],d[R][f]=p*d[R][f]-E*A}else e[f-1]=w+E,e[f]=w+E,h[f-1]=A,h[f]=-A;f-=2,F=0}else{if(w=g[f][f],x=0,t=0,k<f&&(x=g[f-1][f-1],t=g[f][f-1]*g[f-1][f]),10==F){for(S+=w,R=n;R<=f;R++)g[R][R]-=w;H=C(g[f][f-1])+C(g[f-1][f-2]),w=x=0.75*H,t=-0.4375*H*H}if(30==F&&(H=(x-w)/2,H=H*H+t,0<H)){for(H=u(H),x<w&&(H=-H),H=w-t/((x-w)/2+H),R=n;R<=f;R++)g[R][R]-=H;S+=H,w=x=t=0.964}for(++F,l=f-2;l>=k&&(A=g[l][l],I=w-A,H=x-A,E=(I*H-t)/g[l+1][l]+g[l][l+1],p=g[l+1][l+1]-A-I-H,I=g[l+2][l+1],H=C(E)+C(p)+C(I),E/=H,p/=H,I/=H,l!==k)&&!(C(g[l][l-1])*(C(p)+C(I))<v*(C(E)*(C(g[l-1][l-1])+C(A)+C(g[l+1][l+1]))));)l--;for(R=l+2;R<=f;R++)g[R][R-2]=0,R>l+2&&(g[R][R-3]=0);for(j=l;j<=f-1&&(M=j!==f-1,j!==l&&(E=g[j][j-1],p=g[j+1][j-1],I=M?g[j+2][j-1]:0,w=C(E)+C(p)+C(I),0!==w&&(E/=w,p/=w,I/=w)),0!==w);j++)if(H=u(E*E+p*p+I*I),0>E&&(H=-H),0!==H){for(j===l?k!==l&&(g[j][j-1]=-g[j][j-1]):g[j][j-1]=-H*w,E+=H,w=E/H,x=p/H,A=I/H,p/=E,I/=E,i=j;i<a;i++)E=g[j][i]+p*g[j+1][i],M&&(E+=I*g[j+2][i],g[j+2][i]=g[j+2][i]-E*A),g[j][i]-=E*w,g[j+1][i]=g[j+1][i]-E*x;for(R=0;R<=_(f,j+3);R++)E=w*g[R][j]+x*g[R][j+1],M&&(E+=A*g[R][j+2],g[R][j+2]=g[R][j+2]-E*I),g[R][j]-=E,g[R][j+1]=g[R][j+1]-E*p;for(R=n;R<=b;R++)E=w*d[R][j]+x*d[R][j+1],M&&(E+=A*d[R][j+2],d[R][j+2]=d[R][j+2]-E*I),d[R][j]-=E,d[R][j+1]=d[R][j+1]-E*p}}}if(0!==D){for(f=a-1;0<=f;f--)if(E=e[f],p=h[f],0===p)for(k=f,g[f][f]=1,R=f-1;0<=R;R--){for(t=g[R][R]-E,I=0,i=k;i<=f;i++)I+=g[R][i]*g[i][f];if(0>h[R])A=t,H=I;else if(k=R,0===h[R]?g[R][f]=0===t?-I/(v*D):-I/t:(w=g[R][R+1],x=g[R+1][R],p=(e[R]-E)*(e[R]-E)+h[R]*h[R],m=(w*H-A*I)/p,g[R][f]=m,g[R+1][f]=C(w)>C(A)?(-I-t*m)/w:(-H-x*m)/A),m=C(g[R][f]),1<v*m*m)for(i=R;i<=f;i++)g[i][f]/=m}else if(0>p)for(k=f-1,C(g[f][f-1])>C(g[f-1][f])?(g[f-1][f-1]=p/g[f][f-1],g[f-1][f]=-(g[f][f]-E)/g[f][f-1]):(N=c(0,-g[f-1][f],g[f-1][f-1]-E,p),g[f-1][f-1]=N[0],g[f-1][f]=N[1]),g[f][f-1]=0,g[f][f]=1,R=f-2;0<=R;R--){for(y=0,P=0,i=k;i<=f;i++)y+=g[R][i]*g[i][f-1],P+=g[R][i]*g[i][f];if(t=g[R][R]-E,0>h[R])A=t,I=y,H=P;else if(k=R,0===h[R]?(N=c(-y,-P,t,p),g[R][f-1]=N[0],g[R][f]=N[1]):(w=g[R][R+1],x=g[R+1][R],T=(e[R]-E)*(e[R]-E)+h[R]*h[R]-p*p,O=2*(e[R]-E)*p,0===T&&0===O&&(T=v*D*(C(t)+C(p)+C(w)+C(x)+C(A))),N=c(w*I-A*y+p*P,w*H-A*P-p*y,T,O),g[R][f-1]=N[0],g[R][f]=N[1],C(w)>C(A)+C(p)?(g[R+1][f-1]=(-y-t*g[R][f-1]+p*g[R][f])/w,g[R+1][f]=(-P-t*g[R][f]-p*g[R][f-1])/w):(N=c(-I-x*g[R][f-1],-H-x*g[R][f],A,p),g[R+1][f-1]=N[0],g[R+1][f]=N[1])),m=o(C(g[R][f-1]),C(g[R][f])),1<v*m*m)for(i=R;i<=f;i++)g[i][f-1]=g[i][f-1]/m,g[i][f]/=m}for(R=0;R<a;R++)if(R<n||R>b)for(i=R;i<a;i++)d[R][i]=g[R][i];for(i=a-1;i>=n;i--)for(R=n;R<=b;R++){for(A=0,j=n;j<=_(i,b);j++)A+=d[R][j]*g[j][i];d[R][i]=A}}}function c(e,t,i,n){var o,s;return C(i)>C(n)?(o=n/i,s=i+o*n,[(e+o*t)/s,(t-o*e)/s]):(o=i/n,s=n+o*i,[(o*e+t)/s,(o*t-e)/s])}var h=e("../matrix").Matrix,i=e("./util"),m=i.hypotenuse,g=i.getFilled2DArray,f={assumeSymmetric:!1};s.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return h.isMatrix(this.V)||(this.V=new h(this.V)),this.V},get diagonalMatrix(){var t=this.n,n=this.e,e=this.d,o=new h(t,t),s,i;for(s=0;s<t;s++){for(i=0;i<t;i++)o[s][i]=0;o[s][s]=e[s],0<n[s]?o[s][s+1]=n[s]:0>n[s]&&(o[s][s-1]=n[s])}return o}},t.exports=s},{"../matrix":71,"./util":68}],65:[function(e,t){"use strict";function n(e){if(!(this instanceof n))return new n(e);e=o.Matrix.checkMatrix(e);var r=e.clone(),l=r.rows,a=r.columns,d=Array(l),c=1,u,i,h,m,p,s,t,g,f,y;for(u=0;u<l;u++)d[u]=u;for(f=Array(l),i=0;i<a;i++){for(u=0;u<l;u++)f[u]=r[u][i];for(u=0;u<l;u++){for(g=r[u],y=_(u,i),p=0,h=0;h<y;h++)p+=g[h]*f[h];g[i]=f[u]-=p}for(m=i,u=i+1;u<l;u++)C(f[u])>C(f[m])&&(m=u);if(m!==i){for(h=0;h<a;h++)s=r[m][h],r[m][h]=r[i][h],r[i][h]=s;t=d[m],d[m]=d[i],d[i]=t,c=-c}if(i<l&&0!==r[i][i])for(u=i+1;u<l;u++)r[u][i]/=r[i][i]}this.LU=r,this.pivotVector=d,this.pivotSign=c}var o=e("../matrix");n.prototype={isSingular:function(){for(var e=this.LU,t=e.columns,i=0;i<t;i++)if(0===e[i][i])return!0;return!1},get determinant(){var e=this.LU;if(!e.isSquare())throw new Error("Matrix must be square");for(var t=this.pivotSign,i=e.columns,n=0;n<i;n++)t*=e[n][n];return t},get lowerTriangularMatrix(){for(var e=this.LU,t=e.rows,n=e.columns,s=new o.Matrix(t,n),r=0;r<t;r++)for(var i=0;i<n;i++)s[r][i]=r>i?e[r][i]:r===i?1:0;return s},get upperTriangularMatrix(){for(var e=this.LU,t=e.rows,n=e.columns,s=new o.Matrix(t,n),r=0;r<t;r++)for(var i=0;i<n;i++)s[r][i]=r<=i?e[r][i]:0;return s},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(e){e=o.Matrix.checkMatrix(e);var t=this.LU,n=t.rows;if(n!==e.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var s=e.columns,r=e.subMatrixRow(this.pivotVector,0,s-1),l=t.columns,a,i,p;for(p=0;p<l;p++)for(a=p+1;a<l;a++)for(i=0;i<s;i++)r[a][i]-=r[p][i]*t[a][p];for(p=l-1;0<=p;p--){for(i=0;i<s;i++)r[p][i]/=t[p][p];for(a=0;a<p;a++)for(i=0;i<s;i++)r[a][i]-=r[p][i]*t[a][p]}return r}},t.exports=n},{"../matrix":71}],66:[function(e,t){"use strict";function o(e){if(!(this instanceof o))return new o(e);e=r.checkMatrix(e);var t=e.clone(),l=e.rows,a=e.columns,p=Array(a),d,i,c,u;for(c=0;c<a;c++){var h=0;for(d=c;d<l;d++)h=n(h,t[d][c]);if(0!==h){for(0>t[c][c]&&(h=-h),d=c;d<l;d++)t[d][c]/=h;for(t[c][c]+=1,i=c+1;i<a;i++){for(u=0,d=c;d<l;d++)u+=t[d][c]*t[d][i];for(u=-u/t[c][c],d=c;d<l;d++)t[d][i]+=u*t[d][c]}}p[c]=-h}this.QR=t,this.Rdiag=p}var r=e("../matrix").Matrix,n=e("./util").hypotenuse;o.prototype={solve:function(e){e=r.checkMatrix(e);var t=this.QR,o=t.rows;if(e.rows!==o)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var l=e.columns,a=e.clone(),p=t.columns,n,i,d,c;for(d=0;d<p;d++)for(i=0;i<l;i++){for(c=0,n=d;n<o;n++)c+=t[n][d]*a[n][i];for(c=-c/t[d][d],n=d;n<o;n++)a[n][i]+=c*t[n][d]}for(d=p-1;0<=d;d--){for(i=0;i<l;i++)a[d][i]/=this.Rdiag[d];for(n=0;n<d;n++)for(i=0;i<l;i++)a[n][i]-=a[d][i]*t[n][d]}return a.subMatrix(0,p-1,0,l-1)},isFullRank:function(){for(var e=this.QR.columns,t=0;t<e;t++)if(0===this.Rdiag[t])return!1;return!0},get upperTriangularMatrix(){var e=this.QR,t=e.columns,n=new r(t,t),o,i;for(o=0;o<t;o++)for(i=0;i<t;i++)n[o][i]=o<i?e[o][i]:o===i?this.Rdiag[o]:0;return n},get orthogonalMatrix(){var e=this.QR,t=e.rows,n=e.columns,o=new r(t,n),l,i,a,p;for(a=n-1;0<=a;a--){for(l=0;l<t;l++)o[l][a]=0;for(o[a][a]=1,i=a;i<n;i++)if(0!==e[a][a]){for(p=0,l=a;l<t;l++)p+=e[l][a]*o[l][i];for(p=-p/e[a][a],l=a;l<t;l++)o[l][i]+=p*e[l][a]}}return o}},t.exports=o},{"../matrix":71,"./util":68}],67:[function(e,t){"use strict";function r(y,x){if(!(this instanceof r))return new r(y,x);y=l.Matrix.checkMatrix(y),x=x||{};var w=y.rows,m=y.columns,n=_(w,m),v=!0,S=!0;!1===x.computeLeftSingularVectors&&(v=!1),!1===x.computeRightSingularVectors&&(S=!1);var D=!0===x.autoTranspose,E=!1,I;if(!(w<m))I=y.clone();else if(!D)I=y.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else{I=y.transpose(),w=I.rows,m=I.columns,E=!0;var a=v;v=S,S=a}var H=Array(_(w+1,m)),s=h(w,n,0),A=h(m,m,0),z=Array(m),e=Array(w),F=_(w-1,m),R=o(0,_(m-2,w)),P,i,j,k,p,T,O,f,M,N,X,L,Y,U,B,V,q,$,b,c,Z;for(j=0,N=o(F,R);j<N;j++){if(j<F){for(H[j]=0,P=j;P<w;P++)H[j]=d(H[j],I[P][j]);if(0!==H[j]){for(0>I[j][j]&&(H[j]=-H[j]),P=j;P<w;P++)I[P][j]/=H[j];I[j][j]+=1}H[j]=-H[j]}for(i=j+1;i<m;i++){if(j<F&&0!==H[j]){for(p=0,P=j;P<w;P++)p+=I[P][j]*I[P][i];for(p=-p/I[j][j],P=j;P<w;P++)I[P][i]+=p*I[P][j]}z[i]=I[j][i]}if(v&&j<F)for(P=j;P<w;P++)s[P][j]=I[P][j];if(j<R){for(z[j]=0,P=j+1;P<m;P++)z[j]=d(z[j],z[P]);if(0!==z[j]){for(0>z[j+1]&&(z[j]=0-z[j]),P=j+1;P<m;P++)z[P]/=z[j];z[j+1]+=1}if(z[j]=-z[j],j+1<w&&0!==z[j]){for(P=j+1;P<w;P++)e[P]=0;for(i=j+1;i<m;i++)for(P=j+1;P<w;P++)e[P]+=z[i]*I[P][i];for(i=j+1;i<m;i++)for(p=-z[i]/z[j+1],P=j+1;P<w;P++)I[P][i]+=p*e[P]}if(S)for(P=j+1;P<m;P++)A[P][j]=z[P]}}if(k=_(m,w+1),F<m&&(H[F]=I[F][F]),w<k&&(H[k-1]=0),R+1<k&&(z[R]=I[R][k-1]),z[k-1]=0,v){for(i=F;i<n;i++){for(P=0;P<w;P++)s[P][i]=0;s[i][i]=1}for(j=F-1;0<=j;j--)if(0!==H[j]){for(i=j+1;i<n;i++){for(p=0,P=j;P<w;P++)p+=s[P][j]*s[P][i];for(p=-p/s[j][j],P=j;P<w;P++)s[P][i]+=p*s[P][j]}for(P=j;P<w;P++)s[P][j]=-s[P][j];for(s[j][j]=1+s[j][j],P=0;P<j-1;P++)s[P][j]=0}else{for(P=0;P<w;P++)s[P][j]=0;s[j][j]=1}}if(S)for(j=m-1;0<=j;j--){if(j<R&&0!==z[j])for(i=j+1;i<m;i++){for(p=0,P=j+1;P<m;P++)p+=A[P][j]*A[P][i];for(p=-p/A[j+1][j],P=j+1;P<m;P++)A[P][i]+=p*A[P][j]}for(P=0;P<m;P++)A[P][j]=0;A[j][j]=1}for(var g=k-1,W=0,J=2.220446049250313e-16;0<k;){for(j=k-2;-1<=j&&-1!==j;j--)if(C(z[j])<=J*(C(H[j])+C(H[j+1]))){z[j]=0;break}if(j===k-2)X=4;else{for(T=k-1;T>=j&&T!==j;T--)if(p=(T===k?0:C(z[T]))+(T===j+1?0:C(z[T-1])),C(H[T])<=J*p){H[T]=0;break}T===j?X=3:T===k-1?X=1:(X=2,j=T)}switch(j++,X){case 1:{for(O=z[k-2],z[k-2]=0,i=k-2;i>=j;i--)if(p=d(H[i],O),f=H[i]/p,M=O/p,H[i]=p,i!==j&&(O=-M*z[i-1],z[i-1]=f*z[i-1]),S)for(P=0;P<m;P++)p=f*A[P][i]+M*A[P][k-1],A[P][k-1]=-M*A[P][i]+f*A[P][k-1],A[P][i]=p;break}case 2:{for(O=z[j-1],z[j-1]=0,i=j;i<k;i++)if(p=d(H[i],O),f=H[i]/p,M=O/p,H[i]=p,O=-M*z[i],z[i]=f*z[i],v)for(P=0;P<w;P++)p=f*s[P][i]+M*s[P][j-1],s[P][j-1]=-M*s[P][i]+f*s[P][j-1],s[P][i]=p;break}case 3:{for(L=o(o(o(o(C(H[k-1]),C(H[k-2])),C(z[k-2])),C(H[j])),C(z[j])),Y=H[k-1]/L,U=H[k-2]/L,B=z[k-2]/L,V=H[j]/L,q=z[j]/L,$=((U+Y)*(U-Y)+B*B)/2,b=Y*B*(Y*B),c=0,(0!==$||0!==b)&&(c=u($*$+b),0>$&&(c=-c),c=b/($+c)),O=(V+Y)*(V-Y)+c,Z=V*q,i=j;i<k-1;i++){if(p=d(O,Z),f=O/p,M=Z/p,i!==j&&(z[i-1]=p),O=f*H[i]+M*z[i],z[i]=f*z[i]-M*H[i],Z=M*H[i+1],H[i+1]=f*H[i+1],S)for(P=0;P<m;P++)p=f*A[P][i]+M*A[P][i+1],A[P][i+1]=-M*A[P][i]+f*A[P][i+1],A[P][i]=p;if(p=d(O,Z),f=O/p,M=Z/p,H[i]=p,O=f*z[i]+M*H[i+1],H[i+1]=-M*z[i]+f*H[i+1],Z=M*z[i+1],z[i+1]=f*z[i+1],v&&i<w-1)for(P=0;P<w;P++)p=f*s[P][i]+M*s[P][i+1],s[P][i+1]=-M*s[P][i]+f*s[P][i+1],s[P][i]=p}z[k-2]=O,++W;break}case 4:{if(0>=H[j]&&(H[j]=0>H[j]?-H[j]:0,S))for(P=0;P<=g;P++)A[P][j]=-A[P][j];for(;j<g&&!(H[j]>=H[j+1]);){if(p=H[j],H[j]=H[j+1],H[j+1]=p,S&&j<m-1)for(P=0;P<m;P++)p=A[P][j+1],A[P][j+1]=A[P][j],A[P][j]=p;if(v&&j<w-1)for(P=0;P<w;P++)p=s[P][j+1],s[P][j+1]=s[P][j],s[P][j]=p;j++}W=0,k--;break}}}if(E){var Q=A;A=s,s=Q}this.m=w,this.n=m,this.s=H,this.U=s,this.V=A}var l=e("../matrix"),i=e("./util"),d=i.hypotenuse,h=i.getFilled2DArray;r.prototype={get condition(){return this.s[0]/this.s[_(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){for(var e=o(this.m,this.n)*this.s[0]*2.220446049250313e-16,t=0,n=this.s,s=0,i=n.length;s<i;s++)n[s]>e&&t++;return t},get diagonal(){return this.s},get threshold(){return 2.220446049250313e-16/2*o(this.m,this.n)*this.s[0]},get leftSingularVectors(){return l.Matrix.isMatrix(this.U)||(this.U=new l.Matrix(this.U)),this.U},get rightSingularVectors(){return l.Matrix.isMatrix(this.V)||(this.V=new l.Matrix(this.V)),this.V},get diagonalMatrix(){return l.Matrix.diag(this.s)},solve:function(t){var n=this.threshold,e=this.s.length,o=l.Matrix.zeros(e,e),s;for(s=0;s<e;s++)o[s][s]=C(this.s[s])<=n?0:1/this.s[s];var i=this.U,r=this.rightSingularVectors,a=r.mmul(o),p=r.rows,d=i.length,c=l.Matrix.zeros(p,d),u,h,m;for(s=0;s<p;s++)for(u=0;u<d;u++){for(m=0,h=0;h<e;h++)m+=a[s][h]*i[u][h];c[s][u]=m}return c.mmul(t)},solveForDiagonal:function(e){return this.solve(l.Matrix.diag(e))},inverse:function(){var t=this.V,n=this.threshold,e=t.length,o=t[0].length,s=new l.Matrix(e,this.s.length),r,i;for(r=0;r<e;r++)for(i=0;i<o;i++)s[r][i]=C(this.s[i])>n?t[r][i]/this.s[i]:0;var a=this.U,p=a.length,d=a[0].length,c=new l.Matrix(e,p),u,h;for(r=0;r<e;r++)for(i=0;i<p;i++){for(h=0,u=0;u<d;u++)h+=s[r][u]*a[i][u];c[r][i]=h}return c}},t.exports=r},{"../matrix":71,"./util":68}],68:[function(e,t,i){"use strict";i.hypotenuse=function(e,t){var i;return C(e)>C(t)?(i=t/e,C(e)*u(1+i*i)):0===t?0:(i=e/t,C(t)*u(1+i*i))},i.getEmpty2DArray=function(e,t){for(var n=Array(e),o=0;o<e;o++)n[o]=Array(t);return n},i.getFilled2DArray=function(e,t,n){for(var o=Array(e),s=0;s<e;s++){o[s]=Array(t);for(var i=0;i<t;i++)o[s][i]=n}return o}},{}],69:[function(e,t){"use strict";function i(e){return e=o.checkMatrix(e),n(e,o.eye(e.rows))}function n(e,t){return e=o.checkMatrix(e),t=o.checkMatrix(t),e.isSquare()?new l(e).solve(t):new a(e).solve(t)}var o=e("./matrix").Matrix,s=e("./dc/svd"),r=e("./dc/evd"),l=e("./dc/lu"),a=e("./dc/qr"),p=e("./dc/cholesky");o.inverse=o.inv=i,o.prototype.inverse=o.prototype.inv=function(){return i(this)},o.solve=n,o.prototype.solve=function(e){return n(this,e)},t.exports={SingularValueDecomposition:s,SVD:s,EigenvalueDecomposition:r,EVD:r,LuDecomposition:l,LU:l,QrDecomposition:a,QR:a,CholeskyDecomposition:p,CHO:p,inverse:i,solve:n}},{"./dc/cholesky":63,"./dc/evd":64,"./dc/lu":65,"./dc/qr":66,"./dc/svd":67,"./matrix":71}],70:[function(e,t){"use strict";t.exports=e("./matrix").Matrix,t.exports.Decompositions=t.exports.DC=e("./decompositions")},{"./decompositions":69,"./matrix":71}],71:[function(e,t,i){"use strict";e("./symbol-species");var o=e("./abstractMatrix"),s=e("./util");class r extends o(Array){constructor(e,t){var o;if(1===arguments.length&&"number"==typeof e)return Array(e);if(r.isMatrix(e))return e.clone();if(n(e)&&0<e){if(super(e),n(t)&&0<t)for(o=0;o<e;o++)this[o]=Array(t);else throw new TypeError("nColumns must be a positive integer");}else if(Array.isArray(e)){var i=e;if(e=i.length,t=i[0].length,"number"!=typeof t||0===t)throw new TypeError("Data must be a 2D array with at least one element");for(super(e),o=0;o<e;o++){if(i[o].length!==t)throw new RangeError("Inconsistent array dimensions");this[o]=[].concat(i[o])}}else throw new TypeError("First argument must be a positive number or an array");return this.rows=e,this.columns=t,this}set(e,t,i){return this[e][t]=i,this}get(e,t){return this[e][t]}clone(){for(var e=new this.constructor[Symbol.species](this.rows,this.columns),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e.set(t,i,this.get(t,i));return e}removeRow(e){if(s.checkRowIndex(this,e),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return this.splice(e,1),this.rows-=1,this}addRow(e,t){return void 0===t&&(t=e,e=this.rows),s.checkRowIndex(this,e,!0),t=s.checkRowVector(this,t,!0),this.splice(e,0,t),this.rows+=1,this}removeColumn(e){if(s.checkColumnIndex(this,e),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(var t=0;t<this.rows;t++)this[t].splice(e,1);return this.columns-=1,this}addColumn(e,t){"undefined"==typeof t&&(t=e,e=this.columns),s.checkColumnIndex(this,e,!0),t=s.checkColumnVector(this,t);for(var n=0;n<this.rows;n++)this[n].splice(e,0,t[n]);return this.columns+=1,this}}i.Matrix=r,r.abstractMatrix=o},{"./abstractMatrix":62,"./symbol-species":72,"./util":73}],72:[function(){"use strict";Symbol.species||(Symbol.species=Symbol.for("@@species"))},{}],73:[function(e,t,i){"use strict";var n=e("./matrix");i.checkRowIndex=function(e,t,i){var n=i?e.rows:e.rows-1;if(0>t||t>n)throw new RangeError("Row index out of range")},i.checkColumnIndex=function(e,t,i){var n=i?e.columns:e.columns-1;if(0>t||t>n)throw new RangeError("Column index out of range")},i.checkRowVector=function(e,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==e.columns)throw new RangeError("vector size must be the same as the number of columns");return t},i.checkColumnVector=function(e,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==e.rows)throw new RangeError("vector size must be the same as the number of rows");return t},i.checkIndices=function(e,t,i){var n=t.some((t)=>{return 0>t||t>=e.rows}),o=i.some((t)=>{return 0>t||t>=e.columns});if(n||o)throw new RangeError("Indices are out of range");if("object"!=typeof t||"object"!=typeof i)throw new TypeError("Unexpected type for row/column indices");return Array.isArray(t)||(t=Array.from(t)),Array.isArray(i)||(t=Array.from(i)),{row:t,column:i}},i.checkRange=function(e,t,i,n,o){if(5!==arguments.length)throw new TypeError("Invalid argument type");var s=Array.from(arguments).slice(1).some(function(e){return"number"!=typeof e});if(s)throw new TypeError("Invalid argument type");if(t>i||n>o||0>t||t>=e.rows||0>i||i>=e.rows||0>n||n>=e.columns||0>o||o>=e.columns)throw new RangeError("Submatrix indices are out of range")},i.getRange=function(e,t){for(var n=Array(t-e+1),o=0;o<n.length;o++)n[o]=e+o;return n},i.sumByRow=function(e){for(var t=n.Matrix.zeros(e.rows,1),o=0;o<e.rows;++o)for(var i=0;i<e.columns;++i)t.set(o,0,t.get(o,0)+e.get(o,i));return t},i.sumByColumn=function(e){for(var t=n.Matrix.zeros(1,e.columns),o=0;o<e.rows;++o)for(var i=0;i<e.columns;++i)t.set(0,i,t.get(0,i)+e.get(o,i));return t},i.sumAll=function(e){for(var t=0,n=0;n<e.rows;n++)for(var i=0;i<e.columns;i++)t+=e.get(n,i);return t}},{"./matrix":71}],74:[function(e,t){"use strict";var i=e("../abstractMatrix"),n=e("../matrix");class o extends i(){constructor(e,t,i){super(),this.matrix=e,this.rows=t,this.columns=i}static get[Symbol.species](){return n.Matrix}}t.exports=o},{"../abstractMatrix":62,"../matrix":71}],75:[function(e,t){"use strict";var i=e("./base");t.exports=class extends i{constructor(e,t){super(e,e.rows,1),this.column=t}set(e,t,i){return this.matrix.set(e,this.column,i),this}get(e){return this.matrix.get(e,this.column)}}},{"./base":74}],76:[function(e,t){"use strict";var i=e("./base");t.exports=class extends i{constructor(e){super(e,e.rows,e.columns)}set(e,t,i){return this.matrix.set(e,this.columns-t-1,i),this}get(e,t){return this.matrix.get(e,this.columns-t-1)}}},{"./base":74}],77:[function(e,t){"use strict";var i=e("./base");t.exports=class extends i{constructor(e){super(e,e.rows,e.columns)}set(e,t,i){return this.matrix.set(this.rows-e-1,t,i),this}get(e,t){return this.matrix.get(this.rows-e-1,t)}}},{"./base":74}],78:[function(e,t){"use strict";var i=e("./base");t.exports=class extends i{constructor(e,t){super(e,1,e.columns),this.row=t}set(e,t,i){return this.matrix.set(this.row,t,i),this}get(e,t){return this.matrix.get(this.row,t)}}},{"./base":74}],79:[function(e,t){"use strict";var i=e("./base"),n=e("../util");t.exports=class extends i{constructor(e,t,i){var o=n.checkIndices(e,t,i);super(e,o.row.length,o.column.length),this.rowIndices=o.row,this.columnIndices=o.column}set(e,t,i){return this.matrix.set(this.rowIndices[e],this.columnIndices[t],i),this}get(e,t){return this.matrix.get(this.rowIndices[e],this.columnIndices[t])}}},{"../util":73,"./base":74}],80:[function(e,t){"use strict";var i=e("./base"),n=e("../util");t.exports=class extends i{constructor(e,t,i,o,s){n.checkRange(e,t,i,o,s),super(e,i-t+1,s-o+1),this.startRow=t,this.startColumn=o}set(e,t,i){return this.matrix.set(this.startRow+e,this.startColumn+t,i),this}get(e,t){return this.matrix.get(this.startRow+e,this.startColumn+t)}}},{"../util":73,"./base":74}],81:[function(e,t){"use strict";var i=e("./base");t.exports=class extends i{constructor(e){super(e,e.columns,e.rows)}set(e,t,i){return this.matrix.set(t,e,i),this}get(e,t){return this.matrix.get(t,e)}}},{"./base":74}],82:[function(e,t){"use strict";var s=e("ml-matrix"),r=e("./algebra");t.exports={optimize:function(e,n,l,t,a,d,m,g,f,c){var y=0;if("object"!=typeof n[0])for(var x=0;x<n.length;x++)n[x]=[n[x]];var i=-50,b=n.length,w=t.length,j=s.zeros(b,1),v=s.zeros(w,1),S=0.01/i,D=0.01/i,E=s.zeros(w,b),x,I;if(l.length!=t.length){console.log("lm.m error: the length of t must equal the length of y_dat"),length_t=l.length,length_y_dat=t.length;var S=0;return}a=a||u((w-b+1)/r.multiply(r.transpose(t),t)),d=d||1e-3,m=m||r.multiply(C(n),-100),g=g||r.multiply(C(n),100),f=f||1,c=c||[3,10*b,1e-3,1e-3,1e-3,0.01,0.01,11,9,1];var k=c[0],H=c[1],A=c[2],z=c[3],F=c[4],R=c[5],P=c[6],T=c[7],O=c[8],M=c[9];if(0,!d.length||1==d.length){for(var N=Array(b),x=0;x<b;x++)N[x]=[d];d=N}var X=[];for(x=0;x<d.length;x++)0!=d[x][0]&&X.push(x);var L=X.length,Y=!1,U=null;if(!a.length||a.length<w){var B=r.multiply(s.ones(w,1),a[0]);U=r.dotMultiply(B,B)}else U=r.dotMultiply(a,a);var V=this.lm_matx(e,l,j,v,1,E,n,t,U,d,f),q=V.JtWJ,$=V.JtWdy,S=V.Chi_sq,Z=V.y_hat,E=V.J;o(C($))<A&&(console.log(" *** Your Initial Guess is Extremely Close to Optimal ***"),console.log(" *** epsilon_1 = ",A),Y=!0),1===M?lambda=P:(lambda=P*o(r.diag(q)),nu=2),D=S;for(var W=null;!Y&&y<=H;){++y,W=1===M?r.solve(r.add(q,r.multiply(r.diag(r.diag(q)),lambda)),$):r.solve(r.add(q,r.multiply(s.eye(b),lambda)),$);var h=Array(X.length);for(I=0;I<X.length;I++)h[I]=W[X[I]];var J=r.add(n,h);for(I=0;I<J.length;I++)J[I][0]=_(o(m[I][0],J[I][0]),g[I][0]);var Q=r.subtract(t,e(l,J,f)),G=r.multiply(r.transpose(Q),r.dotMultiply(Q,U));if(2==M){var K=r.multiply(r.transpose($),W),ee=r.multiply(K,r.inv(r.add(r.multiply(r.subtract(G-S),1/2)),r.multiply(K,2)));W=r.multiply(ee,W);for(var I=0;I<X.length;I++)h[I]=W[X[I]];J=r.add(n,h),J=r.min(r.max(m,J),g),Q=r.subtract(t,e(l,J,f)),G=r.multiply(r.transpose(Q),mat.dotMultiply(Q,U))}var te=(S-G)/r.multiply(r.multiply(r.transpose(W),2),r.add(r.multiply(lambda,W),$));te>R?(dX2=S-D,D=S,j=n,v=Z,n=J,V=this.lm_matx(e,l,j,v,dX2,E,n,t,U,d,f),q=V.JtWJ,$=V.JtWdy,S=V.Chi_sq,Z=V.y_hat,E=V.J,1===M?lambda=o(lambda/O,1e-7):2===M?lambda=o(lambda/(1+ee),1e-7):3===M?(lambda=r.multiply(o(1/3,3^1-(2*te-1)),lambda),nu=2):void 0):(S=D,0==y%(2*b)&&(V=this.lm_matx(e,l,j,v,-1,E,n,t,U,d,f),q=V.JtWJ,$=V.JtWdy,dX2=V.Chi_sq,Z=V.y_hat,E=V.J),1===M?lambda=_(lambda*T,1e7):2===M?lambda+=C((G-S)/2/ee):3===M?(lambda*=nu,nu=2*nu):void 0)}return U=r.multiply(r.multiply(r.transpose(Q),Q),s.ones(w,1)),U.apply(function(e,t){U[e][t]=(w-L+1)/U[e][t]}),V=this.lm_matx(e,l,j,v,-1,E,n,t,U,d,f),q=V.JtWJ,$=V.JtWdy,S=V.Chi_sq,Z=V.y_hat,E=V.J,{p:n,X2:S}},lm_FD_J:function(e,i,t,o,l,a){var p=o.length,d=t.length;l=l||r.multiply(s.ones(d,1),1e-3);for(var n=t.clone(),c=new s(p,d),u=Array(d),h=0;h<d;h++){if(u[h]=l[h]*(1+C(t[h][0])),t[h]=[n[h][0]+u[h]],0!=u[h])if(y1=e(i,t,a),0>l[h][0])for(var m=r.dotDivide(r.subtract(y1,o),u[h]),g=0;g<p;g++)c[g][h]=m[g][0];else{t[h][0]=n[h][0]-u[h];for(var m=r.dotDivide(r.subtract(y1,e(i,t,a)),2*u[h]),g=0;g<p;g++)c[g][h]=m[g][0]}t[h]=n[h]}return c},lm_Broyden_J:function(e,t,i,n,o){var s=r.subtract(n,e),l=r.transpose(s);return l.div(r.multiply(l,s)),i=r.add(i,r.multiply(r.subtract(o,r.add(t,r.multiply(i,s))),l)),i},lm_matx:function(e,i,t,n,o,l,a,p,d,u,h,c){var m=p.length,g=a.length;u=u||1e-3;var f=e(i,a,h);l=0==c%(2*g)||0<o?this.lm_FD_J(e,i,a,f,u,h):this.lm_Broyden_J(t,n,l,a,f);var y=r.subtract(p,f),x=r.multiply(r.transpose(y),r.dotMultiply(y,d)),b=r.transpose(l),_=r.multiply(b,r.dotMultiply(l,r.multiply(d,s.ones(1,g)))),k=r.multiply(b,r.dotMultiply(d,y));return{JtWJ:_,JtWdy:k,Chi_sq:x,y_hat:f,J:l}}}},{"./algebra":83,"ml-matrix":92}],83:[function(e,t){"use strict";var n=e("ml-matrix");t.exports={transpose:function(e){if("number"==typeof e)return e;var t=e.clone();return t.transpose()},add:function(e,t){if("number"==typeof e&&"number"==typeof t)return e+t;if("number"==typeof e)return this.add(t,e);var i=e.clone();return i.add(t)},subtract:function(e,t){if("number"==typeof e&&"number"==typeof t)return e-t;if("number"==typeof e)return this.subtract(t,e);var i=e.clone();return i.sub(t)},multiply:function(e,t){if("number"==typeof e&&"number"==typeof t)return e*t;if("number"==typeof e)return this.multiply(t,e);var i=e.clone();return"number"==typeof t?i.mul(t):i=i.mmul(t),1==i.rows&&1==i.columns?i[0][0]:i},dotMultiply:function(e,t){var i=e.clone();return i.mul(t)},dotDivide:function(e,t){var i=e.clone();return i.div(t)},diag:function(e){var t=null,i=e.rows,o=e.columns,s,l;if("undefined"==typeof o&&"object"==typeof e)if(e[0]&&e[0].length)for(i=e.length,o=e[0].length,l=_(i,o),t=n.zeros(o,o),s=0;s<o;s++)t[s][s]=e[s][s];else for(o=e.length,t=n.zeros(o,o),s=0;s<o;s++)t[s][s]=e[s];if(1==i)for(t=n.zeros(o,o),s=0;s<o;s++)t[s][s]=e[0][s];else if(0<i&&0<o)for(l=_(i,o),t=Array(l),s=0;s<l;s++)t[s]=e[s][s];return t},min:function(e,t){if("number"==typeof e&&"number"==typeof t)return _(e,t);for(var o=e.rows,s=e.columns,r=new n(o,s),l=0;l<o;l++)for(var i=0;i<s;i++)r[l][i]=e[l][i]<t[l][i]?e[l][i]:t[l][i];return r},max:function(e,t){if("number"==typeof e&&"number"==typeof t)return o(e,t);for(var s=e.rows,r=e.columns,l=new n(s,r),a=0;a<s;a++)for(var i=0;i<r;i++)l[a][i]=e[a][i]>t[a][i]?e[a][i]:t[a][i];return l},solve:function(e,t){return e.solve(t)},inv:function(e){return"number"==typeof e?1/e:e.inverse()},sqrt:function(e){if("number"==typeof e)return u(e);for(var t=e.rows,o=e.columns,s=new n(t,o),r=0;r<t;r++)for(var i=0;i<o;i++)s[r][i]=u(e[r][i]);return s},exp:function(e){if("number"==typeof e)return u(e);for(var t=e.rows,o=e.columns,s=new n(t,o),r=0;r<t;r++)for(var i=0;i<o;i++)s[r][i]=c(e[r][i]);return s},dotPow:function(e,t){if("number"==typeof e)return f(e,t);for(var o=e.rows,s=e.columns,r=new n(o,s),l=0;l<o;l++)for(var i=0;i<s;i++)r[l][i]=f(e[l][i],t);return r},abs:function(e){if("number"==typeof e)return C(e);for(var t=e.rows,o=e.columns,s=new n(t,o),r=0;r<t;r++)for(var i=0;i<o;i++)s[r][i]=C(e[r][i]);return s},matrix:function(e,t){return new n(e,t)},ones:function(e,t){return n.ones(e,t)},zeros:function(e,t){return n.zeros(e,t)},random:function(e,t){return n.rand(e,t)},eye:function(e,t){return n.eye(e,t)}}},{"ml-matrix":92}],84:[function(e,t){"use strict";t.exports=e("./LM"),t.exports.Matrix=e("ml-matrix"),t.exports.Matrix.algebra=e("./algebra")},{"./LM":82,"./algebra":83,"ml-matrix":92}],85:[function(e,t){"use strict";function n(e){if(!(this instanceof n))return new n(e);if(e=r.checkMatrix(e),!e.isSymmetric())throw new Error("Matrix is not symmetric");var t=e,a=t.rows,p=new r(a,a),l=!0,c,i,h;for(i=0;i<a;i++){var m=p[i],g=0;for(h=0;h<i;h++){var d=p[h],f=0;for(c=0;c<h;c++)f+=d[c]*m[c];m[h]=f=(t[i][h]-f)/p[h][h],g+=f*f}for(g=t[i][i]-g,l&=0<g,p[i][i]=u(o(g,0)),h=i+1;h<a;h++)p[i][h]=0}if(!l)throw new Error("Matrix is not positive definite");this.L=p}var r=e("../matrix");n.prototype={get leftTriangularFactor(){return this.L},solve:function(e){e=r.checkMatrix(e);var t=this.L,n=t.rows;if(e.rows!==n)throw new Error("Matrix dimensions do not match");var o=e.columns,s=e.clone(),l,i,a;for(a=0;a<n;a++)for(i=0;i<o;i++){for(l=0;l<a;l++)s[a][i]-=s[l][i]*t[a][l];s[a][i]/=t[a][a]}for(a=n-1;0<=a;a--)for(i=0;i<o;i++){for(l=a+1;l<n;l++)s[a][i]-=s[l][i]*t[l][a];s[a][i]/=t[a][a]}return s}},t.exports=n},{"../matrix":93}],86:[function(e,t){"use strict";function s(t){if(!(this instanceof s))return new s(t);if(t=h.checkMatrix(t),!t.isSquare())throw new Error("Matrix is not a square matrix");var o=t.columns,n=h.zeros(o,o),c=Array(o),d=Array(o),e=t,u,i;if(t.isSymmetric()){for(u=0;u<o;u++)for(i=0;i<o;i++)n[u][i]=e[u][i];r(o,d,c,n),l(o,d,c,n)}else{var m=h.zeros(o,o),g=Array(o);for(i=0;i<o;i++)for(u=0;u<o;u++)m[u][i]=e[u][i];a(o,m,g,n),p(o,d,c,n,m)}this.n=o,this.e=d,this.d=c,this.V=n}function r(t,n,e,o){var s,r,l,a,i,p,d,c;for(i=0;i<t;i++)e[i]=o[t-1][i];for(a=t-1;0<a;a--){for(c=0,l=0,p=0;p<a;p++)c+=C(e[p]);if(0===c)for(n[a]=e[a-1],i=0;i<a;i++)e[i]=o[a-1][i],o[a][i]=0,o[i][a]=0;else{for(p=0;p<a;p++)e[p]/=c,l+=e[p]*e[p];for(s=e[a-1],r=u(l),0<s&&(r=-r),n[a]=c*r,l-=s*r,e[a-1]=s-r,i=0;i<a;i++)n[i]=0;for(i=0;i<a;i++){for(s=e[i],o[i][a]=s,r=n[i]+o[i][i]*s,p=i+1;p<=a-1;p++)r+=o[p][i]*e[p],n[p]+=o[p][i]*s;n[i]=r}for(s=0,i=0;i<a;i++)n[i]/=l,s+=n[i]*e[i];for(d=s/(l+l),i=0;i<a;i++)n[i]-=d*e[i];for(i=0;i<a;i++){for(s=e[i],r=n[i],p=i;p<=a-1;p++)o[p][i]-=s*n[p]+r*e[p];e[i]=o[a-1][i],o[a][i]=0}}e[a]=l}for(a=0;a<t-1;a++){if(o[t-1][a]=o[a][a],o[a][a]=1,l=e[a+1],0!==l){for(p=0;p<=a;p++)e[p]=o[p][a+1]/l;for(i=0;i<=a;i++){for(r=0,p=0;p<=a;p++)r+=o[p][a+1]*o[p][i];for(p=0;p<=a;p++)o[p][i]-=r*e[p]}}for(p=0;p<=a;p++)o[p][a+1]=0}for(i=0;i<t;i++)e[i]=o[t-1][i],o[t-1][i]=0;o[t-1][t-1]=1,n[0]=0}function l(t,n,e,a){var d,u,h,i,g,y,l,x,p,b,_,c,k,j,w,v,S;for(h=1;h<t;h++)n[h-1]=n[h];n[t-1]=0;var D=0,f=0,E=2.220446049250313e-16;for(y=0;y<t;y++){for(f=o(f,C(e[y])+C(n[y])),l=y;l<t&&!(C(n[l])<=E*f);)l++;if(l>y){S=0;do{for(++S,d=e[y],x=(e[y+1]-d)/(2*n[y]),p=m(x,1),0>x&&(p=-p),e[y]=n[y]/(x+p),e[y+1]=n[y]*(x+p),b=e[y+1],u=d-e[y],h=y+2;h<t;h++)e[h]-=u;for(D+=u,x=e[l],_=1,c=_,k=_,j=n[y+1],w=0,v=0,h=l-1;h>=y;h--)for(k=c,c=_,v=w,d=_*n[h],u=_*x,p=m(x,n[h]),n[h+1]=w*p,w=n[h]/p,_=x/p,x=_*e[h]-w*d,e[h+1]=u+w*(_*d+w*e[h]),g=0;g<t;g++)u=a[g][h+1],a[g][h+1]=w*a[g][h]+_*u,a[g][h]=_*a[g][h]-w*u;x=-w*v*k*j*n[y]/b,n[y]=w*x,e[y]=_*x}while(C(n[y])>E*f)}e[y]+=D,n[y]=0}for(h=0;h<t-1;h++){for(g=h,x=e[h],i=h+1;i<t;i++)e[i]<x&&(g=i,x=e[i]);if(g!==h)for(e[g]=e[h],e[h]=x,i=0;i<t;i++)x=a[i][h],a[i][h]=a[i][g],a[i][g]=x}}function a(e,t,n,o){var s=0,r=e-1,l,a,p,d,i,c,h;for(c=s+1;c<=r-1;c++){for(h=0,d=c;d<=r;d++)h+=C(t[d][c-1]);if(0!==h){for(p=0,d=r;d>=c;d--)n[d]=t[d][c-1]/h,p+=n[d]*n[d];for(a=u(p),0<n[c]&&(a=-a),p-=n[c]*a,n[c]-=a,i=c;i<e;i++){for(l=0,d=r;d>=c;d--)l+=n[d]*t[d][i];for(l/=p,d=c;d<=r;d++)t[d][i]-=l*n[d]}for(d=0;d<=r;d++){for(l=0,i=r;i>=c;i--)l+=n[i]*t[d][i];for(l/=p,i=c;i<=r;i++)t[d][i]-=l*n[i]}n[c]=h*n[c],t[c][c-1]=h*a}}for(d=0;d<e;d++)for(i=0;i<e;i++)o[d][i]=d===i?1:0;for(c=r-1;c>=s+1;c--)if(0!==t[c][c-1]){for(d=c+1;d<=r;d++)n[d]=t[d][c-1];for(i=c;i<=r;i++){for(a=0,d=c;d<=r;d++)a+=n[d]*o[d][i];for(a=a/n[c]/t[c][c-1],d=c;d<=r;d++)o[d][i]+=a*n[d]}}}function p(a,h,e,d,g){var f=a-1,n=0,b=a-1,v=2.220446049250313e-16,S=0,D=0,E=0,p=0,I=0,H=0,A=0,F=0,R,i,j,k,l,m,t,w,x,y,P,T,O,M,N;for(R=0;R<a;R++)for((R<n||R>b)&&(e[R]=g[R][R],h[R]=0),i=o(R-1,0);i<a;i++)D+=C(g[R][i]);for(;f>=n;){for(k=f;k>n&&(H=C(g[k-1][k-1])+C(g[k][k]),0===H&&(H=D),!(C(g[k][k-1])<v*H));)k--;if(k===f)g[f][f]+=S,e[f]=g[f][f],h[f]=0,f--,F=0;else if(k===f-1){if(t=g[f][f-1]*g[f-1][f],E=(g[f-1][f-1]-g[f][f])/2,p=E*E+t,A=u(C(p)),g[f][f]+=S,g[f-1][f-1]=g[f-1][f-1]+S,w=g[f][f],0<=p){for(A=0<=E?E+A:E-A,e[f-1]=w+A,e[f]=e[f-1],0!==A&&(e[f]=w-t/A),h[f-1]=0,h[f]=0,w=g[f][f-1],H=C(w)+C(A),E=w/H,p=A/H,I=u(E*E+p*p),E/=I,p/=I,i=f-1;i<a;i++)A=g[f-1][i],g[f-1][i]=p*A+E*g[f][i],g[f][i]=p*g[f][i]-E*A;for(R=0;R<=f;R++)A=g[R][f-1],g[R][f-1]=p*A+E*g[R][f],g[R][f]=p*g[R][f]-E*A;for(R=n;R<=b;R++)A=d[R][f-1],d[R][f-1]=p*A+E*d[R][f],d[R][f]=p*d[R][f]-E*A}else e[f-1]=w+E,e[f]=w+E,h[f-1]=A,h[f]=-A;f-=2,F=0}else{if(w=g[f][f],x=0,t=0,k<f&&(x=g[f-1][f-1],t=g[f][f-1]*g[f-1][f]),10==F){for(S+=w,R=n;R<=f;R++)g[R][R]-=w;H=C(g[f][f-1])+C(g[f-1][f-2]),w=x=0.75*H,t=-0.4375*H*H}if(30==F&&(H=(x-w)/2,H=H*H+t,0<H)){for(H=u(H),x<w&&(H=-H),H=w-t/((x-w)/2+H),R=n;R<=f;R++)g[R][R]-=H;S+=H,w=x=t=0.964}for(++F,l=f-2;l>=k&&(A=g[l][l],I=w-A,H=x-A,E=(I*H-t)/g[l+1][l]+g[l][l+1],p=g[l+1][l+1]-A-I-H,I=g[l+2][l+1],H=C(E)+C(p)+C(I),E/=H,p/=H,I/=H,l!==k)&&!(C(g[l][l-1])*(C(p)+C(I))<v*(C(E)*(C(g[l-1][l-1])+C(A)+C(g[l+1][l+1]))));)l--;for(R=l+2;R<=f;R++)g[R][R-2]=0,R>l+2&&(g[R][R-3]=0);for(j=l;j<=f-1&&(M=j!==f-1,j!==l&&(E=g[j][j-1],p=g[j+1][j-1],I=M?g[j+2][j-1]:0,w=C(E)+C(p)+C(I),0!==w&&(E/=w,p/=w,I/=w)),0!==w);j++)if(H=u(E*E+p*p+I*I),0>E&&(H=-H),0!==H){for(j===l?k!==l&&(g[j][j-1]=-g[j][j-1]):g[j][j-1]=-H*w,E+=H,w=E/H,x=p/H,A=I/H,p/=E,I/=E,i=j;i<a;i++)E=g[j][i]+p*g[j+1][i],M&&(E+=I*g[j+2][i],g[j+2][i]=g[j+2][i]-E*A),g[j][i]-=E*w,g[j+1][i]=g[j+1][i]-E*x;for(R=0;R<=_(f,j+3);R++)E=w*g[R][j]+x*g[R][j+1],M&&(E+=A*g[R][j+2],g[R][j+2]=g[R][j+2]-E*I),g[R][j]-=E,g[R][j+1]=g[R][j+1]-E*p;for(R=n;R<=b;R++)E=w*d[R][j]+x*d[R][j+1],M&&(E+=A*d[R][j+2],d[R][j+2]=d[R][j+2]-E*I),d[R][j]-=E,d[R][j+1]=d[R][j+1]-E*p}}}if(0!==D){for(f=a-1;0<=f;f--)if(E=e[f],p=h[f],0===p)for(k=f,g[f][f]=1,R=f-1;0<=R;R--){for(t=g[R][R]-E,I=0,i=k;i<=f;i++)I+=g[R][i]*g[i][f];if(0>h[R])A=t,H=I;else if(k=R,0===h[R]?g[R][f]=0===t?-I/(v*D):-I/t:(w=g[R][R+1],x=g[R+1][R],p=(e[R]-E)*(e[R]-E)+h[R]*h[R],m=(w*H-A*I)/p,g[R][f]=m,g[R+1][f]=C(w)>C(A)?(-I-t*m)/w:(-H-x*m)/A),m=C(g[R][f]),1<v*m*m)for(i=R;i<=f;i++)g[i][f]/=m}else if(0>p)for(k=f-1,C(g[f][f-1])>C(g[f-1][f])?(g[f-1][f-1]=p/g[f][f-1],g[f-1][f]=-(g[f][f]-E)/g[f][f-1]):(N=c(0,-g[f-1][f],g[f-1][f-1]-E,p),g[f-1][f-1]=N[0],g[f-1][f]=N[1]),g[f][f-1]=0,g[f][f]=1,R=f-2;0<=R;R--){for(y=0,P=0,i=k;i<=f;i++)y+=g[R][i]*g[i][f-1],P+=g[R][i]*g[i][f];if(t=g[R][R]-E,0>h[R])A=t,I=y,H=P;else if(k=R,0===h[R]?(N=c(-y,-P,t,p),g[R][f-1]=N[0],g[R][f]=N[1]):(w=g[R][R+1],x=g[R+1][R],T=(e[R]-E)*(e[R]-E)+h[R]*h[R]-p*p,O=2*(e[R]-E)*p,0===T&&0===O&&(T=v*D*(C(t)+C(p)+C(w)+C(x)+C(A))),N=c(w*I-A*y+p*P,w*H-A*P-p*y,T,O),g[R][f-1]=N[0],g[R][f]=N[1],C(w)>C(A)+C(p)?(g[R+1][f-1]=(-y-t*g[R][f-1]+p*g[R][f])/w,g[R+1][f]=(-P-t*g[R][f]-p*g[R][f-1])/w):(N=c(-I-x*g[R][f-1],-H-x*g[R][f],A,p),g[R+1][f-1]=N[0],g[R+1][f]=N[1])),m=o(C(g[R][f-1]),C(g[R][f])),1<v*m*m)for(i=R;i<=f;i++)g[i][f-1]=g[i][f-1]/m,g[i][f]/=m}for(R=0;R<a;R++)if(R<n||R>b)for(i=R;i<a;i++)d[R][i]=g[R][i];for(i=a-1;i>=n;i--)for(R=n;R<=b;R++){for(A=0,j=n;j<=_(i,b);j++)A+=d[R][j]*g[j][i];d[R][i]=A}}}function c(e,t,i,n){var o,s;return C(i)>C(n)?(o=n/i,s=i+o*n,[(e+o*t)/s,(t-o*e)/s]):(o=i/n,s=n+o*i,[(o*e+t)/s,(o*t-e)/s])}var h=e("../matrix"),m=e("./util").hypotenuse;s.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return this.V},get diagonalMatrix(){var t=this.n,n=this.e,e=this.d,o=new h(t,t),s,i;for(s=0;s<t;s++){for(i=0;i<t;i++)o[s][i]=0;o[s][s]=e[s],0<n[s]?o[s][s+1]=n[s]:0>n[s]&&(o[s][s-1]=n[s])}return o}},t.exports=s},{"../matrix":93,"./util":90}],87:[function(e,t){"use strict";function n(e){if(!(this instanceof n))return new n(e);e=o.checkMatrix(e);var r=e.clone(),l=r.rows,a=r.columns,d=Array(l),c=1,u,i,h,m,p,s,t,g,f,y;for(u=0;u<l;u++)d[u]=u;for(f=Array(l),i=0;i<a;i++){for(u=0;u<l;u++)f[u]=r[u][i];for(u=0;u<l;u++){for(g=r[u],y=_(u,i),p=0,h=0;h<y;h++)p+=g[h]*f[h];g[i]=f[u]-=p}for(m=i,u=i+1;u<l;u++)C(f[u])>C(f[m])&&(m=u);if(m!==i){for(h=0;h<a;h++)s=r[m][h],r[m][h]=r[i][h],r[i][h]=s;t=d[m],d[m]=d[i],d[i]=t,c=-c}if(i<l&&0!==r[i][i])for(u=i+1;u<l;u++)r[u][i]/=r[i][i]}this.LU=r,this.pivotVector=d,this.pivotSign=c}var o=e("../matrix");n.prototype={isSingular:function(){for(var e=this.LU,t=e.columns,i=0;i<t;i++)if(0===e[i][i])return!0;return!1},get determinant(){var e=this.LU;if(!e.isSquare())throw new Error("Matrix must be square");for(var t=this.pivotSign,i=e.columns,n=0;n<i;n++)t*=e[n][n];return t},get lowerTriangularFactor(){for(var e=this.LU,t=e.rows,n=e.columns,s=new o(t,n),r=0;r<t;r++)for(var i=0;i<n;i++)s[r][i]=r>i?e[r][i]:r===i?1:0;return s},get upperTriangularFactor(){for(var e=this.LU,t=e.rows,n=e.columns,s=new o(t,n),r=0;r<t;r++)for(var i=0;i<n;i++)s[r][i]=r<=i?e[r][i]:0;return s},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(e){e=o.checkMatrix(e);var t=this.LU,n=t.rows;if(n!==e.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var s=e.columns,r=e.subMatrixRow(this.pivotVector,0,s-1),l=t.columns,a,i,p;for(p=0;p<l;p++)for(a=p+1;a<l;a++)for(i=0;i<s;i++)r[a][i]-=r[p][i]*t[a][p];for(p=l-1;0<=p;p--){for(i=0;i<s;i++)r[p][i]/=t[p][p];for(a=0;a<p;a++)for(i=0;i<s;i++)r[a][i]-=r[p][i]*t[a][p]}return r}},t.exports=n},{"../matrix":93}],88:[function(e,t){"use strict";function o(e){if(!(this instanceof o))return new o(e);e=r.checkMatrix(e);var t=e.clone(),l=e.rows,a=e.columns,p=Array(a),d,i,c,u;for(c=0;c<a;c++){var h=0;for(d=c;d<l;d++)h=n(h,t[d][c]);if(0!==h){for(0>t[c][c]&&(h=-h),d=c;d<l;d++)t[d][c]/=h;for(t[c][c]+=1,i=c+1;i<a;i++){for(u=0,d=c;d<l;d++)u+=t[d][c]*t[d][i];for(u=-u/t[c][c],d=c;d<l;d++)t[d][i]+=u*t[d][c]}}p[c]=-h}this.QR=t,this.Rdiag=p}var r=e("../matrix"),n=e("./util").hypotenuse;o.prototype={solve:function(e){e=r.checkMatrix(e);var t=this.QR,o=t.rows;if(e.rows!==o)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var l=e.columns,a=e.clone(),p=t.columns,n,i,d,c;for(d=0;d<p;d++)for(i=0;i<l;i++){for(c=0,n=d;n<o;n++)c+=t[n][d]*a[n][i];for(c=-c/t[d][d],n=d;n<o;n++)a[n][i]+=c*t[n][d]}for(d=p-1;0<=d;d--){for(i=0;i<l;i++)a[d][i]/=this.Rdiag[d];for(n=0;n<d;n++)for(i=0;i<l;i++)a[n][i]-=a[d][i]*t[n][d]}return a.subMatrix(0,p-1,0,l-1)},isFullRank:function(){for(var e=this.QR.columns,t=0;t<e;t++)if(0===this.Rdiag[t])return!1;return!0},get upperTriangularFactor(){var e=this.QR,t=e.columns,n=new r(t,t),o,i;for(o=0;o<t;o++)for(i=0;i<t;i++)n[o][i]=o<i?e[o][i]:o===i?this.Rdiag[o]:0;return n},get orthogonalFactor(){var e=this.QR,t=e.rows,n=e.columns,o=new r(t,n),l,i,a,p;for(a=n-1;0<=a;a--){for(l=0;l<t;l++)o[l][a]=0;for(o[a][a]=1,i=a;i<n;i++)if(0!==e[a][a]){for(p=0,l=a;l<t;l++)p+=e[l][a]*o[l][i];for(p=-p/e[a][a],l=a;l<t;l++)o[l][i]+=p*e[l][a]}}return o}},t.exports=o},{"../matrix":93,"./util":90}],89:[function(e,t){"use strict";function r(h,y){if(!(this instanceof r))return new r(h,y);h=l.checkMatrix(h),y=y||{};var x=h.clone(),a=h.rows,m=h.columns,n=_(a,m),w=!0,v=!0;!1===y.computeLeftSingularVectors&&(w=!1),!1===y.computeRightSingularVectors&&(v=!1);var S=!0===y.autoTranspose,D=!1;if(a<m)if(!S)console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else{x=x.transpose(),a=x.rows,m=x.columns,D=!0;var E=w;w=v,v=E}var I=Array(_(a+1,m)),s=l.zeros(a,n),H=l.zeros(m,m),A=Array(m),e=Array(a),z=_(a-1,m),F=o(0,_(m-2,a)),R,i,j,k,p,P,T,f,O,M,N,X,L,Y,U,B,V,q,b,c,$;for(j=0,M=o(z,F);j<M;j++){if(j<z){for(I[j]=0,R=j;R<a;R++)I[j]=d(I[j],x[R][j]);if(0!==I[j]){for(0>x[j][j]&&(I[j]=-I[j]),R=j;R<a;R++)x[R][j]/=I[j];x[j][j]+=1}I[j]=-I[j]}for(i=j+1;i<m;i++){if(j<z&&0!==I[j]){for(p=0,R=j;R<a;R++)p+=x[R][j]*x[R][i];for(p=-p/x[j][j],R=j;R<a;R++)x[R][i]+=p*x[R][j]}A[i]=x[j][i]}if(w&&j<z)for(R=j;R<a;R++)s[R][j]=x[R][j];if(j<F){for(A[j]=0,R=j+1;R<m;R++)A[j]=d(A[j],A[R]);if(0!==A[j]){for(0>A[j+1]&&(A[j]=-A[j]),R=j+1;R<m;R++)A[R]/=A[j];A[j+1]+=1}if(A[j]=-A[j],j+1<a&&0!==A[j]){for(R=j+1;R<a;R++)e[R]=0;for(i=j+1;i<m;i++)for(R=j+1;R<a;R++)e[R]+=A[i]*x[R][i];for(i=j+1;i<m;i++)for(p=-A[i]/A[j+1],R=j+1;R<a;R++)x[R][i]+=p*e[R]}if(v)for(R=j+1;R<m;R++)H[R][j]=A[R]}}if(k=_(m,a+1),z<m&&(I[z]=x[z][z]),a<k&&(I[k-1]=0),F+1<k&&(A[F]=x[F][k-1]),A[k-1]=0,w){for(i=z;i<n;i++){for(R=0;R<a;R++)s[R][i]=0;s[i][i]=1}for(j=z-1;0<=j;j--)if(0!==I[j]){for(i=j+1;i<n;i++){for(p=0,R=j;R<a;R++)p+=s[R][j]*s[R][i];for(p=-p/s[j][j],R=j;R<a;R++)s[R][i]+=p*s[R][j]}for(R=j;R<a;R++)s[R][j]=-s[R][j];for(s[j][j]=1+s[j][j],R=0;R<j-1;R++)s[R][j]=0}else{for(R=0;R<a;R++)s[R][j]=0;s[j][j]=1}}if(v)for(j=m-1;0<=j;j--){if(j<F&&0!==A[j])for(i=j+1;i<m;i++){for(p=0,R=j+1;R<m;R++)p+=H[R][j]*H[R][i];for(p=-p/H[j+1][j],R=j+1;R<m;R++)H[R][i]+=p*H[R][j]}for(R=0;R<m;R++)H[R][j]=0;H[j][j]=1}for(var g=k-1,Z=0,W=2.220446049250313e-16;0<k;){for(j=k-2;-1<=j&&-1!==j;j--)if(C(A[j])<=W*(C(I[j])+C(I[j+1]))){A[j]=0;break}if(j===k-2)N=4;else{for(P=k-1;P>=j&&P!==j;P--)if(p=(P===k?0:C(A[P]))+(P===j+1?0:C(A[P-1])),C(I[P])<=W*p){I[P]=0;break}P===j?N=3:P===k-1?N=1:(N=2,j=P)}switch(j++,N){case 1:{for(T=A[k-2],A[k-2]=0,i=k-2;i>=j;i--)if(p=d(I[i],T),f=I[i]/p,O=T/p,I[i]=p,i!==j&&(T=-O*A[i-1],A[i-1]=f*A[i-1]),v)for(R=0;R<m;R++)p=f*H[R][i]+O*H[R][k-1],H[R][k-1]=-O*H[R][i]+f*H[R][k-1],H[R][i]=p;break}case 2:{for(T=A[j-1],A[j-1]=0,i=j;i<k;i++)if(p=d(I[i],T),f=I[i]/p,O=T/p,I[i]=p,T=-O*A[i],A[i]=f*A[i],w)for(R=0;R<a;R++)p=f*s[R][i]+O*s[R][j-1],s[R][j-1]=-O*s[R][i]+f*s[R][j-1],s[R][i]=p;break}case 3:{for(X=o(o(o(o(C(I[k-1]),C(I[k-2])),C(A[k-2])),C(I[j])),C(A[j])),L=I[k-1]/X,Y=I[k-2]/X,U=A[k-2]/X,B=I[j]/X,V=A[j]/X,q=((Y+L)*(Y-L)+U*U)/2,b=L*U*(L*U),c=0,(0!==q||0!==b)&&(c=u(q*q+b),0>q&&(c=-c),c=b/(q+c)),T=(B+L)*(B-L)+c,$=B*V,i=j;i<k-1;i++){if(p=d(T,$),f=T/p,O=$/p,i!==j&&(A[i-1]=p),T=f*I[i]+O*A[i],A[i]=f*A[i]-O*I[i],$=O*I[i+1],I[i+1]=f*I[i+1],v)for(R=0;R<m;R++)p=f*H[R][i]+O*H[R][i+1],H[R][i+1]=-O*H[R][i]+f*H[R][i+1],H[R][i]=p;if(p=d(T,$),f=T/p,O=$/p,I[i]=p,T=f*A[i]+O*I[i+1],I[i+1]=-O*A[i]+f*I[i+1],$=O*A[i+1],A[i+1]=f*A[i+1],w&&i<a-1)for(R=0;R<a;R++)p=f*s[R][i]+O*s[R][i+1],s[R][i+1]=-O*s[R][i]+f*s[R][i+1],s[R][i]=p}A[k-2]=T,++Z;break}case 4:{if(0>=I[j]&&(I[j]=0>I[j]?-I[j]:0,v))for(R=0;R<=g;R++)H[R][j]=-H[R][j];for(;j<g&&!(I[j]>=I[j+1]);){if(p=I[j],I[j]=I[j+1],I[j+1]=p,v&&j<m-1)for(R=0;R<m;R++)p=H[R][j+1],H[R][j+1]=H[R][j],H[R][j]=p;if(w&&j<a-1)for(R=0;R<a;R++)p=s[R][j+1],s[R][j+1]=s[R][j],s[R][j]=p;j++}Z=0,k--;break}}}if(D){var J=H;H=s,s=J}this.m=a,this.n=m,this.s=I,this.U=s,this.V=H}var l=e("../matrix"),d=e("./util").hypotenuse;r.prototype={get condition(){return this.s[0]/this.s[_(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){for(var e=o(this.m,this.n)*this.s[0]*2.220446049250313e-16,t=0,n=this.s,s=0,i=n.length;s<i;s++)n[s]>e&&t++;return t},get diagonal(){return this.s},get threshold(){return 2.220446049250313e-16/2*o(this.m,this.n)*this.s[0]},get leftSingularVectors(){return this.U},get rightSingularVectors(){return this.V},get diagonalMatrix(){return l.diag(this.s)},solve:function(t){var n=this.threshold,e=this.s.length,o=l.zeros(e,e),s;for(s=0;s<e;s++)o[s][s]=C(this.s[s])<=n?0:1/this.s[s];var i=this.V.mmul(o),r=this.V.rows,a=this.U.rows,p=l.zeros(r,a),d,c,u;for(s=0;s<r;s++)for(d=0;d<a;d++){for(u=0,c=0;c<e;c++)u+=i[s][c]*this.U[d][c];p[s][d]=u}return p.mmul(t)},solveForDiagonal:function(e){return this.solve(l.diag(e))},inverse:function(){var t=this.threshold,e=this.V.rows,n=this.V.columns,o=new l(e,this.s.length),s,i;for(s=0;s<e;s++)for(i=0;i<n;i++)o[s][i]=C(this.s[i])>t?this.V[s][i]/this.s[i]:0;var r=this.U.rows,a=this.U.columns,p=new l(e,r),d,c;for(s=0;s<e;s++)for(i=0;i<r;i++){for(c=0,d=0;d<a;d++)c+=o[s][d]*this.U[i][d];p[s][i]=c}return p}},t.exports=r},{"../matrix":93,"./util":90}],90:[function(e,t,i){"use strict";i.hypotenuse=function(e,t){var i;return C(e)>C(t)?(i=t/e,C(e)*u(1+i*i)):0===t?0:(i=e/t,C(t)*u(1+i*i))}},{}],91:[function(e,t){"use strict";function i(e){return n(e,o.eye(e.rows))}function n(e,t){return e.isSquare()?new l(e).solve(t):new a(e).solve(t)}var o=e("./matrix"),s=e("./dc/svd"),r=e("./dc/evd"),l=e("./dc/lu"),a=e("./dc/qr"),p=e("./dc/cholesky");o.prototype.inverse=function(){return i(this)},o.prototype.solve=function(e){return n(this,e)},t.exports={SingularValueDecomposition:s,SVD:s,EigenvalueDecomposition:r,EVD:r,LuDecomposition:l,LU:l,QrDecomposition:a,QR:a,CholeskyDecomposition:p,CHO:p,inverse:i,solve:n}},{"./dc/cholesky":85,"./dc/evd":86,"./dc/lu":87,"./dc/qr":88,"./dc/svd":89,"./matrix":93}],92:[function(e,t){"use strict";t.exports=e("./matrix"),t.exports.Decompositions=t.exports.DC=e("./decompositions")},{"./decompositions":91,"./matrix":93}],93:[function(e,t){"use strict";function n(e){for(var t=0,i=e.length,n=Array(i);t<i;t++)n[t]=e[t];return n}function o(e,t){var s=0,i,r;if(Array.isArray(e)){if(r=t,i=r?n(e):e,e=i.length,t=i[0].length,"undefined"==typeof t)throw new TypeError("Data must be a 2D array");if(0<e&&0<t){for(;s<e;s++)if(i[s].length!==t)throw new RangeError("Inconsistent array dimensions");else r&&(i[s]=n(i[s]));}else throw new RangeError("Invalid dimensions: "+e+"x"+t)}else if("number"!=typeof e)throw new TypeError("Invalid arguments");else if(0<e&&0<t)for(i=Array(e);s<e;s++)i[s]=Array(t);else throw new RangeError("Invalid dimensions: "+e+"x"+t);return Object.defineProperty(i,"rows",{writable:!0,value:e}),Object.defineProperty(i,"columns",{writable:!0,value:t}),i.__proto__=o.prototype,i}var i=Array.prototype.splice,s=Array.prototype.concat;o.from1DArray=function(e,t,n){var s=0,i,r;if(i=e*t,i!==n.length)throw new RangeError("Data length does not match given dimensions");for(r=Array(e);s<e;s++)r[s]=n.slice(s*t,(s+1)*t);return new o(r)},o.rowVector=function(e){return new o([e])},o.columnVector=function(e){for(var t=e.length,n=Array(t),s=0;s<t;s++)n[s]=[e[s]];return new o(n)},o.empty=function(e,t){return new o(e,t)},o.zeros=function(e,t){return o.empty(e,t).fill(0)},o.ones=function(e,t){return o.empty(e,t).fill(1)},o.rand=function(e,t){for(var n=o.empty(e,t),s=0,i=n.rows;s<i;s++)for(var r=0,l=n.columns;r<l;r++)n[s][r]=Math.random();return n},o.eye=function(e){for(var t=o.zeros(e,e),n=t.rows,s=0;s<n;s++)t[s][s]=1;return t},o.diag=function(e){for(var t=e.length,n=o.zeros(t,t),s=0;s<t;s++)n[s][s]=e[s];return n},o.indices=function(e,t){for(var n=Array(t-e),o=0;o<n.length;o++)n[o]=e++;return n},o.stack=function(e){var t,i,n;if(o.isMatrix(e)){var s=0,l=0;for(t=0;t<arguments.length;t++)s+=arguments[t].rows,arguments[t].columns>l&&(l=arguments[t].columns);var a=o.zeros(s,l),r=0;for(t=0;t<arguments.length;t++){var p=arguments[t];for(i=0;i<p.rows;i++){for(n=0;n<p.columns;n++)a[r][n]=p[i][n];r++}}return a}if(Array.isArray(e)){var d=o.empty(arguments.length,e.length);for(t=0;t<arguments.length;t++)d.setRow(t,arguments[t]);return d}},o.expand=function(e,t){for(var n=[],s=0;s<t.length;s++)for(var i=0;i<t[s];i++)n.push(e[s]);return new o(n)},o.checkMatrix=function(e){if(!e)throw new TypeError("Argument has to be a matrix");return"Matrix"!==e.klass&&(e=new o(e)),e},o.isMatrix=function(e){return!!e&&"Matrix"===e.klass},Object.defineProperty(o.prototype,"klass",{get:function(){return"Matrix"}}),Object.defineProperty(o.prototype,"size",{get:function(){return this.rows*this.columns}}),o.prototype.checkRowIndex=function(e){if(0>e||e>this.rows-1)throw new RangeError("Row index out of range.")},o.prototype.checkColumnIndex=function(e){if(0>e||e>this.columns-1)throw new RangeError("Column index out of range.")},o.prototype.checkDimensions=function(e){if(this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal.")},o.prototype.apply=function(e){for(var t=this.rows,n=this.columns,o=0;o<t;o++)for(var i=0;i<n;i++)e.call(this,o,i);return this},o.prototype.clone=function(){return new o(this.to2DArray())},o.prototype.to1DArray=function(){return s.apply([],this)},o.prototype.to2DArray=function(){for(var e=this.rows,t=Array(e),o=0;o<e;o++)t[o]=n(this[o]);return t},o.prototype.isRowVector=function(){return 1===this.rows},o.prototype.isColumnVector=function(){return 1===this.columns},o.prototype.isVector=function(){return 1===this.rows||1===this.columns},o.prototype.isSquare=function(){return this.rows===this.columns},o.prototype.isSymmetric=function(){if(this.isSquare()){for(var e=this.rows,t=0;t<e;t++)for(var i=0;i<=t;i++)if(this[t][i]!==this[i][t])return!1;return!0}return!1},o.prototype.set=function(e,t,i){return this[e][t]=i,this},o.prototype.get=function(e,t){return this[e][t]},o.prototype.fill=function(e){for(var t=this.rows,n=this.columns,o=0;o<t;o++)for(var i=0;i<n;i++)this[o][i]=e;return this},o.prototype.neg=function(){return this.mulS(-1)},o.prototype.add=function(e){return"number"==typeof e?this.addS(e):(e=o.checkMatrix(e),this.addM(e))},o.prototype.addS=function(e){for(var t=this.rows,n=this.columns,o=0;o<t;o++)for(var i=0;i<n;i++)this[o][i]+=e;return this},o.prototype.addM=function(e){this.checkDimensions(e);for(var t=this.rows,n=this.columns,o=0;o<t;o++)for(var i=0;i<n;i++)this[o][i]+=e[o][i];return this},o.prototype.sub=function(e){return"number"==typeof e?this.subS(e):(e=o.checkMatrix(e),this.subM(e))},o.prototype.subS=function(e){for(var t=this.rows,n=this.columns,o=0;o<t;o++)for(var i=0;i<n;i++)this[o][i]-=e;return this},o.prototype.subM=function(e){this.checkDimensions(e);for(var t=this.rows,n=this.columns,o=0;o<t;o++)for(var i=0;i<n;i++)this[o][i]-=e[o][i];return this},o.prototype.mul=function(e){return"number"==typeof e?this.mulS(e):(e=o.checkMatrix(e),this.mulM(e))},o.prototype.mulS=function(e){for(var t=this.rows,n=this.columns,o=0;o<t;o++)for(var i=0;i<n;i++)this[o][i]*=e;return this},o.prototype.mulM=function(e){this.checkDimensions(e);for(var t=this.rows,n=this.columns,o=0;o<t;o++)for(var i=0;i<n;i++)this[o][i]*=e[o][i];return this},o.prototype.div=function(e){return"number"==typeof e?this.divS(e):(e=o.checkMatrix(e),this.divM(e))},o.prototype.divS=function(e){for(var t=this.rows,n=this.columns,o=0;o<t;o++)for(var i=0;i<n;i++)this[o][i]/=e;return this},o.prototype.divM=function(e){this.checkDimensions(e);for(var t=this.rows,n=this.columns,o=0;o<t;o++)for(var i=0;i<n;i++)this[o][i]/=e[o][i];return this},o.prototype.getRow=function(e){return this.checkRowIndex(e),n(this[e])},o.prototype.getRowVector=function(e){return o.rowVector(this.getRow(e))},o.prototype.setRow=function(e,t){if(this.checkRowIndex(e),o.isMatrix(t)&&(t=t.to1DArray()),t.length!==this.columns)throw new RangeError("Invalid row size");return this[e]=n(t),this},o.prototype.removeRow=function(e){if(this.checkRowIndex(e),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return i.call(this,e,1),this.rows-=1,this},o.prototype.addRow=function(e,t){if("undefined"==typeof t&&(t=e,e=this.rows),0>e||e>this.rows)throw new RangeError("Row index out of range.");if(o.isMatrix(t)&&(t=t.to1DArray()),t.length!==this.columns)throw new RangeError("Invalid row size");return i.call(this,e,0,n(t)),this.rows+=1,this},o.prototype.swapRows=function(e,t){this.checkRowIndex(e),this.checkRowIndex(t);var i=this[e];return this[e]=this[t],this[t]=i,this},o.prototype.getColumn=function(e){this.checkColumnIndex(e);for(var t=this.rows,n=Array(t),o=0;o<t;o++)n[o]=this[o][e];return n},o.prototype.getColumnVector=function(e){return o.columnVector(this.getColumn(e))},o.prototype.setColumn=function(e,t){this.checkColumnIndex(e),o.isMatrix(t)&&(t=t.to1DArray());var n=this.rows;if(t.length!==n)throw new RangeError("Invalid column size");for(var s=0;s<n;s++)this[s][e]=t[s];return this},o.prototype.removeColumn=function(e){if(this.checkColumnIndex(e),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(var t=0,i=this.rows;t<i;t++)this[t].splice(e,1);return this.columns-=1,this},o.prototype.addColumn=function(e,t){if("undefined"==typeof t&&(t=e,e=this.columns),0>e||e>this.columns)throw new RangeError("Column index out of range.");o.isMatrix(t)&&(t=t.to1DArray());var n=this.rows;if(t.length!==n)throw new RangeError("Invalid column size");for(var s=0;s<n;s++)this[s].splice(e,0,t[s]);return this.columns+=1,this},o.prototype.swapColumns=function(e,t){this.checkRowIndex(e),this.checkRowIndex(t);for(var n=this.rows,o=0,i,s;o<n;o++)s=this[o],i=s[e],s[e]=s[t],s[t]=i;return this},o.prototype.checkRowVector=function(e){if(o.isMatrix(e)&&(e=e.to1DArray()),e.length!==this.columns)throw new RangeError("vector size must be the same as the number of columns");return e},o.prototype.checkColumnVector=function(e){if(o.isMatrix(e)&&(e=e.to1DArray()),e.length!==this.rows)throw new RangeError("vector size must be the same as the number of rows");return e},o.prototype.addRowVector=function(e){e=this.checkRowVector(e);for(var t=this.rows,n=this.columns,o=0;o<t;o++)for(var i=0;i<n;i++)this[o][i]+=e[i];return this},o.prototype.subRowVector=function(e){e=this.checkRowVector(e);for(var t=this.rows,n=this.columns,o=0;o<t;o++)for(var i=0;i<n;i++)this[o][i]-=e[i];return this},o.prototype.mulRowVector=function(e){e=this.checkRowVector(e);for(var t=this.rows,n=this.columns,o=0;o<t;o++)for(var i=0;i<n;i++)this[o][i]*=e[i];return this},o.prototype.divRowVector=function(e){e=this.checkRowVector(e);for(var t=this.rows,n=this.columns,o=0;o<t;o++)for(var i=0;i<n;i++)this[o][i]/=e[i];return this},o.prototype.addColumnVector=function(e){e=this.checkColumnVector(e);for(var t=this.rows,n=this.columns,o=0;o<t;o++)for(var i=0;i<n;i++)this[o][i]+=e[o];return this},o.prototype.subColumnVector=function(e){e=this.checkColumnVector(e);for(var t=this.rows,n=this.columns,o=0;o<t;o++)for(var i=0;i<n;i++)this[o][i]-=e[o];return this},o.prototype.mulColumnVector=function(e){e=this.checkColumnVector(e);for(var t=this.rows,n=this.columns,o=0;o<t;o++)for(var i=0;i<n;i++)this[o][i]*=e[o];return this},o.prototype.divColumnVector=function(e){e=this.checkColumnVector(e);for(var t=this.rows,n=this.columns,o=0;o<t;o++)for(var i=0;i<n;i++)this[o][i]/=e[o];return this},o.prototype.mulRow=function(e,t){this.checkRowIndex(e);for(var n=0,i=this.columns;n<i;n++)this[e][n]*=t;return this},o.prototype.mulColumn=function(e,t){this.checkColumnIndex(e);for(var n=0,i=this.rows;n<i;n++)this[n][e]*=t},o.prototype.max=function(){for(var e=-Infinity,t=this.rows,n=this.columns,o=0;o<t;o++)for(var i=0;i<n;i++)this[o][i]>e&&(e=this[o][i]);return e},o.prototype.maxIndex=function(){for(var e=-Infinity,t={},n=this.rows,o=this.columns,s=0;s<n;s++)for(var i=0;i<o;i++)this[s][i]>e&&(e=this[s][i],t.row=s,t.column=i);return t},o.prototype.min=function(){for(var e=Infinity,t=this.rows,n=this.columns,o=0;o<t;o++)for(var i=0;i<n;i++)this[o][i]<e&&(e=this[o][i]);return e},o.prototype.minIndex=function(){for(var e=Infinity,t={},n=this.rows,o=this.columns,s=0;s<n;s++)for(var i=0;i<o;i++)this[s][i]<e&&(e=this[s][i],t.row=s,t.column=i);return t},o.prototype.maxRow=function(e){this.checkRowIndex(e);for(var t=-Infinity,n=0,i=this.columns;n<i;n++)this[e][n]>t&&(t=this[e][n]);return t},o.prototype.maxRowIndex=function(e){this.checkRowIndex(e);for(var t=-Infinity,n={row:e},o=0,i=this.columns;o<i;o++)this[e][o]>t&&(t=this[e][o],n.column=o);return n},o.prototype.minRow=function(e){this.checkRowIndex(e);for(var t=Infinity,n=0,i=this.columns;n<i;n++)this[e][n]<t&&(t=this[e][n]);return t},o.prototype.minRowIndex=function(e){this.checkRowIndex(e);for(var t=Infinity,n={row:e,column:0},o=0,i=this.columns;o<i;o++)this[e][o]<t&&(t=this[e][o],n.column=o);return n},o.prototype.maxColumn=function(e){this.checkColumnIndex(e);for(var t=-Infinity,n=0,i=this.rows;n<i;n++)this[n][e]>t&&(t=this[n][e]);return t},o.prototype.maxColumnIndex=function(e){this.checkColumnIndex(e);for(var t=-Infinity,n={row:0,column:e},o=0,i=this.rows;o<i;o++)this[o][e]>t&&(t=this[o][e],n.row=o);return n},o.prototype.minColumn=function(e){this.checkColumnIndex(e);for(var t=Infinity,n=0,i=this.rows;n<i;n++)this[n][e]<t&&(t=this[n][e]);return t},o.prototype.minColumnIndex=function(e){this.checkColumnIndex(e);for(var t=Infinity,n={row:0,column:e},o=0,i=this.rows;o<i;o++)this[o][e]<t&&(t=this[o][e],n.row=o);return n},o.prototype.diag=function(){if(!this.isSquare())throw new TypeError("Only square matrices have a diagonal.");for(var e=Array(this.rows),t=0,i=this.rows;t<i;t++)e[t]=this[t][t];return e},o.prototype.sum=function(){for(var e=0,t=this.rows,n=this.columns,o=0;o<t;o++)for(var i=0;i<n;i++)e+=this[o][i];return e},o.prototype.mean=function(){return this.sum()/this.size},o.prototype.prod=function(){for(var e=1,t=this.rows,n=this.columns,o=0;o<t;o++)for(var i=0;i<n;i++)e*=this[o][i];return e},o.prototype.cumulativeSum=function(){for(var e=0,t=this.rows,n=this.columns,o=0;o<t;o++)for(var i=0;i<n;i++)e+=this[o][i],this[o][i]=e;return this},o.prototype.dot=function(e){if(this.size!==e.size)throw new RangeError("vectors do not have the same size");for(var t=this.to1DArray(),n=e.to1DArray(),o=0,s=t.length,r=0;r<s;r++)o+=t[r]*n[r];return o},o.prototype.mmul=function(e){if(!o.isMatrix(e))throw new TypeError("parameter \"other\" must be a matrix");this.columns!==e.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");var t=this.rows,r=this.columns,n=e.columns,l=new o(t,n),a=Array(r),p,i,d;for(i=0;i<n;i++){for(d=0;d<r;d++)a[d]=e[d][i];for(p=0;p<t;p++){var c=this[p],u=0;for(d=0;d<r;d++)u+=c[d]*a[d];l[p][i]=u}}return l},o.prototype.sortRows=function(e){for(var t=0,i=this.rows;t<i;t++)this[t].sort(e);return this},o.prototype.sortColumns=function(e){for(var t=0,i=this.columns;t<i;t++)this.setColumn(t,this.getColumn(t).sort(e));return this},o.prototype.transpose=function(){for(var e=new o(this.columns,this.rows),t=this.rows,n=this.columns,s=0;s<t;s++)for(var i=0;i<n;i++)e[i][s]=this[s][i];return e},o.prototype.subMatrix=function(e,t,n,s){if(e>t||n>s||0>e||e>=this.rows||0>t||t>=this.rows||0>n||n>=this.columns||0>s||s>=this.columns)throw new RangeError("Argument out of range");for(var r=new o(t-e+1,s-n+1),l=e;l<=t;l++)for(var i=n;i<=s;i++)r[l-e][i-n]=this[l][i];return r},o.prototype.subMatrixRow=function(e,t,n){if("undefined"==typeof t?(t=0,n=this.columns-1):"undefined"==typeof n&&(n=this.columns-1),t>n||0>t||t>=this.columns||0>n||n>=this.columns)throw new RangeError("Argument out of range.");for(var s=e.length,r=this.rows,l=new o(s,n-t+1),a=0;a<s;a++)for(var i=t;i<=n;i++){if(0>e[a]||e[a]>=r)throw new RangeError("Argument out of range.");l[a][i-t]=this[e[a]][i]}return l},o.prototype.subMatrixColumn=function(e,t,n){if("undefined"==typeof t?(t=0,n=this.rows-1):"undefined"==typeof n&&(n=this.rows-1),t>n||0>t||t>=this.rows||0>n||n>=this.rows)throw new RangeError("Argument out of range.");for(var s=e.length,r=this.columns,l=new o(n-t+1,s),a=0;a<s;a++)for(var i=t;i<=n;i++){if(0>e[a]||e[a]>=r)throw new RangeError("Argument out of range.");l[i-t][a]=this[i][e[a]]}return l},o.prototype.trace=function(){if(!this.isSquare())throw new TypeError("The matrix is not square");for(var e=0,t=0,i=this.rows;t<i;t++)e+=this[t][t];return e},o.prototype.abs=function(){for(var e=this.rows,t=this.columns,n=0;n<e;n++)for(var i=0;i<t;i++)this[n][i]=C(this[n][i])},t.exports=o},{}],94:[function(e,t){"use strict";function n(e,t){var n=t.length/3,o=e.rows,s=d.zeros(e.length,1),r,l,i,a;for(l=0;l<n;l++)for(a=f(t[l+2*n][0]/2,2),r=t[l+n][0]*a,i=0;i<o;i++)s[i][0]+=r/(f(e[i][0]-t[l][0],2)+a);return s}function i(e,t){for(var n=t[1][0]*f(t[2][0]/2,2),o=e.rows,s=new d(e.rows,e.columns),r=0;r<o;r++)s[r][0]=n/(f(e[r][0]-t[0][0],2)+f(t[2][0]/2,2));return s}function o(e,t){for(var n=t[2][0]*t[2][0]/2,o=e.rows,s=new d(e.rows,e.columns),r=0;r<o;r++)s[r][0]=t[1][0]*c(-(e[r][0]-t[0][0])*(e[r][0]-t[0][0])/n);return s}function s(e,n,o){o=o||{};var s=l(e,o.percentage||0);if(null===s||3>s[0].rows)return null;var r=s[0],t=s[1],p=s[2],c=r.rows,h=[c/u(t.dot(t))],o=Object.create(o.LMOptions||[3,100,0.001,0.001,0.001,0.01,0.01,11,9,1]),m=C(r[0][0]-r[1][0]),g=new d([[-m/1e4],[-0.001],[-m/1e4]]),f=new d([[n.x],[1],[n.width]]),y=new d([[n.x-m],[0.75],[n.width/4]]),x=new d([[n.x+m],[1.25],[4*n.width]]),b=a.optimize(i,f,r,t,h,g,y,x,[],o);return b=b.p,[b[0],[b[1][0]*p],b[2]]}function r(e,i,n){n=n||{};var s=l(e,n.percentage||0);if(null===s||3>s[0].rows)return null;var r=s[0],t=s[1],p=s[2],c=r.rows,h=[c/u(t.dot(t))],n=Object.create(n.LMOptions||[3,100,0.001,0.001,0.001,0.01,0.01,11,9,1]),m=C(r[0][0]-r[1][0]),g=new d([[-m/1e4],[-0.001],[-m/1e4]]),g=new d([[-C(r[0][0]-r[1][0])/1e3],[-0.001],[-i.width/1e3]]),f=new d([[i.x],[1],[i.width]]),y=new d([[i.x-m],[0.75],[i.width/4]]),x=new d([[i.x+m],[1.25],[4*i.width]]),b=a.optimize(o,f,r,t,h,g,y,x,[],n);return b=b.p,[b[0],[b[1][0]*p],b[2]]}function l(e,n){var o=e.length,s=null,t=null,r=0,l,a,p;if(2==o){var i=e[0].length;if(s=Array(i),t=Array(i),l=e[0],a=e[1],"number"==typeof l[0])for(p=0;p<i;p++)s[p]=l[p],t[p]=a[p],a[p]>r&&(r=a[p]);else if("object"==typeof l[0])for(p=0;p<i;p++)s[p]=l[p][0],t[p]=a[p][0],a[p][0]>r&&(r=a[p][0])}else{var i=o;for(s=Array(i),t=Array(i),p=0;p<i;p++)s[p]=e[p][0],t[p]=e[p][1],t[p]>r&&(r=t[p])}for(p=0;p<i;p++)t[p]/=r;if(n)for(p=i-1;0<=p;p--)t[p]<n&&(t.splice(p,1),s.splice(p,1));return 0<s.length?[new d([s]).transpose(),new d([t]).transpose(),r]:null}var a=e("ml-curve-fitting"),p=a.Matrix.algebra,d=e("ml-matrix");t.exports.optimizeSingleLorentzian=s,t.exports.optimizeLorentzianSum=function(e,o,s){var r=l(e);if(null===r||3>r[0].rows)return null;var c=r[0],t=r[1],u=r[2],h=c.rows,m=[h/p.sqrt(t.dot(t))],s=Object.create(s||[3,100,0.001,0.001,0.001,0.01,0.01,11,9,1]),g=o.length,f=new d(3*g,1),y=new d(3*g,1),x=new d(3*g,1),b=new d(3*g,1),_=C(c[0][0]-c[1][0]),k;for(k=0;k<g;k++)f[k][0]=o[k].x,f[k+g][0]=1,f[k+2*g][0]=o[k].width,y[k][0]=o[k].x-_,y[k+g][0]=0,y[k+2*g][0]=o[k].width/4,x[k][0]=o[k].x+_,x[k+g][0]=1.5,x[k+2*g][0]=4*o[k].width,b[k][0]=-_/1e3,b[k+g][0]=-1e-3,b[k+2*g][0]=-_/1e3;var b=-C(c[0][0]-c[1][0])/1e4,i=a.optimize(n,f,c,t,m,b,y,x,[],s);i=i.p;var j=Array(g);for(k=0;k<g;k++)j[k]=[i[k],[i[k+g][0]*u],i[k+2*g]];return j},t.exports.optimizeSingleGaussian=r,t.exports.optimizeGaussianSum=function(e,o,s){var r=l(e);if(null===r||3>r[0].rows)return null;var c=r[0],t=r[1],u=r[2],h=c.rows,m=new d(h,1),g=h/p.sqrt(t.dot(t)),f;for(f=0;f<h;f++)m[f][0]=g;var s=Object.create(s||[3,100,0.001,0.001,0.001,0.01,0.01,11,9,2]),i=o.length,y=new d(3*i,1),x=new d(3*i,1),b=new d(3*i,1),_=new d(3*i,1),k=C(c[0][0]-c[1][0]);for(f=0;f<i;f++)y[f][0]=o[f].x,y[f+i][0]=o[f].y/u,y[f+2*i][0]=o[f].width,x[f][0]=o[f].x-k,x[f+i][0]=0.8*o[f].y/u,x[f+2*i][0]=o[f].width/2,b[f][0]=o[f].x+k,b[f+i][0]=1.2*o[f].y/u,b[f+2*i][0]=2*o[f].width,_[f][0]=-k/1e3,_[f+i][0]=-1e-3,_[f+2*i][0]=-k/1e3;var j=a.optimize(n,y,c,t,m,_,x,b,[],s);j=j.p;var w=Array(i);for(f=0;f<i;f++)w[f]=[j[f],[j[f+i][0]*u],j[f+2*i]];return w},t.exports.singleGaussian=o,t.exports.singleLorentzian=i,t.exports.optimizeGaussianTrain=function(e,n,o){var s=l(e);if(null===s||3>s[0].rows)return null;for(var a=s[0],t=s[1],p=s[2],d=0,c=a.length,u=[],h=0,i,m,g,p,f;h<n.length;h++){for(i=n[h].x-4*n[h].width;a[d++]<i&&d<c;);for(i=n[h].x+4*n[h].width,m=[],g=[];a[d]<=i&&d<c;)m.push(a[d][0]),g.push(t[d][0]*p),d++;f=r([m,g],n[h],o),f?u.push({x:f[0][0],y:f[1][0],width:f[2][0],opt:!0}):u.push({x:n[h].x,y:n[h].y,width:n[h].width,opt:!1})}return u},t.exports.optimizeLorentzianTrain=function(e,n,o){var r=l(e);if(null===r||3>r[0].rows)return null;for(var a=r[0],t=r[1],p=r[2],d=0,c=a.length,u=[],h=0,i,m,g,p,f;h<n.length;h++){for(i=n[h].x-4*n[h].width;a[d++]<i&&d<c;);for(i=n[h].x+4*n[h].width,m=[],g=[];a[d]<=i&&d<c;)m.push(a[d][0]),g.push(t[d][0]*p),d++;f=s([m,g],n[h],o),f?u.push({x:f[0][0],y:f[1][0],width:f[2][0],opt:!0}):u.push({x:n[h].x,y:n[h].y,width:n[h].width,opt:!1})}return u}},{"ml-curve-fitting":84,"ml-matrix":92}],95:[function(t,i,o){"use strict";function n(e,t){return e-t}o.sum=function(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t},o.max=function(e){for(var t=-Infinity,n=e.length,o=0;o<n;o++)e[o]>t&&(t=e[o]);return t},o.min=function(e){for(var t=Infinity,n=e.length,o=0;o<n;o++)e[o]<t&&(t=e[o]);return t},o.minMax=function(e){for(var t=Infinity,n=-Infinity,o=e.length,s=0;s<o;s++)e[s]<t&&(t=e[s]),e[s]>n&&(n=e[s]);return{min:t,max:n}},o.arithmeticMean=function(e){for(var t=0,n=e.length,o=0;o<n;o++)t+=e[o];return t/n},o.mean=o.arithmeticMean,o.geometricMean=function(e){for(var t=1,n=e.length,o=0;o<n;o++)t*=e[o];return f(t,1/n)},o.logMean=function(e){for(var t=0,n=e.length,o=0;o<n;o++)t+=a(e[o]);return t/n},o.grandMean=function(e,t){for(var o=0,s=0,n=e.length,r=0;r<n;r++)o+=t[r]*e[r],s+=t[r];return o/s},o.truncatedMean=function(e,t,o){o===void 0&&(o=!1),o||(e=e.slice().sort(n));for(var s=e.length,r=p(s*t),l=0,a=r;a<s-r;a++)l+=e[a];return l/(s-2*r)},o.harmonicMean=function(e){for(var t=0,n=e.length,o=0;o<n;o++){if(0===e[o])throw new RangeError("value at index "+o+"is zero");t+=1/e[o]}return n/t},o.contraHarmonicMean=function(e){for(var t=0,n=0,o=e.length,s=0;s<o;s++)t+=e[s]*e[s],n+=e[s];if(0>n)throw new RangeError("sum of values is negative");return t/n},o.median=function(e,t){t===void 0&&(t=!1),t||(e=e.slice().sort(n));var i=e.length,o=p(i/2);return 0==i%2?0.5*(e[o-1]+e[o]):e[o]},o.variance=function(e,t){t===void 0&&(t=!0);for(var n=o.mean(e),s=0,r=e.length,l=0,i;l<r;l++)i=e[l]-n,s+=i*i;return t?s/(r-1):s/r},o.standardDeviation=function(e,t){return u(o.variance(e,t))},o.standardError=function(e){return o.standardDeviation(e)/u(e.length)},o.quartiles=function(t,i){"undefined"==typeof i&&(i=!1),i||(t=t.slice(),t.sort(n));var s=t.length/4,r=t[e(s)-1],l=o.median(t,!0),a=t[e(3*s)-1];return{q1:r,q2:l,q3:a}},o.pooledStandardDeviation=function(e,t){return u(o.pooledVariance(e,t))},o.pooledVariance=function(e,t){"undefined"==typeof t&&(t=!0);for(var n=0,s=0,r=e.length,l=0;l<r;l++){var i=e[l],a=o.variance(i);n+=(i.length-1)*a,s+=t?i.length-1:i.length}return n/s},o.mode=function(e){var t=e.length,n=Array(t),o;for(o=0;o<t;o++)n[o]=0;var i=Array(t),s=0;for(o=0;o<t;o++){var r=i.indexOf(e[o]);0<=r?n[r]++:(i[s]=e[o],n[s]=1,s++)}var l=0,a=0;for(o=0;o<s;o++)n[o]>l&&(l=n[o],a=o);return i[a]},o.covariance=function(e,t,n){"undefined"==typeof n&&(n=!0);var s=o.mean(e),r=o.mean(t);if(e.length!==t.length)throw"Vectors do not have the same dimensions";for(var a=0,p=e.length,l=0;l<p;l++){var i=e[l]-s,d=t[l]-r;a+=i*d}return n?a/(p-1):a/p},o.skewness=function(e,t){"undefined"==typeof t&&(t=!0);for(var n=o.mean(e),s=0,r=0,p=e.length,l=0,i;l<p;l++)i=e[l]-n,s+=i*i,r+=i*i*i;var d=s/p,c=r/p,h=c/f(d,3/2);if(t){var m=u(p*(p-1));return m/(p-2)*h}return h},o.kurtosis=function(e,t){"undefined"==typeof t&&(t=!0);for(var s=o.mean(e),r=e.length,n=0,l=0,a=0,i;a<r;a++)i=e[a]-s,n+=i*i,l+=i*i*i*i;var p=n/r,d=l/r;if(t){var c=n/(r-1),u=l/(c*c);return r*(r+1)/((r-1)*(r-2)*(r-3))*u-3*((r-1)*(r-1)/((r-2)*(r-3)))}return d/(p*p)-3},o.entropy=function(e,t){"undefined"==typeof t&&(t=0);for(var n=0,o=e.length,s=0;s<o;s++)n+=e[s]*a(e[s]+t);return-n},o.weightedMean=function(e,t){for(var n=0,o=e.length,s=0;s<o;s++)n+=e[s]*t[s];return n},o.weightedStandardDeviation=function(e,t){return u(o.weightedVariance(e,t))},o.weightedVariance=function(e,t){for(var n=o.weightedMean(e,t),s=0,r=e.length,l=0,a=0,p=0;p<r;p++){var i=e[p]-n,d=t[p];s+=d*(i*i),a+=d,l+=d*d}return s*(a/(a*a-l))},o.center=function(e,t){"undefined"==typeof t&&(t=!1);var n=e;t||(n=e.slice());for(var s=o.mean(n),r=n.length,l=0;l<r;l++)n[l]-=s},o.standardize=function(e,t,n){"undefined"==typeof t&&(t=o.standardDeviation(e)),"undefined"==typeof n&&(n=!1);for(var s=e.length,r=n?e:Array(s),l=0;l<s;l++)r[l]=e[l]/t;return r},o.cumulativeSum=function(e){var t=e.length,n=Array(t);n[0]=e[0];for(var o=1;o<t;o++)n[o]=n[o-1]+e[o];return n}},{}],96:[function(e,t,i){"use strict";i.array=e("./array"),i.matrix=e("./matrix")},{"./array":95,"./matrix":97}],97:[function(e,t){"use strict";function o(e,t){"undefined"==typeof t&&(t=0);var n=e.length,o=e[0].length,s,r,l,i;if(-1===t){for(s=[0],r=n*o,l=0;l<n;l++)for(i=0;i<o;i++)s[0]+=e[l][i];s[0]/=r}else if(0===t)for(s=Array(o),r=n,i=0;i<o;i++){for(s[i]=0,l=0;l<n;l++)s[i]+=e[l][i];s[i]/=r}else if(1===t)for(s=Array(n),r=o,i=0;i<n;i++){for(s[i]=0,l=0;l<o;l++)s[i]+=e[i][l];s[i]/=r}else throw new Error("Invalid dimension");return s}function n(e,t,n){for(var o=s(e,t,n),r=o.length,l=0;l<r;l++)o[l]=u(o[l]);return o}function s(e,t,n){"undefined"==typeof n&&(n=!0),t=t||o(e);var s=e.length;if(0===s)return[];for(var r=e[0].length,l=Array(r),a=0;a<r;a++){for(var p=0,d=0,c=0,u=0;u<s;u++)c=e[u][a]-t[a],p+=c,d+=c*c;l[a]=n?(d-p*p/s)/(s-1):(d-p*p/s)/s}return l}function i(e,t,n){"undefined"==typeof n&&(n=0),"undefined"==typeof t&&(0===n?t=e.length-1:1===n&&(t=e[0].length-1));var r=o(e,n),l=e.length;if(0===l)return[[]];var a=e[0].length,p,d,i,c,s;if(0===n){for(p=Array(a),d=0;d<a;d++)p[d]=Array(a);for(d=0;d<a;d++)for(i=d;i<a;i++){for(c=0,s=0;s<l;s++)c+=(e[s][i]-r[i])*(e[s][d]-r[d]);c/=t,p[d][i]=c,p[i][d]=c}}else if(1===n){for(p=Array(l),d=0;d<l;d++)p[d]=Array(l);for(d=0;d<l;d++)for(i=d;i<l;i++){for(c=0,s=0;s<a;s++)c+=(e[i][s]-r[i])*(e[d][s]-r[d]);c/=t,p[d][i]=c,p[i][d]=c}}else throw new Error("Invalid dimension");return p}function r(e,t,i){return t=t||o(e),"undefined"==typeof i&&(i=n(e,!0,t)),d(l(e,t,!1),i,!0)}function l(e,t,n){t=t||o(e);var s=e,r=e.length,l,i,a;if(!n)for(s=Array(r),l=0;l<r;l++)s[l]=Array(e[l].length);for(l=0;l<r;l++){var p=s[l];for(i=0,a=p.length;i<a;i++)p[i]=e[l][i]-t[i]}return s}function d(e,t,o){"undefined"==typeof t&&(t=n(e));var s=e,r=e.length,l,i,a;if(!o)for(s=Array(r),l=0;l<r;l++)s[l]=Array(e[l].length);for(l=0;l<r;l++){var p=s[l],d=e[l];for(i=0,a=p.length;i<a;i++)0===t[i]||isNaN(t[i])||(p[i]=d[i]/t[i])}return s}function c(e,t,n){"undefined"==typeof n&&(n=0);var o=e.length;if(0===o)return[];var s=e[0].length,r,l,i,a,p,d;if(0===n){for(r=Array(s),l=0;l<s;l++)r[l]=0;for(l=0;l<o;l++)for(d=e[l],p=t[l],a=0;a<s;a++)r[a]+=d[a]*p}else if(1===n){for(r=Array(o),l=0;l<o;l++)r[l]=0;for(a=0;a<o;a++)for(d=e[a],p=t[a],l=0;l<s;l++)r[a]+=d[l]*p}else throw new Error("Invalid dimension");var c=m.sum(t);if(0!==c)for(l=0,i=r.length;l<i;l++)r[l]/=c;return r}function h(e,t,n,o,r){r=r||0,n=n||c(e,t,r),"undefined"==typeof o&&(o=1);var l=e.length;if(0===l)return[[]];var a=e[0].length,p,d,i,u,h;if(0===r){for(p=Array(a),d=0;d<a;d++)p[d]=Array(a);for(d=0;d<a;d++)for(i=d;i<a;i++){for(h=0,u=0;u<l;u++)h+=t[u]*(e[u][i]-n[i])*(e[u][d]-n[d]);p[d][i]=h*o,p[i][d]=h*o}}else if(1===r){for(p=Array(l),d=0;d<l;d++)p[d]=Array(l);for(d=0;d<l;d++)for(i=d;i<l;i++){for(h=0,u=0;u<a;u++)h+=t[u]*(e[i][u]-n[i])*(e[d][u]-n[d]);p[d][i]=h*o,p[i][d]=h*o}}else throw new Error("Invalid dimension");return p}var m=e("./array");t.exports={entropy:function(e,t){"undefined"==typeof t&&(t=0);for(var n=0,o=e.length,s=e[0].length,r=0;r<o;r++)for(var i=0;i<s;i++)n+=e[r][i]*a(e[r][i]+t);return-n},mean:o,standardDeviation:n,variance:s,median:function(e){for(var t=e.length,n=e[0].length,o=Array(n),s=0,i;s<n;s++){i=Array(t);for(var r=0;r<t;r++)i[r]=e[r][s];i.sort();var l=i.length;o[s]=0==l%2?0.5*(i[l/2]+i[l/2-1]):i[p(l/2)]}return o},mode:function(e){var t=e.length,n=e[0].length,o=Array(n),s,i;for(s=0;s<n;s++){for(var r=Array(t),l=0;l<t;l++)r[l]=0;var a=Array(t),p=0;for(i=0;i<t;i++){var d=a.indexOf(e[i][s]);0<=d?r[d]++:(a[p]=e[i][s],r[p]=1,p++)}var c=0,u=0;for(i=0;i<p;i++)r[i]>c&&(c=r[i],u=i);o[s]=a[u]}return o},skewness:function(e,t){"undefined"==typeof t&&(t=!0);for(var s=o(e),r=e.length,n=s.length,l=Array(n),p=0;p<n;p++){for(var d=0,c=0,h=0,i;h<r;h++)i=e[h][p]-s[p],d+=i*i,c+=i*i*i;var m=d/r,y=c/r,x=y/f(m,3/2);if(t){var g=u(r*(r-1));l[p]=g/(r-2)*x}else l[p]=x}return l},kurtosis:function(e,t){"undefined"==typeof t&&(t=!0);for(var s=o(e),r=e.length,n=e[0].length,l=Array(n),a=0;a<n;a++){for(var p=0,d=0,c=0,i;c<r;c++)i=e[c][a]-s[a],p+=i*i,d+=i*i*i*i;var u=p/r,h=d/r;if(t){var m=p/(r-1),g=d/(m*m);l[a]=r*(r+1)/((r-1)*(r-2)*(r-3))*g-3*((r-1)*(r-1)/((r-2)*(r-3)))}else l[a]=h/(u*u)-3}return l},standardError:function(e){for(var t=e.length,o=n(e),s=o.length,r=Array(s),l=u(t),a=0;a<s;a++)r[a]=o[a]/l;return r},covariance:function(e,t){return i(e,void 0,t)},scatter:i,correlation:function(e){var t=o(e),s=n(e,!0,t),a=r(e,t,s),p=e.length,d=e[0].length,u=Array(d),h,i;for(h=0;h<d;h++)u[h]=Array(d);for(h=0;h<d;h++)for(i=h;i<d;i++){for(var m=0,c=0,g=a.length;c<g;c++)m+=a[c][i]*a[c][h];m/=p-1,u[h][i]=m,u[i][h]=m}return u},zScores:r,center:l,standardize:d,weightedVariance:function(e,t){var n=o(e),s=e.length;if(0===s)return[];for(var r=e[0].length,l=Array(r),p=0;p<r;p++){for(var d=0,c=0,a=0,u=0;u<s;u++){var i=e[u][p]-n[p],h=t[u];d+=h*(i*i),a+=h,c+=h*h}l[p]=d*(a/(a*a-c))}return l},weightedMean:c,weightedCovariance:function(e,t,n,o){o=o||0,n=n||c(e,t,o);for(var s=0,r=0,l=0,i=t.length;l<i;l++)s+=t[l],r+=t[l]*t[l];var a=s/(s*s-r);return h(e,t,n,a,o)},weightedScatter:h}},{"./array":95}],98:[function(e,t){"use strict";function o(e,t,n,o){for(var s=0,r=0,l=t-n;l<t+n;l++)0<=l&&l<e.length-1&&(s+=e[l+1]-e[l],r++);return f(s/r,o)}function r(e,t,i,n){var o=0;return o=0<i?(4*i-2)/(i*(2*t-i+1))*(e*r(e,t,i-1,n)+n*r(e,t,i-1,n-1))-(i-1)*(2*t+i)/(i*(2*t-i+1))*r(e,t,i-2,n):0==i&&0==n?1:0,o}function l(e,t){var i=1;if(e>=t)for(var n=e-t+1;n<=e;n++)i*=n;return i}function i(e,i,t,o,n){for(var s=0,a=0;a<=o;a++)s+=(2*a+1)*(l(2*t,a)/l(2*t+a+1,a+1))*r(e,t,a,0)*r(i,t,a,n);return s}function s(e,o,n){for(var s=Array(e),r=p(e/2),l=-r;l<=r;l++){s[l+r]=Array(e);for(var t=-r;t<=r;t++)s[l+r][t+r]=i(t,l,r,o,n)}return s}var a=e("extend"),d=e("ml-stat"),c={windowSize:9,derivative:0,polynomial:3};t.exports=function(e,t,r){if(r=a({},c,r),0==r.windowSize%2||5>r.windowSize||!n(r.windowSize))throw new RangeError("Invalid window size (should be odd and at least 5 integer number)");if(r.windowSize>e.length)throw new RangeError("Window size is higher than the data length "+r.windowSize+">"+e.length);if(0>r.derivative||!n(r.derivative))throw new RangeError("Derivative should be a positive integer");if(1>r.polynomial||!n(r.polynomial))throw new RangeError("Polynomial should be a positive integer");6<=r.polynomial&&console.warn("You should not use polynomial grade higher than 5 if you are not sure that your data arises from such a model. Possible polynomial oscillation problems");var u=r.windowSize,h=p(u/2),m=e.length,g=Array(m),y=s(u,r.polynomial,r.derivative),x=0,b=!0;"[object Array]"===Object.prototype.toString.call(t)?b=!1:x=f(t,r.derivative);for(var _=0;_<h;_++){for(var i=y[h-_-1],k=y[h+_+1],j=0,w=0,C=0;C<u;C++)j+=i[C]*e[C],w+=k[C]*e[m-u+C-1];b?(g[h-_-1]=j/x,g[m-h+_]=w/x):(x=o(t,h-_-1,h,r.derivative),g[h-_-1]=j/x,x=o(t,m-h+_,h,r.derivative),g[m-h+_]=w/x)}for(var l=y[h],_=u,v;_<m+1;_++){v=0;for(var C=0;C<u;C++)v+=l[C]*e[C+_-u];b||(x=o(t,_-h-1,h,r.derivative)),g[_-h-1]=v/x}return g}},{extend:5,"ml-stat":96}],99:[function(e,t){"use strict";function n(e){var t=u(2*e.length+0.25)-0.5,n=[],s=Array(t),l=t,a=0,i=[];for(a=t-1;0<=a;a--)s[a]=1;for(var p=-1,d=[];0<l;){if(0===d.length){for(i=Array(t),a=0;a<t;a++)i[a]=0;for(n.push(i),p=0;0==s[p];p++);}else p=d.splice(0,1);i[p]=1,s[p]=0,l--;var h=Array(t);for(a=0;a<t;a++){var m=o(p,a),c=_(p,a);h[a]=e[c*(2*t-c-1)/2+m],1==h[a]&&1==s[a]&&0==i[a]&&(d.push(a),i[a]=1)}}return n}var s={threshold:0,out:"assignment"};t.exports=function(e,t){var o=Object.assign({},s,t),r,l,i,a;if("number"==typeof e[0])r=n(e);else if("object"==typeof e[0]){for(var p=e.length,d=Array(p*(p+1)/2),c=0,l=0;l<p;l++)for(var i=l;i<p;i++)d[c++]=e[l][i]>o.threshold?1:0;r=n(d)}if("indexes"===o.out||"values"===o.out){var u=Array(r.length);for(l=0;l<r.length;l++)for(u[l]=[],i=0;i<r[l].length;i++)0!=r[l][i]&&u[l].push(i);if("values"===o.out){var h=Array(u.length);for(l=0;l<u.length;l++)for(h[l]=Array(u[l].length),i=0;i<u[l].length;i++)for(h[l][i]=Array(u[l].length),a=0;a<u[l].length;a++)h[l][i][a]=e[u[l][i]][u[l][a]];return h}return u}return r}},{}],100:[function(e,t,n){"use strict";function o(e,t){for(var n in t)e=e.replace(new RegExp("%"+n+"%","g"),t[n]);return e}var s=e("ml-hash-table");class r{constructor(e,t,n={}){if(e instanceof r){var o=e;return void this._init(o.rows,o.columns,o.elements.clone(),o.threshold)}if(Array.isArray(e)){var l=e;e=l.length,n=t||{},t=l[0].length,this._init(e,t,new s(n),n.threshold);for(var a=0;a<e;a++)for(var i=0,p;i<t;i++)p=l[a][i],this.threshold&&C(p)<this.threshold&&(p=0),0!==p&&this.elements.set(a*t+i,l[a][i])}else this._init(e,t,new s(n),n.threshold)}_init(e,t,i,n){this.rows=e,this.columns=t,this.elements=i,this.threshold=n||0}static eye(e=1,t=e){for(var n=_(e,t),o=new r(e,t,{initialCapacity:n}),s=0;s<n;s++)o.set(s,s,1);return o}clone(){return new r(this)}to2DArray(){for(var e=Array(this.rows),t=0;t<this.rows;t++){e[t]=Array(this.columns);for(var i=0;i<this.columns;i++)e[t][i]=this.get(t,i)}return e}isSquare(){return this.rows===this.columns}isSymmetric(){if(!this.isSquare())return!1;var e=!0;return this.forEachNonZero((t,i,n)=>{return this.get(i,t)===n?n:(e=!1,!1)}),e}get cardinality(){return this.elements.size}get size(){return this.rows*this.columns}get(e,t){return this.elements.get(e*this.columns+t)}set(e,t,i){return this.threshold&&C(i)<this.threshold&&(i=0),0===i?this.elements.remove(e*this.columns+t):this.elements.set(e*this.columns+t,i),this}mmul(e){this.columns!==e.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");var t=this.rows,i=e.columns,n=new r(t,i);return this.forEachNonZero((t,i,o)=>{return e.forEachNonZero((e,s,r)=>{return i===e&&n.set(t,s,n.get(t,s)+o*r),r}),o}),n}kroneckerProduct(e){var t=this.rows,i=this.columns,n=e.rows,o=e.columns,s=new r(t*n,i*o,{initialCapacity:this.cardinality*e.cardinality});return this.forEachNonZero((t,i,r)=>{return e.forEachNonZero((e,a,l)=>{return s.set(n*t+e,o*i+a,r*l),l}),r}),s}forEachNonZero(e){return this.elements.forEachPair((t,n)=>{var o=0|t/this.columns,i=t%this.columns,s=e(o,i,n);return!1!==s&&(this.threshold&&C(s)<this.threshold&&(s=0),s!==n&&(0===s?this.elements.remove(t,!0):this.elements.set(t,s)),!0)}),this.elements.maybeShrinkCapacity(),this}getNonZeros(){var e=this.cardinality,t=Array(e),n=Array(e),o=Array(e),s=0;return this.forEachNonZero((e,i,r)=>{return t[s]=e,n[s]=i,o[s]=r,s++,r}),{rows:t,columns:n,values:o}}setThreshold(e){return 0!==e&&e!==this.threshold&&(this.threshold=e,this.forEachNonZero((e,t,i)=>i)),this}}r.prototype.klass="Matrix",r.identity=r.eye,r.prototype.tensorProduct=r.prototype.kroneckerProduct,t.exports=r;var l=`
(function %name%(value) {
    if (typeof value === 'number') return this.%name%S(value);
    return this.%name%M(value);
})
`,a=`
(function %name%S(value) {
    this.forEachNonZero((i, j, v) => v %op% value);
    return this;
})
`,p=`
(function %name%M(matrix) {
    matrix.forEachNonZero((i, j, v) => {
        this.set(i, j, this.get(i, j) %op% v);
        return v;
    });
    return this;
})
`,d=`
(function %name%(matrix, value) {
    var newMatrix = new SparseMatrix(matrix);
    return newMatrix.%name%(value);
})
`,c=`
(function %name%() {
    this.forEachNonZero((i, j, v) => %method%(v));
    return this;
})
`,u=`
(function %name%(matrix) {
    var newMatrix = new SparseMatrix(matrix);
    return newMatrix.%name%();
})
`,h=[["+","add"],["-","sub","subtract"],["*","mul","multiply"],["/","div","divide"],["%","mod","modulus"],["&","and"],["|","or"],["^","xor"],["<<","leftShift"],[">>","signPropagatingRightShift"],[">>>","rightShift","zeroFillRightShift"]],m=!0,g=!1,f;try{for(var y=h[Symbol.iterator](),x,b;!(m=(x=y.next()).done);m=!0){b=x.value;for(var k=1;k<b.length;k++)r.prototype[b[k]]=eval(o(l,{name:b[k],op:b[0]})),r.prototype[b[k]+"S"]=eval(o(a,{name:b[k]+"S",op:b[0]})),r.prototype[b[k]+"M"]=eval(o(p,{name:b[k]+"M",op:b[0]})),r[b[k]]=eval(o(d,{name:b[k]}))}}catch(e){g=!0,f=e}finally{try{!m&&y.return&&y.return()}finally{if(g)throw f}}var i=[["~","not"]];["abs","acos","acosh","asin","asinh","atan","atanh","cbrt","ceil","clz32","cos","cosh","exp","expm1","floor","fround","log","log1p","log10","log2","round","sign","sin","sinh","sqrt","tan","tanh","trunc"].forEach(function(e){i.push(["Math."+e,e])});var j=!0,w=!1,v;try{for(var S=i[Symbol.iterator](),D,E;!(j=(D=S.next()).done);j=!0){E=D.value;for(var k=1;k<E.length;k++)r.prototype[E[k]]=eval(o(c,{name:E[k],method:E[0]})),r[E[k]]=eval(o(u,{name:E[k]}))}}catch(e){w=!0,v=e}finally{try{!j&&S.return&&S.return()}finally{if(w)throw v}}},{"ml-hash-table":49}],101:[function(t,i,o){"use strict";function n(e,t){return e-t}o.sum=function(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t},o.max=function(e){for(var t=e[0],n=e.length,o=1;o<n;o++)e[o]>t&&(t=e[o]);return t},o.min=function(e){for(var t=e[0],n=e.length,o=1;o<n;o++)e[o]<t&&(t=e[o]);return t},o.minMax=function(e){for(var t=e[0],n=e[0],o=e.length,s=1;s<o;s++)e[s]<t&&(t=e[s]),e[s]>n&&(n=e[s]);return{min:t,max:n}},o.arithmeticMean=function(e){for(var t=0,n=e.length,o=0;o<n;o++)t+=e[o];return t/n},o.mean=o.arithmeticMean,o.geometricMean=function(e){for(var t=1,n=e.length,o=0;o<n;o++)t*=e[o];return f(t,1/n)},o.logMean=function(e){for(var t=0,n=e.length,o=0;o<n;o++)t+=a(e[o]);return t/n},o.grandMean=function(e,t){for(var o=0,s=0,n=e.length,r=0;r<n;r++)o+=t[r]*e[r],s+=t[r];return o/s},o.truncatedMean=function(e,t,o){o===void 0&&(o=!1),o||(e=[].concat(e).sort(n));for(var s=e.length,r=p(s*t),l=0,a=r;a<s-r;a++)l+=e[a];return l/(s-2*r)},o.harmonicMean=function(e){for(var t=0,n=e.length,o=0;o<n;o++){if(0===e[o])throw new RangeError("value at index "+o+"is zero");t+=1/e[o]}return n/t},o.contraHarmonicMean=function(e){for(var t=0,n=0,o=e.length,s=0;s<o;s++)t+=e[s]*e[s],n+=e[s];if(0>n)throw new RangeError("sum of values is negative");return t/n},o.median=function(e,t){t===void 0&&(t=!1),t||(e=[].concat(e).sort(n));var i=e.length,o=p(i/2);return 0==i%2?0.5*(e[o-1]+e[o]):e[o]},o.variance=function(e,t){t===void 0&&(t=!0);for(var n=o.mean(e),s=0,r=e.length,l=0,i;l<r;l++)i=e[l]-n,s+=i*i;return t?s/(r-1):s/r},o.standardDeviation=function(e,t){return u(o.variance(e,t))},o.standardError=function(e){return o.standardDeviation(e)/u(e.length)},o.robustMeanAndStdev=function(e){var t=0,o=0,s=e.length,r=0;for(r=0;r<s;r++)t+=e[r];t/=s;var i=Array(s);for(r=0;r<s;r++)i[r]=C(e[r]-t);return i.sort(n),o=1==s%2?i[(s-1)/2]/0.6745:0.5*(i[s/2]+i[s/2-1])/0.6745,{mean:t,stdev:o}},o.quartiles=function(t,i){"undefined"==typeof i&&(i=!1),i||(t=[].concat(t).sort(n));var s=t.length/4,r=t[e(s)-1],l=o.median(t,!0),a=t[e(3*s)-1];return{q1:r,q2:l,q3:a}},o.pooledStandardDeviation=function(e,t){return u(o.pooledVariance(e,t))},o.pooledVariance=function(e,t){"undefined"==typeof t&&(t=!0);for(var n=0,s=0,r=e.length,l=0;l<r;l++){var i=e[l],a=o.variance(i);n+=(i.length-1)*a,s+=t?i.length-1:i.length}return n/s},o.mode=function(e){var t=e.length,n=Array(t),o;for(o=0;o<t;o++)n[o]=0;var i=Array(t),s=0;for(o=0;o<t;o++){var r=i.indexOf(e[o]);0<=r?n[r]++:(i[s]=e[o],n[s]=1,s++)}var l=0,a=0;for(o=0;o<s;o++)n[o]>l&&(l=n[o],a=o);return i[a]},o.covariance=function(e,t,n){"undefined"==typeof n&&(n=!0);var s=o.mean(e),r=o.mean(t);if(e.length!==t.length)throw"Vectors do not have the same dimensions";for(var a=0,p=e.length,l=0;l<p;l++){var i=e[l]-s,d=t[l]-r;a+=i*d}return n?a/(p-1):a/p},o.skewness=function(e,t){"undefined"==typeof t&&(t=!0);for(var n=o.mean(e),s=0,r=0,p=e.length,l=0,i;l<p;l++)i=e[l]-n,s+=i*i,r+=i*i*i;var d=s/p,c=r/p,h=c/f(d,3/2);if(t){var m=u(p*(p-1));return m/(p-2)*h}return h},o.kurtosis=function(e,t){"undefined"==typeof t&&(t=!0);for(var s=o.mean(e),r=e.length,n=0,l=0,a=0,i;a<r;a++)i=e[a]-s,n+=i*i,l+=i*i*i*i;var p=n/r,d=l/r;if(t){var c=n/(r-1),u=l/(c*c);return r*(r+1)/((r-1)*(r-2)*(r-3))*u-3*((r-1)*(r-1)/((r-2)*(r-3)))}return d/(p*p)-3},o.entropy=function(e,t){"undefined"==typeof t&&(t=0);for(var n=0,o=e.length,s=0;s<o;s++)n+=e[s]*a(e[s]+t);return-n},o.weightedMean=function(e,t){for(var n=0,o=e.length,s=0;s<o;s++)n+=e[s]*t[s];return n},o.weightedStandardDeviation=function(e,t){return u(o.weightedVariance(e,t))},o.weightedVariance=function(e,t){for(var n=o.weightedMean(e,t),s=0,r=e.length,l=0,a=0,p=0;p<r;p++){var i=e[p]-n,d=t[p];s+=d*(i*i),a+=d,l+=d*d}return s*(a/(a*a-l))},o.center=function(e,t){"undefined"==typeof t&&(t=!1);var n=e;t||(n=[].concat(e));for(var s=o.mean(n),r=n.length,l=0;l<r;l++)n[l]-=s},o.standardize=function(e,t,n){"undefined"==typeof t&&(t=o.standardDeviation(e)),"undefined"==typeof n&&(n=!1);for(var s=e.length,r=n?e:Array(s),l=0;l<s;l++)r[l]=e[l]/t;return r},o.cumulativeSum=function(e){var t=e.length,n=Array(t);n[0]=e[0];for(var o=1;o<t;o++)n[o]=n[o-1]+e[o];return n}},{}],102:[function(e,t,i){arguments[4][96][0].apply(i,arguments)},{"./array":101,"./matrix":103,dup:96}],103:[function(e,t,o){"use strict";function n(e,t){return e-t}var s=e("./array");o.max=function(e){for(var t=-Infinity,n=0;n<e.length;n++)for(var i=0;i<e[n].length;i++)e[n][i]>t&&(t=e[n][i]);return t},o.min=function(e){for(var t=Infinity,n=0;n<e.length;n++)for(var i=0;i<e[n].length;i++)e[n][i]<t&&(t=e[n][i]);return t},o.minMax=function(e){for(var t=Infinity,n=-Infinity,o=0;o<e.length;o++)for(var i=0;i<e[o].length;i++)e[o][i]<t&&(t=e[o][i]),e[o][i]>n&&(n=e[o][i]);return{min:t,max:n}},o.entropy=function(e,t){"undefined"==typeof t&&(t=0);for(var n=0,o=e.length,s=e[0].length,r=0;r<o;r++)for(var i=0;i<s;i++)n+=e[r][i]*a(e[r][i]+t);return-n},o.mean=function(e,t){"undefined"==typeof t&&(t=0);var n=e.length,o=e[0].length,s,r,l,i;if(-1===t){for(s=[0],r=n*o,l=0;l<n;l++)for(i=0;i<o;i++)s[0]+=e[l][i];s[0]/=r}else if(0===t)for(s=Array(o),r=n,i=0;i<o;i++){for(s[i]=0,l=0;l<n;l++)s[i]+=e[l][i];s[i]/=r}else if(1===t)for(s=Array(n),r=o,i=0;i<n;i++){for(s[i]=0,l=0;l<o;l++)s[i]+=e[i][l];s[i]/=r}else throw new Error("Invalid dimension");return s},o.sum=function(e,t){"undefined"==typeof t&&(t=0);var n=e.length,o=e[0].length,s,r,i;if(-1===t)for(s=[0],r=0;r<n;r++)for(i=0;i<o;i++)s[0]+=e[r][i];else if(0===t)for(s=Array(o),i=0;i<o;i++)for(s[i]=0,r=0;r<n;r++)s[i]+=e[r][i];else if(1===t)for(s=Array(n),i=0;i<n;i++)for(s[i]=0,r=0;r<o;r++)s[i]+=e[i][r];else throw new Error("Invalid dimension");return s},o.product=function(e,t){"undefined"==typeof t&&(t=0);var n=e.length,o=e[0].length,s,r,i;if(-1===t)for(s=[1],r=0;r<n;r++)for(i=0;i<o;i++)s[0]*=e[r][i];else if(0===t)for(s=Array(o),i=0;i<o;i++)for(s[i]=1,r=0;r<n;r++)s[i]*=e[r][i];else if(1===t)for(s=Array(n),i=0;i<n;i++)for(s[i]=1,r=0;r<o;r++)s[i]*=e[i][r];else throw new Error("Invalid dimension");return s},o.standardDeviation=function(e,t,n){for(var s=o.variance(e,t,n),r=s.length,l=0;l<r;l++)s[l]=u(s[l]);return s},o.variance=function(e,t,n){"undefined"==typeof n&&(n=!0),t=t||o.mean(e);var s=e.length;if(0===s)return[];for(var r=e[0].length,l=Array(r),a=0;a<r;a++){for(var p=0,d=0,c=0,u=0;u<s;u++)c=e[u][a]-t[a],p+=c,d+=c*c;l[a]=n?(d-p*p/s)/(s-1):(d-p*p/s)/s}return l},o.median=function(e){for(var t=e.length,o=e[0].length,s=Array(o),r=0,i;r<o;r++){i=Array(t);for(var l=0;l<t;l++)i[l]=e[l][r];i.sort(n);var a=i.length;s[r]=0==a%2?0.5*(i[a/2]+i[a/2-1]):i[p(a/2)]}return s},o.mode=function(e){var t=e.length,n=e[0].length,o=Array(n),s,i;for(s=0;s<n;s++){for(var r=Array(t),l=0;l<t;l++)r[l]=0;var a=Array(t),p=0;for(i=0;i<t;i++){var d=a.indexOf(e[i][s]);0<=d?r[d]++:(a[p]=e[i][s],r[p]=1,p++)}var c=0,u=0;for(i=0;i<p;i++)r[i]>c&&(c=r[i],u=i);o[s]=a[u]}return o},o.skewness=function(e,t){"undefined"==typeof t&&(t=!0);for(var s=o.mean(e),r=e.length,n=s.length,l=Array(n),p=0;p<n;p++){for(var d=0,c=0,h=0,i;h<r;h++)i=e[h][p]-s[p],d+=i*i,c+=i*i*i;var m=d/r,y=c/r,x=y/f(m,3/2);if(t){var g=u(r*(r-1));l[p]=g/(r-2)*x}else l[p]=x}return l},o.kurtosis=function(e,t){"undefined"==typeof t&&(t=!0);for(var s=o.mean(e),r=e.length,n=e[0].length,l=Array(n),a=0;a<n;a++){for(var p=0,d=0,c=0,i;c<r;c++)i=e[c][a]-s[a],p+=i*i,d+=i*i*i*i;var u=p/r,h=d/r;if(t){var m=p/(r-1),g=d/(m*m);l[a]=r*(r+1)/((r-1)*(r-2)*(r-3))*g-3*((r-1)*(r-1)/((r-2)*(r-3)))}else l[a]=h/(u*u)-3}return l},o.standardError=function(e){for(var t=e.length,n=o.standardDeviation(e),s=n.length,r=Array(s),l=u(t),a=0;a<s;a++)r[a]=n[a]/l;return r},o.covariance=function(e,t){return o.scatter(e,void 0,t)},o.scatter=function(e,t,n){"undefined"==typeof n&&(n=0),"undefined"==typeof t&&(0===n?t=e.length-1:1===n&&(t=e[0].length-1));var r=o.mean(e,n),l=e.length;if(0===l)return[[]];var a=e[0].length,p,d,i,c,s;if(0===n){for(p=Array(a),d=0;d<a;d++)p[d]=Array(a);for(d=0;d<a;d++)for(i=d;i<a;i++){for(c=0,s=0;s<l;s++)c+=(e[s][i]-r[i])*(e[s][d]-r[d]);c/=t,p[d][i]=c,p[i][d]=c}}else if(1===n){for(p=Array(l),d=0;d<l;d++)p[d]=Array(l);for(d=0;d<l;d++)for(i=d;i<l;i++){for(c=0,s=0;s<a;s++)c+=(e[i][s]-r[i])*(e[d][s]-r[d]);c/=t,p[d][i]=c,p[i][d]=c}}else throw new Error("Invalid dimension");return p},o.correlation=function(e){var t=o.mean(e),n=o.standardDeviation(e,!0,t),s=o.zScores(e,t,n),r=e.length,a=e[0].length,p=Array(a),d,i;for(d=0;d<a;d++)p[d]=Array(a);for(d=0;d<a;d++)for(i=d;i<a;i++){for(var u=0,c=0,h=s.length;c<h;c++)u+=s[c][i]*s[c][d];u/=r-1,p[d][i]=u,p[i][d]=u}return p},o.zScores=function(e,t,i){return t=t||o.mean(e),"undefined"==typeof i&&(i=o.standardDeviation(e,!0,t)),o.standardize(o.center(e,t,!1),i,!0)},o.center=function(e,t,n){t=t||o.mean(e);var s=e,r=e.length,l,i,a;if(!n)for(s=Array(r),l=0;l<r;l++)s[l]=Array(e[l].length);for(l=0;l<r;l++){var p=s[l];for(i=0,a=p.length;i<a;i++)p[i]=e[l][i]-t[i]}return s},o.standardize=function(e,t,n){"undefined"==typeof t&&(t=o.standardDeviation(e));var s=e,r=e.length,l,i,a;if(!n)for(s=Array(r),l=0;l<r;l++)s[l]=Array(e[l].length);for(l=0;l<r;l++){var p=s[l],d=e[l];for(i=0,a=p.length;i<a;i++)0===t[i]||isNaN(t[i])||(p[i]=d[i]/t[i])}return s},o.weightedVariance=function(e,t){var n=o.mean(e),s=e.length;if(0===s)return[];for(var r=e[0].length,l=Array(r),p=0;p<r;p++){for(var d=0,c=0,a=0,u=0;u<s;u++){var i=e[u][p]-n[p],h=t[u];d+=h*(i*i),a+=h,c+=h*h}l[p]=d*(a/(a*a-c))}return l},o.weightedMean=function(e,t,n){"undefined"==typeof n&&(n=0);var o=e.length;if(0===o)return[];var r=e[0].length,l,a,i,p,d,c;if(0===n){for(l=Array(r),a=0;a<r;a++)l[a]=0;for(a=0;a<o;a++)for(c=e[a],d=t[a],p=0;p<r;p++)l[p]+=c[p]*d}else if(1===n){for(l=Array(o),a=0;a<o;a++)l[a]=0;for(p=0;p<o;p++)for(c=e[p],d=t[p],a=0;a<r;a++)l[p]+=c[a]*d}else throw new Error("Invalid dimension");var u=s.sum(t);if(0!==u)for(a=0,i=l.length;a<i;a++)l[a]/=u;return l},o.weightedCovariance=function(e,t,n,s){s=s||0,n=n||o.weightedMean(e,t,s);for(var r=0,l=0,a=0,i=t.length;a<i;a++)r+=t[a],l+=t[a]*t[a];var p=r/(r*r-l);return o.weightedScatter(e,t,n,p,s)},o.weightedScatter=function(e,t,n,r,l){l=l||0,n=n||o.weightedMean(e,t,l),"undefined"==typeof r&&(r=1);var a=e.length;if(0===a)return[[]];var p=e[0].length,d,c,i,u,h;if(0===l){for(d=Array(p),c=0;c<p;c++)d[c]=Array(p);for(c=0;c<p;c++)for(i=c;i<p;i++){for(h=0,u=0;u<a;u++)h+=t[u]*(e[u][i]-n[i])*(e[u][c]-n[c]);d[c][i]=h*r,d[i][c]=h*r}}else if(1===l){for(d=Array(a),c=0;c<a;c++)d[c]=Array(a);for(c=0;c<a;c++)for(i=c;i<a;i++){for(h=0,u=0;u<p;u++)h+=t[u]*(e[i][u]-n[i])*(e[c][u]-n[c]);d[c][i]=h*r,d[i][c]=h*r}}else throw new Error("Invalid dimension");return d}},{"./array":101}],104:[function(e,t){"use strict";t.exports=function(e,t){e=e||0;for(var n=Array(e),o=0;o<e;o++)n[o]=t;return n}},{}],105:[function(e,t){"use strict";t.exports=function(e){return"string"==typeof e?(e=e.toLowerCase(),e.includes("zg")?"1d":e.includes("hsqct")||e.includes("invi")&&(e.includes("ml")||e.includes("di"))?"hsqctocsy":e.includes("hsqc")||e.includes("invi")?"hsqc":e.includes("hmbc")||e.includes("inv4")&&e.includes("lp")?"hmbc":e.includes("cosy")?"cosy":e.includes("jres")?"jres":e.includes("tocsy")||e.includes("mlev")||e.includes("dipsi")?"tocsy":e.includes("noesy")?"noesy":e.includes("roesy")?"roesy":e.includes("dept")?"dept":e.includes("jmod")||e.includes("apt")?"aptjmod":""):""}},{}],106:[function(e,t,i){"use strict";function n(e,t,i){i&&(e[t]=i)}var o=e("jcampconverter"),s=e("spectra-data"),r=e("./getSpectrumType"),l={computeRanges:!1},a={nH:100,realTop:!0,thresholdFactor:0.85,clean:!0,compile:!0,format:"new",integralType:"sum",optimize:!1,frequencyCluster:16};i.parseJcamp=function(e,t){t=Object.assign({},l,t),t.ranges=Object.assign({},a,t.ranges);var p=e.toString(),d=o.convert(p,{keepRecordsRegExp:/.*/,withoutXY:!0}),c={dimension:d.twoD?2:1,nucleus:[],isFid:!1,isFt:!1},u=d.info;if(n(c,"title",u.TITLE),n(c,"solvent",u[".SOLVENTNAME"]),n(c,"pulse",u[".PULSESEQUENCE"]||u[".PULPROG"]||u.$PULPROG),n(c,"experiment",r(c.pulse)),n(c,"temperature",parseFloat(u.$TE||u[".TE"])),n(c,"frequency",parseFloat(u[".OBSERVEFREQUENCY"])),n(c,"type",u.DATATYPE),c.type&&(0<=c.type.toUpperCase().indexOf("FID")?c.isFid=!0:0<=c.type.toUpperCase().indexOf("SPECTRUM")&&(c.isFt=!0)),1===c.dimension){var h=u[".OBSERVENUCLEUS"];h&&(c.nucleus=[h.replace(/[^A-Za-z0-9]/g,"")])}else{var m=u[".NUCLEUS"];m&&(c.nucleus=m.split(",").map((e)=>e.trim()))}if(0===c.nucleus.length&&(c.nucleus=i.getNucleusFrom2DExperiment(c.experiment)),u.$DATE&&(c.date=new Date(1e3*u.$DATE).toISOString()),t.computeRanges&&c.isFt&&1===c.dimension&&"1H"===c.nucleus[0]){var g=s.NMR.fromJcamp(p),f=g.getRanges(t.ranges);f.forEach(function(e){delete e._highlight,delete e.signalID,e.signal.forEach(function(e){delete e.peak})}),c.range=f}return c},i.getNucleusFrom2DExperiment=function(e){return"string"==typeof e?(e=e.toLowerCase(),e.includes("jres")?["1H"]:e.includes("hmbc")||e.includes("hsqc")?["1H","13C"]:["1H","1H"]):[]},i.getSpectrumType=r},{"./getSpectrumType":105,jcampconverter:10,"spectra-data":147}],107:[function(e,t){"use strict";var n=e("ml-matrix"),o=e("new-array"),i=e("ml-simple-clustering"),s=e("ml-hclust");class r{constructor(e,t,i){this.chemicalShifts=e,this.couplingConstants=t,this.multiplicity=i,this.nSpins=e.length,this._initConnectivity(),this._initClusters()}static fromSpinusPrediction(e){for(var t=e.split("\n"),s=t.length-1,l=Array(s),a=Array(s),p={},d=n.zeros(s,s),c=0,u;c<s;c++)u=t[c].split("\t"),l[c]=+u[2],p[u[0]-1]=c,a[c]=+u[5];for(var h=0;h<s;h++){u=t[h].split("\t");var m=(u.length-4)/3;for(y=0;y<m;y++){var g=u[4+3*y]-1,f=p[g];d[h][f]=+u[6+3*y]}}for(var y=0;y<s;y++)for(var x=y;x<s;x++)d[y][x]=d[x][y];return new r(l,d,o(s,2))}static fromPrediction(e){var t=r.ungroupAtoms(e),o=t.length,s=Array(o),l=n.zeros(o,o),a=Array(o),p={},d,i,c;for(d=0;d<o;d++)s[d]=t[d].delta,p[t[d].atomIDs[0]]=d;for(d=0;d<o;d++){for(s[d]=t[d].delta,c=t[d].j,i=0;i<c.length;i++)l[p[t[d].atomIDs[0]]][p[c[i].assignment]]=c[i].coupling,l[p[c[i].assignment]][p[t[d].atomIDs[0]]]=c[i].coupling;a[d]=t[d].integral+1}return new r(s,l,a)}static ungroupAtoms(e){var t=[];return e.forEach((e)=>{for(var n=e.atomIDs,o=0;o<n.length;o++){var i=JSON.parse(JSON.stringify(e)),s=[];i.atomIDs=[n[o]],i.integral=1;for(var r=0,l;r<i.j.length;r++){l=i.j[r].assignment;for(var a=0,p;a<l.length;a++)p=JSON.parse(JSON.stringify(i.j[r])),p.assignment=l[a],s.push(p)}i.j=s,delete i.nbAtoms,t.push(i)}}),t}_initClusters(){this.clusters=i(this.connectivity,{out:"indexes"})}_initConnectivity(){for(var e=this.couplingConstants,t=n.ones(e.length,e.length),o=0;o<e.length;o++)for(var i=o;i<e[o].length;i++)0===e[o][i]&&(t[o][i]=0,t[i][o]=0);this.connectivity=t}_calculateBetas(e,t){var o=n.zeros(e.length,e.length),s,i;for(s=0;s<e.rows;s++)for(i=s;i<e.columns;i++)0==this.chemicalShifts[s]-this.chemicalShifts[i]?s!==i&&0===e[s][i]&&(o[s][i]=1,o[i][s]=1):(o[s][i]=1-C(e[s][i]/((this.chemicalShifts[s]-this.chemicalShifts[i])*t)),o[i][s]=o[s][i]);return o}ensureClusterSize(e){var t=this._calculateBetas(this.couplingConstants,e.frequency||400),n=s.agnes(t,{isDistanceMatrix:!0}),o=[];this._splitCluster(n,o,e.maxClusterSize||8,!1);var r=this._mergeClusters(o);this.nClusters=r.length,this.clusters=Array(r.length);for(var l=0;l<this.nClusters;l++){this.clusters[l]=[];for(var a=0;a<this.nSpins;a++)0!==r[l][a]&&(0>r[l][a]?this.clusters[l].push(-(a+1)):this.clusters[l].push(a))}}_splitCluster(e,t,n,o){if(!o&&e.index.length<=n)t.push(this._getMembers(e));else{var s=!0,r=!1,l;try{for(var a=e.children[Symbol.iterator](),p,d;!(s=(p=a.next()).done);s=!0)if(d=p.value,!isNaN(d.index)||d.index.length<=n){for(var c=this._getMembers(d),u=0,h=0;h<this.nSpins;h++)if(1===c[h]){u++;for(var i=0;i<this.nSpins;i++)1===this.connectivity[h][i]&&0===c[i]&&(c[i]=-1,u++)}u<=n?t.push(c):isNaN(d.index)?this._splitCluster(d,t,n,!0):(c[d.index]=2,t.push(c))}else this._splitCluster(d,t,n,!1)}catch(e){r=!0,l=e}finally{try{!s&&a.return&&a.return()}finally{if(r)throw l}}}}_getMembers(e){for(var t=Array(this.nSpins),n=0;n<this.nSpins;n++)t[n]=0;if(!isNaN(e.index))t[1*e.index]=1;else{var i=!0,o=!1,s;try{for(var r=e.index[Symbol.iterator](),l,a;!(i=(l=r.next()).done);i=!0)a=l.value,t[1*a.index]=1}catch(e){o=!0,s=e}finally{try{!i&&r.return&&r.return()}finally{if(o)throw s}}}return t}_mergeClusters(e){var t=0,n,o,s,i,r,l,a;for(s=e.length-1;0<=s;s--){for(n=e[s],t=n.length,r=0;r<t&&-1!==n[r++];);if(r<t)for(i=e.length-1;i>=s+1;i--){for(o=e[i],r=0,l=0,a=0;r<t;)-1==n[r]*o[r]&&l++,(0!==n[r]||0!==o[r])&&a++,r++;if(0<l&&a<=this.maxClusterSize){for(r=0;r<t;)1===o[r]?n[r]=1:-1===o[r]&&1!==n[r]&&(n[r]=-1),r++;e.splice(i,1),i++}}}return e}}t.exports=r},{"ml-hclust":55,"ml-matrix":70,"ml-simple-clustering":99,"new-array":104}],108:[function(e,t,i){"use strict";i.SpinSystem=e("./SpinSystem"),i.simulate1D=e("./simulate1D"),i.simulate2D=e("./simulate2D")},{"./SpinSystem":107,"./simulate1D":110,"./simulate2D":111}],109:[function(e,t){"use strict";function i(e){for(var t=(e-1)/2,o=Array(e),s=Array(e),r=0;r<e;r++)o[r]=e-1-r-t,s[r]=u(t*(t+1)-o[r]*(o[r]+1));var i=n(s,1,e,e);for(r=0;r<e;r++)s[r]=u(t*(t+1)-o[r]*(o[r]-1));var l=n(s,-1,e,e),a=i.clone().add(l).mul(0.5),d=l.clone().mul(-1).add(i).mul(-0.5),c=n(o,0,e,e);return{x:a,y:d,z:c,m:l,p:i}}function n(e,t,s,n){for(var r=new o(s,n,{initialCapacity:20}),l=0;l<e.length;l++)0<=l-t&&l-t<s&&l<n&&r.set(l-t,l,e[l]);return r}var o=e("ml-sparse-matrix"),s=i(2);t.exports=function(e){return 2===e?s:i(e)}},{"ml-sparse-matrix":100}],110:[function(e,t){"use strict";function n(e,t,n,o,s,r,l){for(var a=0|r*(-t-o)/(s-o),p=l.length,d=0,c=0,u=a-p/2;u<a+p/2;u++)d=0|u,0<=u&&u<r&&(e[d]+=l[c]*n),c++}function i(e,t){e.forEachNonZero((e,i,n)=>{return e>i?0:C(n)<=t?0:n})}function o(e,t,o,s,r){for(var a=1,p=0;p<r.length;p++)a*=o[r[p]];for(var i=new l(a,a),d=0;d<r.length;d++){for(var c=r[d],n=u(o[c]),h=void 0,m=void 0,g=1,f=0;f<d;f++)g*=o[r[f]];h=l.eye(g),g=1;for(var y=d+1;y<r.length;y++)g*=o[r[y]];m=l.eye(g);var x=e[c],b=h.kroneckerProduct(n.z).kroneckerProduct(m);i.add(b.mul(x));for(var _=0,j;_<r.length;_++)if(j=r[_],1===s[c][j]){for(var k=u(o[j]),w=void 0,C=void 0,v=1,S=0;S<_;S++)v*=o[r[S]];w=l.eye(v),v=1;for(var D=_+1;D<r.length;D++)v*=o[r[D]];C=l.eye(v);var E=h.kroneckerProduct(n.x).kroneckerProduct(m).mmul(w.kroneckerProduct(k.x).kroneckerProduct(C));E.add(h.kroneckerProduct(n.y).kroneckerProduct(m).mul(-1).mmul(w.kroneckerProduct(k.y).kroneckerProduct(C))),E.add(h.kroneckerProduct(n.z).kroneckerProduct(m).mmul(w.kroneckerProduct(k.z).kroneckerProduct(C))),i.add(E.mul(t[c][j]/2))}}return i}function s(e,t,n){for(var o=Array(n),s=0;s<n;s++)o[s]=e+s*((t-e)/(n-1));return o}var r=e("ml-matrix"),l=e("ml-sparse-matrix"),a=e("binary-search"),p=e("num-sort").asc,d=e("new-array"),u=e("./pauli"),h=0.01;t.exports=function(e,t){var m=t.frequency||400,g=(t.from||0)*m,f=(t.to||10)*m,y=t.lineWidth||1,x=t.nbPoints||1024,k=t.maxClusterSize||10,w=t.output||"y",v=e.chemicalShifts.slice(),S,D;for(S=0;S<v.length;S++)v[S]*=m;var j=x*y/C(f-g)/2.355,E=20*j,I=0|E,H=Array(I),A=E/2;for(S=0;S<I;S++)H[S]=1e9*c(-((S-A)*(S-A))/(2*(j*j)));for(var b=new d(x,0),z=e.multiplicity,F=function(){var t=e.clusters[R];for(P=Array(t.length),S=0;S<t.length;S++)P[S]=0>t[S]?-t[S]-1:t[S];T=1,O=0;var s=[],d=[];if(t.length>k){for(M=0;0>t[M++];);for(M=t[M-1],s.push(-v[M]),S=0;S<t.length;S++)if(0>t[S])for(X=e.couplingConstants[M][P[S]]/2,N=s.length,D=0;D<N;D++)s.push(s[D]+X),s[D]-=X;for(s.sort(p),O=s.length,T=1,S=0;S<O;S++)d.push(1)}else{var c=o(v,e.couplingConstants,z,e.connectivity,P),m=c.rows,j=new r.DC.EVD(c),w=j.eigenvectorMatrix,E=j.realEigenvalues,I=new l(m,m),F=t.length;for(T=0,Y=0;Y<F;Y++){var U=u(z[P[Y]]),L=1;for(D=0;D<Y;D++)L*=z[P[D]];var V=l.eye(L);for(L=1,D=Y+1;D<F;D++)L*=z[P[D]];var A=l.eye(L),B=V.kroneckerProduct(U.m).kroneckerProduct(A);0<=t[Y]?(I.add(B.mul(t[Y]+1)),T++):I.add(B.mul(t[Y]))}var q=r.zeros(m,m);I.forEachNonZero((e,t,i)=>{if(0<i)for(var n=w[t],o=0;o<n.length;o++)0!==n[o]&&q.set(e,o,q.get(e,o)+n[o]);return i});var $=q.clone();I.forEachNonZero((e,t,i)=>{if(0>i)for(var n=w[t],o=0;o<n.length;o++)0!==n[o]&&$.set(e,o,$.get(e,o)+n[o]);return i});var Z=w.transpose();q=Z.mmul(q),q=new l(q,{threshold:h}),i(q,h),$=Z.mmul($),$=new l($,{threshold:h}),i($,h),$.forEachNonZero((e,t,i)=>{var n=q.get(e,t);n=_(C(n),C(i)),n*=n,O+=n;var o=E[e]-E[t],r=a(s,o,p);0>r?(s.splice(-1-r,0,o),d.splice(-1-r,0,n)):d[r]+=n})}var W=s.length;if(0<W){T/=O;var J=s[0],Q=d[0],G=1;for(S=1;S<W;S++)C(s[S]-J/G)<y/32?(Q+=d[S],J+=s[S],G++):(n(b,J/G,Q*T,g,f,x,H),J=s[S],Q=d[S],G=1);n(b,J/G,Q*T,g,f,x,H)}},R=0;R<e.clusters.length;R++){var P,T,O,M,N,X,Y;F()}if("xy"===w)return{x:s(t.from,t.to,x),y:b};if("y"===w)return b;throw new RangeError("wrong output option")}},{"./pauli":109,"binary-search":2,"ml-matrix":70,"ml-sparse-matrix":100,"new-array":104,"num-sort":112}],111:[function(e,i){"use strict";function n(e,t,i,n){return((e-t)*n-1)/(i-t)}function s(e,n){for(var s=4,r=o(0,t(n.x-n.widthX*s)),l=_(e[0].length-1,t(n.x+n.widthX*s)),a=o(0,t(n.y-n.widthY*s)),p=_(e.length-1,t(n.y+n.widthY*s)),d=n.widthX*n.widthX,u=n.widthY*n.widthY,h=a;h<p;h++)for(var m=r;m<l;m++){var i=f(n.x-m,2)/d+f(n.y-h,2)/u,g=1e4*n.z*c(-i);e[h][m]+=g}}var r=e("ml-matrix"),l={H:{frequency:400,lineWidth:10},C:{frequency:100,lineWidth:10}};i.exports=function(e,t){var a=e[0].fromAtomLabel,p=e[0].toLabel,d=t.frequencyX||l[a].frequency,c=t.frequencyY||l[p].frequency,u=t.lineWidthX||l[a].lineWidth,h=t.lineWidthY||l[p].lineWidth,m=e[0].fromChemicalShift,g=e[0].fromChemicalShift,f=e[0].toChemicalShift,y=e[0].toChemicalShift,x;for(x=1;x<e.length;)m=_(m,e[x].fromChemicalShift),g=o(g,e[x].fromChemicalShift),f=_(f,e[x].toChemicalShift),y=o(y,e[x].toChemicalShift),x++;null===t.firstX||isNaN(t.firstX)||(m=t.firstX),null===t.firstY||isNaN(t.firstY)||(f=t.firstY),null===t.lastX||isNaN(t.lastX)||(g=t.lastX),null===t.lastY||isNaN(t.lastY)||(y=t.lastY);var i=t.nbPointsX||512,b=t.nbPointsY||512,k=new r(b,i).fill(0);for(x=0;x<e.length;){var j={x:n(e[x].fromChemicalShift,m,g,i),y:n(e[x].toChemicalShift,f,y,b),z:e[x].fromAtoms.length+e[x].toAtoms.length,widthX:n(u/d+m,m,g,i),widthY:n(h/c+f,f,y,b)};s(k,j),x++}return k}},{"ml-matrix":70}],112:[function(e,t,i){"use strict";function n(e){if("number"!=typeof e||o(e))throw new TypeError("Expected a number")}var o=e("number-is-nan");i.asc=function(e,t){return n(e),n(t),e-t},i.desc=function(e,t){return n(e),n(t),t-e}},{"number-is-nan":113}],113:[function(e,t){"use strict";t.exports=Number.isNaN||function(e){return e!==e}},{}],114:[function(e,t){"use strict";var i=e("./lib/utils/common").assign,n=e("./lib/deflate"),o=e("./lib/inflate"),s=e("./lib/zlib/constants"),r={};i(r,n,o,s),t.exports=r},{"./lib/deflate":115,"./lib/inflate":116,"./lib/utils/common":117,"./lib/zlib/constants":120}],115:[function(e,t,i){"use strict";function n(e){if(!(this instanceof n))return new n(e);this.options=r.assign({level:g,method:y,chunkSize:16384,windowBits:15,memLevel:8,strategy:f,to:""},e||{});var t=this.options;t.raw&&0<t.windowBits?t.windowBits=-t.windowBits:t.gzip&&0<t.windowBits&&16>t.windowBits&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new p,this.strm.avail_out=0;var i=s.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(i!==u)throw new Error(a[i]);if(t.header&&s.deflateSetHeader(this.strm,t.header),t.dictionary){var o;if(o="string"==typeof t.dictionary?l.string2buf(t.dictionary):"[object ArrayBuffer]"===d.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,i=s.deflateSetDictionary(this.strm,o),i!==u)throw new Error(a[i]);this._dict_set=!0}}function o(e,t){var i=new n(t);if(i.push(e,!0),i.err)throw i.msg||a[i.err];return i.result}var s=e("./zlib/deflate"),r=e("./utils/common"),l=e("./utils/strings"),a=e("./zlib/messages"),p=e("./zlib/zstream"),d=Object.prototype.toString,c=4,u=0,h=1,m=2,g=-1,f=0,y=8;n.prototype.push=function(e,t){var i=this.strm,n=this.options.chunkSize,o,a;if(this.ended)return!1;a=t===~~t?t:!0===t?c:0,i.input="string"==typeof e?l.string2buf(e):"[object ArrayBuffer]"===d.call(e)?new Uint8Array(e):e,i.next_in=0,i.avail_in=i.input.length;do{if(0===i.avail_out&&(i.output=new r.Buf8(n),i.next_out=0,i.avail_out=n),o=s.deflate(i,a),o!==h&&o!==u)return this.onEnd(o),this.ended=!0,!1;(0===i.avail_out||0===i.avail_in&&(a===c||a===m))&&("string"===this.options.to?this.onData(l.buf2binstring(r.shrinkBuf(i.output,i.next_out))):this.onData(r.shrinkBuf(i.output,i.next_out)))}while((0<i.avail_in||0===i.avail_out)&&o!==h);return a===c?(o=s.deflateEnd(this.strm),this.onEnd(o),this.ended=!0,o===u):a!==m||(this.onEnd(u),i.avail_out=0,!0)},n.prototype.onData=function(e){this.chunks.push(e)},n.prototype.onEnd=function(e){e===u&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},i.Deflate=n,i.deflate=o,i.deflateRaw=function(e,t){return t=t||{},t.raw=!0,o(e,t)},i.gzip=function(e,t){return t=t||{},t.gzip=!0,o(e,t)}},{"./utils/common":117,"./utils/strings":118,"./zlib/deflate":122,"./zlib/messages":127,"./zlib/zstream":129}],116:[function(e,t,i){"use strict";function n(e){if(!(this instanceof n))return new n(e);this.options=r.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&0<=t.windowBits&&16>t.windowBits&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),0<=t.windowBits&&16>t.windowBits&&!(e&&e.windowBits)&&(t.windowBits+=32),15<t.windowBits&&48>t.windowBits&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;var i=s.inflateInit2(this.strm,t.windowBits);if(i!==a.Z_OK)throw new Error(p[i]);this.header=new c,s.inflateGetHeader(this.strm,this.header)}function o(e,t){var i=new n(t);if(i.push(e,!0),i.err)throw i.msg||p[i.err];return i.result}var s=e("./zlib/inflate"),r=e("./utils/common"),l=e("./utils/strings"),a=e("./zlib/constants"),p=e("./zlib/messages"),d=e("./zlib/zstream"),c=e("./zlib/gzheader"),u=Object.prototype.toString;n.prototype.push=function(e,t){var i=this.strm,n=this.options.chunkSize,o=this.options.dictionary,p=!1,d,c,h,m,g,f;if(this.ended)return!1;c=t===~~t?t:!0===t?a.Z_FINISH:a.Z_NO_FLUSH,i.input="string"==typeof e?l.binstring2buf(e):"[object ArrayBuffer]"===u.call(e)?new Uint8Array(e):e,i.next_in=0,i.avail_in=i.input.length;do{if(0===i.avail_out&&(i.output=new r.Buf8(n),i.next_out=0,i.avail_out=n),d=s.inflate(i,a.Z_NO_FLUSH),d===a.Z_NEED_DICT&&o&&(f="string"==typeof o?l.string2buf(o):"[object ArrayBuffer]"===u.call(o)?new Uint8Array(o):o,d=s.inflateSetDictionary(this.strm,f)),d===a.Z_BUF_ERROR&&!0==p&&(d=a.Z_OK,p=!1),d!==a.Z_STREAM_END&&d!==a.Z_OK)return this.onEnd(d),this.ended=!0,!1;i.next_out&&(0===i.avail_out||d===a.Z_STREAM_END||0===i.avail_in&&(c===a.Z_FINISH||c===a.Z_SYNC_FLUSH))&&("string"===this.options.to?(h=l.utf8border(i.output,i.next_out),m=i.next_out-h,g=l.buf2string(i.output,h),i.next_out=m,i.avail_out=n-m,m&&r.arraySet(i.output,i.output,h,m,0),this.onData(g)):this.onData(r.shrinkBuf(i.output,i.next_out))),0===i.avail_in&&0===i.avail_out&&(p=!0)}while((0<i.avail_in||0===i.avail_out)&&d!==a.Z_STREAM_END);return d===a.Z_STREAM_END&&(c=a.Z_FINISH),c===a.Z_FINISH?(d=s.inflateEnd(this.strm),this.onEnd(d),this.ended=!0,d===a.Z_OK):c!==a.Z_SYNC_FLUSH||(this.onEnd(a.Z_OK),i.avail_out=0,!0)},n.prototype.onData=function(e){this.chunks.push(e)},n.prototype.onEnd=function(e){e===a.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},i.Inflate=n,i.inflate=o,i.inflateRaw=function(e,t){return t=t||{},t.raw=!0,o(e,t)},i.ungzip=o},{"./utils/common":117,"./utils/strings":118,"./zlib/constants":120,"./zlib/gzheader":123,"./zlib/inflate":125,"./zlib/messages":127,"./zlib/zstream":129}],117:[function(e,t,i){"use strict";var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;i.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var i=t.shift();if(i){if("object"!=typeof i)throw new TypeError(i+"must be non-object");for(var n in i)i.hasOwnProperty(n)&&(e[n]=i[n])}}return e},i.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var o={arraySet:function(e,t,n,o,s){if(t.subarray&&e.subarray)return void e.set(t.subarray(n,n+o),s);for(var r=0;r<o;r++)e[s+r]=t[n+r]},flattenChunks:function(e){var t,i,n,o,s,r;for(n=0,t=0,i=e.length;t<i;t++)n+=e[t].length;for(r=new Uint8Array(n),o=0,(t=0,i=e.length);t<i;t++)s=e[t],r.set(s,o),o+=s.length;return r}},s={arraySet:function(e,t,n,o,s){for(var r=0;r<o;r++)e[s+r]=t[n+r]},flattenChunks:function(e){return[].concat.apply([],e)}};i.setTyped=function(e){e?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,o)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,s))},i.setTyped(n)},{}],118:[function(e,t,i){"use strict";function n(e,t){if(65537>t&&(e.subarray&&r||!e.subarray&&s))return d.apply(null,o.shrinkBuf(e,t));for(var n="",l=0;l<t;l++)n+=d(e[l]);return n}var o=e("./common"),s=!0,r=!0;try{d.apply(null,[0])}catch(e){s=!1}try{d.apply(null,new Uint8Array(1))}catch(e){r=!1}for(var l=new o.Buf8(256),a=0;256>a;a++)l[a]=252<=a?6:248<=a?5:240<=a?4:224<=a?3:192<=a?2:1;l[254]=l[254]=1,i.string2buf=function(e){var t=e.length,n=0,s,r,l,a,p;for(a=0;a<t;a++)r=e.charCodeAt(a),55296==(64512&r)&&a+1<t&&(l=e.charCodeAt(a+1),56320==(64512&l)&&(r=65536+(r-55296<<10)+(l-56320),a++)),n+=128>r?1:2048>r?2:65536>r?3:4;for(s=new o.Buf8(n),p=0,a=0;p<n;a++)r=e.charCodeAt(a),55296==(64512&r)&&a+1<t&&(l=e.charCodeAt(a+1),56320==(64512&l)&&(r=65536+(r-55296<<10)+(l-56320),a++)),128>r?s[p++]=r:2048>r?(s[p++]=192|r>>>6,s[p++]=128|63&r):65536>r?(s[p++]=224|r>>>12,s[p++]=128|63&r>>>6,s[p++]=128|63&r):(s[p++]=240|r>>>18,s[p++]=128|63&r>>>12,s[p++]=128|63&r>>>6,s[p++]=128|63&r);return s},i.buf2binstring=function(e){return n(e,e.length)},i.binstring2buf=function(e){for(var t=new o.Buf8(e.length),n=0,i=t.length;n<i;n++)t[n]=e.charCodeAt(n);return t},i.buf2string=function(e,t){var o=t||e.length,s=Array(2*o),r,i,a,p;for(i=0,r=0;r<o;){if(a=e[r++],128>a){s[i++]=a;continue}if(p=l[a],4<p){s[i++]=65533,r+=p-1;continue}for(a&=2===p?31:3===p?15:7;1<p&&r<o;)a=a<<6|63&e[r++],p--;if(1<p){s[i++]=65533;continue}65536>a?s[i++]=a:(a-=65536,s[i++]=55296|1023&a>>10,s[i++]=56320|1023&a)}return n(s,i)},i.utf8border=function(e,t){var i;for(t=t||e.length,t>e.length&&(t=e.length),i=t-1;0<=i&&128==(192&e[i]);)i--;return 0>i?t:0===i?t:i+l[e[i]]>t?i:t}},{"./common":117}],119:[function(e,t){"use strict";t.exports=function(e,t,i,o){for(var s=0|65535&e,r=0|65535&e>>>16,l=0;0!==i;){l=2e3<i?2e3:i,i-=l;do s=0|s+t[o++],r=0|r+s;while(--l);s%=65521,r%=65521}return 0|(s|r<<16)}},{}],120:[function(e,t){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],121:[function(e,t){"use strict";var n=function(){for(var e=[],t=0,i;256>t;t++){i=t;for(var n=0;8>n;n++)i=1&i?3988292384^i>>>1:i>>>1;e[t]=i}return e}();t.exports=function(e,t,o,s){e^=-1;for(var r=s;r<s+o;r++)e=e>>>8^n[255&(e^t[r])];return-1^e}},{}],122:[function(e,t,i){"use strict";function n(e,t){return e.msg=D[t],t}function o(e){return(e<<1)-(4<e?9:0)}function r(e){for(var t=e.length;0<=--t;)e[t]=0}function l(e){var t=e.state,i=t.pending;i>e.avail_out&&(i=e.avail_out);0===i||(w.arraySet(e.output,t.pending_buf,t.pending_out,i,e.next_out),e.next_out+=i,t.pending_out+=i,e.total_out+=i,e.avail_out-=i,t.pending-=i,0===t.pending&&(t.pending_out=0))}function a(e,t){C._tr_flush_block(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,l(e.strm)}function p(e,t){e.pending_buf[e.pending++]=t}function d(e,t){e.pending_buf[e.pending++]=255&t>>>8,e.pending_buf[e.pending++]=255&t}function c(e,t,i,n){var o=e.avail_in;return(o>n&&(o=n),0===o)?0:(e.avail_in-=o,w.arraySet(t,e.input,e.next_in,o,i),1===e.state.wrap?e.adler=v(e.adler,t,o,i):2===e.state.wrap&&(e.adler=S(e.adler,t,o,i)),e.next_in+=o,e.total_in+=o,o)}function u(e,t){var i=e.max_chain_length,n=e.strstart,o=e.prev_length,s=e.nice_match,r=e.strstart>e.w_size-W?e.strstart-(e.w_size-W):0,l=e.window,a=e.w_mask,p=e.prev,d=e.strstart+Z,c=l[n+o-1],u=l[n+o],h,m;e.prev_length>=e.good_match&&(i>>=2),s>e.lookahead&&(s=e.lookahead);do{if(h=t,l[h+o]!==u||l[h+o-1]!==c||l[h]!==l[n]||l[++h]!==l[n+1])continue;n+=2,h++;do;while(l[++n]===l[++h]&&l[++n]===l[++h]&&l[++n]===l[++h]&&l[++n]===l[++h]&&l[++n]===l[++h]&&l[++n]===l[++h]&&l[++n]===l[++h]&&l[++n]===l[++h]&&n<d);if(m=Z-(d-n),n=d-Z,m>o){if(e.match_start=t,o=m,m>=s)break;c=l[n+o-1],u=l[n+o]}}while((t=p[t&a])>r&&0!=--i);return o<=e.lookahead?o:e.lookahead}function h(e){var t=e.w_size,i,o,n,s,r;do{if(s=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-W)){w.arraySet(e.window,e.window,t,t,0),e.match_start-=t,e.strstart-=t,e.block_start-=t,o=e.hash_size,i=o;do n=e.head[--i],e.head[i]=n>=t?n-t:0;while(--o);o=t,i=o;do n=e.prev[--i],e.prev[i]=n>=t?n-t:0;while(--o);s+=t}if(0===e.strm.avail_in)break;if(o=c(e.strm,e.window,e.strstart+e.lookahead,s),e.lookahead+=o,e.lookahead+e.insert>=$)for(r=e.strstart-e.insert,e.ins_h=e.window[r],e.ins_h=(e.ins_h<<e.hash_shift^e.window[r+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[r+$-1])&e.hash_mask,e.prev[r&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=r,r++,e.insert--,!(e.lookahead+e.insert<$)););}while(e.lookahead<W&&0!==e.strm.avail_in)}function s(e,t){for(var i,n;;){if(e.lookahead<W){if(h(e),e.lookahead<W&&t===E)return ne;if(0===e.lookahead)break}if(i=0,e.lookahead>=$&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+$-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==i&&e.strstart-i<=e.w_size-W&&(e.match_length=u(e,i)),!(e.match_length>=$))n=C._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;else if(n=C._tr_tally(e,e.strstart-e.match_start,e.match_length-$),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=$){e.match_length--;do e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+$-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;if(n&&(a(e,!1),0===e.strm.avail_out))return ne}return e.insert=e.strstart<$-1?e.strstart:$-1,t===I?(a(e,!0),0===e.strm.avail_out?se:re):e.last_lit&&(a(e,!1),0===e.strm.avail_out)?ne:oe}function m(e,t){for(var i,n,o;;){if(e.lookahead<W){if(h(e),e.lookahead<W&&t===E)return ne;if(0===e.lookahead)break}if(i=0,e.lookahead>=$&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+$-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=$-1,0!==i&&e.prev_length<e.max_lazy_match&&e.strstart-i<=e.w_size-W&&(e.match_length=u(e,i),5>=e.match_length&&(e.strategy===T||e.match_length===$&&4096<e.strstart-e.match_start)&&(e.match_length=$-1)),e.prev_length>=$&&e.match_length<=e.prev_length){o=e.strstart+e.lookahead-$,n=C._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-$),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=o&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+$-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(0!=--e.prev_length);if(e.match_available=0,e.match_length=$-1,e.strstart++,n&&(a(e,!1),0===e.strm.avail_out))return ne}else if(!e.match_available)e.match_available=1,e.strstart++,e.lookahead--;else if(n=C._tr_tally(e,0,e.window[e.strstart-1]),n&&a(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return ne}return e.match_available&&(n=C._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<$-1?e.strstart:$-1,t===I?(a(e,!0),0===e.strm.avail_out?se:re):e.last_lit&&(a(e,!1),0===e.strm.avail_out)?ne:oe}function g(e,t){for(var i=e.window,n,o,s,r;;){if(e.lookahead<=Z){if(h(e),e.lookahead<=Z&&t===E)return ne;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=$&&0<e.strstart&&(s=e.strstart-1,o=i[s],o===i[++s]&&o===i[++s]&&o===i[++s])){r=e.strstart+Z;do;while(o===i[++s]&&o===i[++s]&&o===i[++s]&&o===i[++s]&&o===i[++s]&&o===i[++s]&&o===i[++s]&&o===i[++s]&&s<r);e.match_length=Z-(r-s),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=$?(n=C._tr_tally(e,1,e.match_length-$),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=C._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(a(e,!1),0===e.strm.avail_out))return ne}return e.insert=0,t===I?(a(e,!0),0===e.strm.avail_out?se:re):e.last_lit&&(a(e,!1),0===e.strm.avail_out)?ne:oe}function f(e,t){for(var i;;){if(0===e.lookahead&&(h(e),0===e.lookahead)){if(t===E)return ne;break}if(e.match_length=0,i=C._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,i&&(a(e,!1),0===e.strm.avail_out))return ne}return e.insert=0,t===I?(a(e,!0),0===e.strm.avail_out?se:re):e.last_lit&&(a(e,!1),0===e.strm.avail_out)?ne:oe}function y(e,t,i,n,o){this.good_length=e,this.max_lazy=t,this.nice_length=i,this.max_chain=n,this.func=o}function x(e){e.window_size=2*e.w_size,r(e.head),e.max_lazy_match=le[e.level].max_lazy,e.good_match=le[e.level].good_length,e.nice_match=le[e.level].nice_length,e.max_chain_length=le[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=$-1,e.match_available=0,e.ins_h=0}function b(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=X,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new w.Buf16(2*V),this.dyn_dtree=new w.Buf16(2*(2*U+1)),this.bl_tree=new w.Buf16(2*(2*B+1)),r(this.dyn_ltree),r(this.dyn_dtree),r(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new w.Buf16(q+1),this.heap=new w.Buf16(2*Y+1),r(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new w.Buf16(2*Y+1),r(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function _(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=N,t=e.state,t.pending=0,t.pending_out=0,0>t.wrap&&(t.wrap=-t.wrap),t.status=t.wrap?J:te,e.adler=2===t.wrap?0:1,t.last_flush=E,C._tr_init(t),A):n(e,F)}function k(e){var t=_(e);return t===A&&x(e.state),t}function j(e,t,i,o,r,l){if(!e)return F;var a=1;if(t===P&&(t=6),0>o?(a=0,o=-o):15<o&&(a=2,o-=16),1>r||r>L||i!==X||8>o||15<o||0>t||9<t||0>l||l>M)return n(e,F);8===o&&(o=9);var p=new b;return e.state=p,p.strm=e,p.wrap=a,p.gzhead=null,p.w_bits=o,p.w_size=1<<p.w_bits,p.w_mask=p.w_size-1,p.hash_bits=r+7,p.hash_size=1<<p.hash_bits,p.hash_mask=p.hash_size-1,p.hash_shift=~~((p.hash_bits+$-1)/$),p.window=new w.Buf8(2*p.w_size),p.head=new w.Buf16(p.hash_size),p.prev=new w.Buf16(p.w_size),p.lit_bufsize=1<<r+6,p.pending_buf_size=4*p.lit_bufsize,p.pending_buf=new w.Buf8(p.pending_buf_size),p.d_buf=1*p.lit_bufsize,p.l_buf=3*p.lit_bufsize,p.level=t,p.strategy=l,p.method=i,k(e)}var w=e("../utils/common"),C=e("./trees"),v=e("./adler32"),S=e("./crc32"),D=e("./messages"),E=0,I=4,H=5,A=0,z=1,F=-2,R=-5,P=-1,T=1,O=2,M=4,N=2,X=8,L=9,Y=256+1+29,U=30,B=19,V=2*Y+1,q=15,$=3,Z=258,W=Z+$+1,J=42,Q=69,G=73,K=91,ee=103,te=113,ie=666,ne=1,oe=2,se=3,re=4,le;le=[new y(0,0,0,0,function(e,t){var i=65535;for(i>e.pending_buf_size-5&&(i=e.pending_buf_size-5);;){if(1>=e.lookahead){if(h(e),0===e.lookahead&&t===E)return ne;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var n=e.block_start+i;if((0===e.strstart||e.strstart>=n)&&(e.lookahead=e.strstart-n,e.strstart=n,a(e,!1),0===e.strm.avail_out))return ne;if(e.strstart-e.block_start>=e.w_size-W&&(a(e,!1),0===e.strm.avail_out))return ne}return e.insert=0,t===I?(a(e,!0),0===e.strm.avail_out?se:re):e.strstart>e.block_start&&(a(e,!1),0===e.strm.avail_out)?ne:ne}),new y(4,4,8,4,s),new y(4,5,16,8,s),new y(4,6,32,32,s),new y(4,4,16,16,m),new y(8,16,32,32,m),new y(8,16,128,128,m),new y(8,32,128,256,m),new y(32,128,258,1024,m),new y(32,258,258,4096,m)],i.deflateInit=function(e,t){return j(e,t,X,15,8,0)},i.deflateInit2=j,i.deflateReset=k,i.deflateResetKeep=_,i.deflateSetHeader=function(e,t){return e&&e.state?2===e.state.wrap?(e.state.gzhead=t,A):F:F},i.deflate=function(e,t){var i,a,s,c;if(!e||!e.state||t>H||0>t)return e?n(e,F):F;if(a=e.state,!e.output||!e.input&&0!==e.avail_in||a.status===ie&&t!==I)return n(e,0===e.avail_out?R:F);if(a.strm=e,i=a.last_flush,a.last_flush=t,a.status===J)if(2===a.wrap)e.adler=0,p(a,31),p(a,139),p(a,8),a.gzhead?(p(a,(a.gzhead.text?1:0)+(a.gzhead.hcrc?2:0)+(a.gzhead.extra?4:0)+(a.gzhead.name?8:0)+(a.gzhead.comment?16:0)),p(a,255&a.gzhead.time),p(a,255&a.gzhead.time>>8),p(a,255&a.gzhead.time>>16),p(a,255&a.gzhead.time>>24),p(a,9===a.level?2:a.strategy>=O||2>a.level?4:0),p(a,255&a.gzhead.os),a.gzhead.extra&&a.gzhead.extra.length&&(p(a,255&a.gzhead.extra.length),p(a,255&a.gzhead.extra.length>>8)),a.gzhead.hcrc&&(e.adler=S(e.adler,a.pending_buf,a.pending,0)),a.gzindex=0,a.status=Q):(p(a,0),p(a,0),p(a,0),p(a,0),p(a,0),p(a,9===a.level?2:a.strategy>=O||2>a.level?4:0),p(a,3),a.status=te);else{var u=X+(a.w_bits-8<<4)<<8,h=-1;h=a.strategy>=O||2>a.level?0:6>a.level?1:6===a.level?2:3,u|=h<<6,0!==a.strstart&&(u|=32),u+=31-u%31,a.status=te,d(a,u),0!==a.strstart&&(d(a,e.adler>>>16),d(a,65535&e.adler)),e.adler=1}if(a.status===Q)if(a.gzhead.extra){for(s=a.pending;a.gzindex<(65535&a.gzhead.extra.length)&&!(a.pending===a.pending_buf_size&&(a.gzhead.hcrc&&a.pending>s&&(e.adler=S(e.adler,a.pending_buf,a.pending-s,s)),l(e),s=a.pending,a.pending===a.pending_buf_size));)p(a,255&a.gzhead.extra[a.gzindex]),a.gzindex++;a.gzhead.hcrc&&a.pending>s&&(e.adler=S(e.adler,a.pending_buf,a.pending-s,s)),a.gzindex===a.gzhead.extra.length&&(a.gzindex=0,a.status=G)}else a.status=G;if(a.status===G)if(a.gzhead.name){s=a.pending;do{if(a.pending===a.pending_buf_size&&(a.gzhead.hcrc&&a.pending>s&&(e.adler=S(e.adler,a.pending_buf,a.pending-s,s)),l(e),s=a.pending,a.pending===a.pending_buf_size)){c=1;break}c=a.gzindex<a.gzhead.name.length?255&a.gzhead.name.charCodeAt(a.gzindex++):0,p(a,c)}while(0!==c);a.gzhead.hcrc&&a.pending>s&&(e.adler=S(e.adler,a.pending_buf,a.pending-s,s)),0===c&&(a.gzindex=0,a.status=K)}else a.status=K;if(a.status===K)if(a.gzhead.comment){s=a.pending;do{if(a.pending===a.pending_buf_size&&(a.gzhead.hcrc&&a.pending>s&&(e.adler=S(e.adler,a.pending_buf,a.pending-s,s)),l(e),s=a.pending,a.pending===a.pending_buf_size)){c=1;break}c=a.gzindex<a.gzhead.comment.length?255&a.gzhead.comment.charCodeAt(a.gzindex++):0,p(a,c)}while(0!==c);a.gzhead.hcrc&&a.pending>s&&(e.adler=S(e.adler,a.pending_buf,a.pending-s,s)),0===c&&(a.status=ee)}else a.status=ee;if(a.status===ee&&(a.gzhead.hcrc?(a.pending+2>a.pending_buf_size&&l(e),a.pending+2<=a.pending_buf_size&&(p(a,255&e.adler),p(a,255&e.adler>>8),e.adler=0,a.status=te)):a.status=te),0!==a.pending){if(l(e),0===e.avail_out)return a.last_flush=-1,A;}else if(0===e.avail_in&&o(t)<=o(i)&&t!==I)return n(e,R);if(a.status===ie&&0!==e.avail_in)return n(e,R);if(0!==e.avail_in||0!==a.lookahead||t!==E&&a.status!==ie){var m=a.strategy===O?f(a,t):a.strategy===3?g(a,t):le[a.level].func(a,t);if((m===se||m===re)&&(a.status=ie),m===ne||m===se)return 0===e.avail_out&&(a.last_flush=-1),A;if(m===oe&&(t===1?C._tr_align(a):t!==H&&(C._tr_stored_block(a,0,0,!1),t===3&&(r(a.head),0===a.lookahead&&(a.strstart=0,a.block_start=0,a.insert=0))),l(e),0===e.avail_out))return a.last_flush=-1,A}return t===I?0>=a.wrap?z:(2===a.wrap?(p(a,255&e.adler),p(a,255&e.adler>>8),p(a,255&e.adler>>16),p(a,255&e.adler>>24),p(a,255&e.total_in),p(a,255&e.total_in>>8),p(a,255&e.total_in>>16),p(a,255&e.total_in>>24)):(d(a,e.adler>>>16),d(a,65535&e.adler)),l(e),0<a.wrap&&(a.wrap=-a.wrap),0===a.pending?z:A):A},i.deflateEnd=function(e){var t;return e&&e.state?(t=e.state.status,t!==J&&t!==Q&&t!==G&&t!==K&&t!==ee&&t!==te&&t!==ie)?n(e,F):(e.state=null,t===te?n(e,-3):A):F},i.deflateSetDictionary=function(e,t){var i=t.length,o,s,l,n,a,p,d,c;if(!e||!e.state)return F;if(o=e.state,n=o.wrap,2===n||1===n&&o.status!==J||o.lookahead)return F;for(1===n&&(e.adler=v(e.adler,t,i,0)),o.wrap=0,i>=o.w_size&&(0===n&&(r(o.head),o.strstart=0,o.block_start=0,o.insert=0),c=new w.Buf8(o.w_size),w.arraySet(c,t,i-o.w_size,o.w_size,0),t=c,i=o.w_size),a=e.avail_in,p=e.next_in,d=e.input,e.avail_in=i,e.next_in=0,e.input=t,h(o);o.lookahead>=$;){s=o.strstart,l=o.lookahead-($-1);do o.ins_h=(o.ins_h<<o.hash_shift^o.window[s+$-1])&o.hash_mask,o.prev[s&o.w_mask]=o.head[o.ins_h],o.head[o.ins_h]=s,s++;while(--l);o.strstart=s,o.lookahead=$-1,h(o)}return o.strstart+=o.lookahead,o.block_start=o.strstart,o.insert=o.lookahead,o.lookahead=0,o.match_length=o.prev_length=$-1,o.match_available=0,e.next_in=p,e.input=d,e.avail_in=a,o.wrap=n,A},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":117,"./adler32":119,"./crc32":121,"./messages":127,"./trees":128}],123:[function(e,t){"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],124:[function(e,t){"use strict";var i=30;t.exports=function(e,t){var n,o,s,r,l,a,p,d,c,u,h,m,g,f,y,x,b,_,k,j,w,C,v,S,D;n=e.state,o=e.next_in,S=e.input,s=o+(e.avail_in-5),r=e.next_out,D=e.output,l=r-(t-e.avail_out),a=r+(e.avail_out-257),p=n.dmax,d=n.wsize,c=n.whave,u=n.wnext,h=n.window,m=n.hold,g=n.bits,f=n.lencode,y=n.distcode,x=(1<<n.lenbits)-1,b=(1<<n.distbits)-1;top:do{15>g&&(m+=S[o++]<<g,g+=8,m+=S[o++]<<g,g+=8),_=f[m&x];dolen:for(;;){if(k=_>>>24,m>>>=k,g-=k,k=255&_>>>16,0===k)D[r++]=65535&_;else if(16&k){j=65535&_,k&=15,k&&(g<k&&(m+=S[o++]<<g,g+=8),j+=m&(1<<k)-1,m>>>=k,g-=k),15>g&&(m+=S[o++]<<g,g+=8,m+=S[o++]<<g,g+=8),_=y[m&b];dodist:for(;;){if(k=_>>>24,m>>>=k,g-=k,k=255&_>>>16,16&k){if(w=65535&_,k&=15,g<k&&(m+=S[o++]<<g,g+=8,g<k&&(m+=S[o++]<<g,g+=8)),w+=m&(1<<k)-1,w>p){e.msg="invalid distance too far back",n.mode=i;break top}if(m>>>=k,g-=k,k=r-l,w>k){if(k=w-k,k>c&&n.sane){e.msg="invalid distance too far back",n.mode=i;break top}if(C=0,v=h,0===u){if(C+=d-k,k<j){j-=k;do D[r++]=h[C++];while(--k);C=r-w,v=D}}else if(u<k){if(C+=d+u-k,k-=u,k<j){j-=k;do D[r++]=h[C++];while(--k);if(C=0,u<j){k=u,j-=k;do D[r++]=h[C++];while(--k);C=r-w,v=D}}}else if(C+=u-k,k<j){j-=k;do D[r++]=h[C++];while(--k);C=r-w,v=D}for(;2<j;)D[r++]=v[C++],D[r++]=v[C++],D[r++]=v[C++],j-=3;j&&(D[r++]=v[C++],1<j&&(D[r++]=v[C++]))}else{C=r-w;do D[r++]=D[C++],D[r++]=D[C++],D[r++]=D[C++],j-=3;while(2<j);j&&(D[r++]=D[C++],1<j&&(D[r++]=D[C++]))}}else if(0==(64&k)){_=y[(65535&_)+(m&(1<<k)-1)];continue dodist}else{e.msg="invalid distance code",n.mode=i;break top}break}}else if(0==(64&k)){_=f[(65535&_)+(m&(1<<k)-1)];continue dolen}else if(32&k){n.mode=12;break top}else{e.msg="invalid literal/length code",n.mode=i;break top}break}}while(o<s&&r<a);return j=g>>3,o-=j,g-=j<<3,m&=(1<<g)-1,e.next_in=o,e.next_out=r,e.avail_in=o<s?5+(s-o):5-(o-s),e.avail_out=r<a?257+(a-r):257-(r-a),n.hold=m,void(n.bits=g)}},{}],125:[function(e,t,i){"use strict";function o(e){return(255&e>>>24)+(65280&e>>>8)+((65280&e)<<8)+((255&e)<<24)}function n(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new u.Buf16(320),this.work=new u.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function s(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=S,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new u.Buf32(ne),t.distcode=t.distdyn=new u.Buf32(oe),t.sane=1,t.back=-1,k):j}function r(e){var t;return e&&e.state?(t=e.state,t.wsize=0,t.whave=0,t.wnext=0,s(e)):j}function l(e,t){var i,n;return e&&e.state?(n=e.state,0>t?(i=0,t=-t):(i=(t>>4)+1,48>t&&(t&=15)),t&&(8>t||15<t))?j:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=i,n.wbits=t,r(e)):j}function a(e,t){var i,o;return e?(o=new n,e.state=o,o.window=null,i=l(e,t),i!==k&&(e.state=null),i):j}function p(e){if(se){var t;for(re=new u.Buf32(512),le=new u.Buf32(32),t=0;144>t;)e.lens[t++]=8;for(;256>t;)e.lens[t++]=9;for(;280>t;)e.lens[t++]=7;for(;288>t;)e.lens[t++]=8;for(f(y,e.lens,0,288,re,0,e.work,{bits:9}),t=0;32>t;)e.lens[t++]=5;f(x,e.lens,0,32,le,0,e.work,{bits:5}),se=!1}e.lencode=re,e.lenbits=9,e.distcode=le,e.distbits=5}function c(e,t,i,n){var o=e.state,s;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new u.Buf8(o.wsize)),n>=o.wsize?(u.arraySet(o.window,t,i-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):(s=o.wsize-o.wnext,s>n&&(s=n),u.arraySet(o.window,t,i-n,s,o.wnext),n-=s,n?(u.arraySet(o.window,t,i-n,n,0),o.wnext=n,o.whave=o.wsize):(o.wnext+=s,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=s))),0}var u=e("../utils/common"),h=e("./adler32"),m=e("./crc32"),g=e("./inffast"),f=e("./inftrees"),y=1,x=2,b=4,_=6,k=0,j=-2,w=-3,C=-4,v=8,S=1,D=2,E=3,I=4,H=5,A=6,z=7,F=8,R=9,P=10,T=11,O=12,M=13,N=14,X=15,L=16,Y=17,U=18,B=19,V=20,q=21,$=22,Z=23,W=24,J=25,Q=26,G=27,K=28,ee=29,te=30,ie=31,ne=852,oe=592,se=!0,re,le;i.inflateReset=r,i.inflateReset2=l,i.inflateResetKeep=s,i.inflateInit=function(e){return a(e,15)},i.inflateInit2=a,i.inflate=function(e,t){var i=0,s=new u.Buf8(4),r=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],l,a,ne,oe,se,re,le,ae,pe,de,ce,ue,he,me,ge,fe,ye,xe,be,_e,ke,je,we,Ce;if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return j;l=e.state,l.mode===O&&(l.mode=M),se=e.next_out,ne=e.output,le=e.avail_out,oe=e.next_in,a=e.input,re=e.avail_in,ae=l.hold,pe=l.bits,de=re,ce=le,je=k;inf_leave:for(;;)switch(l.mode){case S:if(0===l.wrap){l.mode=M;break}for(;16>pe;){if(0===re)break inf_leave;re--,ae+=a[oe++]<<pe,pe+=8}if(2&l.wrap&&35615===ae){l.check=0,s[0]=255&ae,s[1]=255&ae>>>8,l.check=m(l.check,s,2,0),ae=0,pe=0,l.mode=D;break}if(l.flags=0,l.head&&(l.head.done=!1),!(1&l.wrap)||(((255&ae)<<8)+(ae>>8))%31){e.msg="incorrect header check",l.mode=te;break}if((15&ae)!=v){e.msg="unknown compression method",l.mode=te;break}if(ae>>>=4,pe-=4,ke=(15&ae)+8,0===l.wbits)l.wbits=ke;else if(ke>l.wbits){e.msg="invalid window size",l.mode=te;break}l.dmax=1<<ke,e.adler=l.check=1,l.mode=512&ae?P:O,ae=0,pe=0;break;case D:for(;16>pe;){if(0===re)break inf_leave;re--,ae+=a[oe++]<<pe,pe+=8}if(l.flags=ae,(255&l.flags)!=v){e.msg="unknown compression method",l.mode=te;break}if(57344&l.flags){e.msg="unknown header flags set",l.mode=te;break}l.head&&(l.head.text=1&ae>>8),512&l.flags&&(s[0]=255&ae,s[1]=255&ae>>>8,l.check=m(l.check,s,2,0)),ae=0,pe=0,l.mode=E;case E:for(;32>pe;){if(0===re)break inf_leave;re--,ae+=a[oe++]<<pe,pe+=8}l.head&&(l.head.time=ae),512&l.flags&&(s[0]=255&ae,s[1]=255&ae>>>8,s[2]=255&ae>>>16,s[3]=255&ae>>>24,l.check=m(l.check,s,4,0)),ae=0,pe=0,l.mode=I;case I:for(;16>pe;){if(0===re)break inf_leave;re--,ae+=a[oe++]<<pe,pe+=8}l.head&&(l.head.xflags=255&ae,l.head.os=ae>>8),512&l.flags&&(s[0]=255&ae,s[1]=255&ae>>>8,l.check=m(l.check,s,2,0)),ae=0,pe=0,l.mode=H;case H:if(1024&l.flags){for(;16>pe;){if(0===re)break inf_leave;re--,ae+=a[oe++]<<pe,pe+=8}l.length=ae,l.head&&(l.head.extra_len=ae),512&l.flags&&(s[0]=255&ae,s[1]=255&ae>>>8,l.check=m(l.check,s,2,0)),ae=0,pe=0}else l.head&&(l.head.extra=null);l.mode=A;case A:if(1024&l.flags&&(ue=l.length,ue>re&&(ue=re),ue&&(l.head&&(ke=l.head.extra_len-l.length,!l.head.extra&&(l.head.extra=Array(l.head.extra_len)),u.arraySet(l.head.extra,a,oe,ue,ke)),512&l.flags&&(l.check=m(l.check,a,ue,oe)),re-=ue,oe+=ue,l.length-=ue),l.length))break inf_leave;l.length=0,l.mode=z;case z:if(2048&l.flags){if(0===re)break inf_leave;ue=0;do ke=a[oe+ue++],l.head&&ke&&65536>l.length&&(l.head.name+=d(ke));while(ke&&ue<re);if(512&l.flags&&(l.check=m(l.check,a,ue,oe)),re-=ue,oe+=ue,ke)break inf_leave}else l.head&&(l.head.name=null);l.length=0,l.mode=F;case F:if(4096&l.flags){if(0===re)break inf_leave;ue=0;do ke=a[oe+ue++],l.head&&ke&&65536>l.length&&(l.head.comment+=d(ke));while(ke&&ue<re);if(512&l.flags&&(l.check=m(l.check,a,ue,oe)),re-=ue,oe+=ue,ke)break inf_leave}else l.head&&(l.head.comment=null);l.mode=R;case R:if(512&l.flags){for(;16>pe;){if(0===re)break inf_leave;re--,ae+=a[oe++]<<pe,pe+=8}if(ae!==(65535&l.check)){e.msg="header crc mismatch",l.mode=te;break}ae=0,pe=0}l.head&&(l.head.hcrc=1&l.flags>>9,l.head.done=!0),e.adler=l.check=0,l.mode=O;break;case P:for(;32>pe;){if(0===re)break inf_leave;re--,ae+=a[oe++]<<pe,pe+=8}e.adler=l.check=o(ae),ae=0,pe=0,l.mode=T;case T:if(0===l.havedict)return e.next_out=se,e.avail_out=le,e.next_in=oe,e.avail_in=re,l.hold=ae,l.bits=pe,2;e.adler=l.check=1,l.mode=O;case O:if(t===5||t===_)break inf_leave;case M:if(l.last){ae>>>=7&pe,pe-=7&pe,l.mode=G;break}for(;3>pe;){if(0===re)break inf_leave;re--,ae+=a[oe++]<<pe,pe+=8}switch(l.last=1&ae,ae>>>=1,pe-=1,3&ae){case 0:l.mode=N;break;case 1:if(p(l),l.mode=V,t===_){ae>>>=2,pe-=2;break inf_leave}break;case 2:l.mode=Y;break;case 3:e.msg="invalid block type",l.mode=te;}ae>>>=2,pe-=2;break;case N:for(ae>>>=7&pe,pe-=7&pe;32>pe;){if(0===re)break inf_leave;re--,ae+=a[oe++]<<pe,pe+=8}if((65535&ae)!=(65535^ae>>>16)){e.msg="invalid stored block lengths",l.mode=te;break}if(l.length=65535&ae,ae=0,pe=0,l.mode=X,t===_)break inf_leave;case X:l.mode=L;case L:if(ue=l.length,ue){if(ue>re&&(ue=re),ue>le&&(ue=le),0===ue)break inf_leave;u.arraySet(ne,a,oe,ue,se),re-=ue,oe+=ue,le-=ue,se+=ue,l.length-=ue;break}l.mode=O;break;case Y:for(;14>pe;){if(0===re)break inf_leave;re--,ae+=a[oe++]<<pe,pe+=8}if(l.nlen=(31&ae)+257,ae>>>=5,pe-=5,l.ndist=(31&ae)+1,ae>>>=5,pe-=5,l.ncode=(15&ae)+4,ae>>>=4,pe-=4,286<l.nlen||30<l.ndist){e.msg="too many length or distance symbols",l.mode=te;break}l.have=0,l.mode=U;case U:for(;l.have<l.ncode;){for(;3>pe;){if(0===re)break inf_leave;re--,ae+=a[oe++]<<pe,pe+=8}l.lens[r[l.have++]]=7&ae,ae>>>=3,pe-=3}for(;19>l.have;)l.lens[r[l.have++]]=0;if(l.lencode=l.lendyn,l.lenbits=7,we={bits:l.lenbits},je=f(0,l.lens,0,19,l.lencode,0,l.work,we),l.lenbits=we.bits,je){e.msg="invalid code lengths set",l.mode=te;break}l.have=0,l.mode=B;case B:for(;l.have<l.nlen+l.ndist;){for(;;){if(i=l.lencode[ae&(1<<l.lenbits)-1],ge=i>>>24,fe=255&i>>>16,ye=65535&i,ge<=pe)break;if(0===re)break inf_leave;re--,ae+=a[oe++]<<pe,pe+=8}if(16>ye)ae>>>=ge,pe-=ge,l.lens[l.have++]=ye;else{if(16===ye){for(Ce=ge+2;pe<Ce;){if(0===re)break inf_leave;re--,ae+=a[oe++]<<pe,pe+=8}if(ae>>>=ge,pe-=ge,0===l.have){e.msg="invalid bit length repeat",l.mode=te;break}ke=l.lens[l.have-1],ue=3+(3&ae),ae>>>=2,pe-=2}else if(17===ye){for(Ce=ge+3;pe<Ce;){if(0===re)break inf_leave;re--,ae+=a[oe++]<<pe,pe+=8}ae>>>=ge,pe-=ge,ke=0,ue=3+(7&ae),ae>>>=3,pe-=3}else{for(Ce=ge+7;pe<Ce;){if(0===re)break inf_leave;re--,ae+=a[oe++]<<pe,pe+=8}ae>>>=ge,pe-=ge,ke=0,ue=11+(127&ae),ae>>>=7,pe-=7}if(l.have+ue>l.nlen+l.ndist){e.msg="invalid bit length repeat",l.mode=te;break}for(;ue--;)l.lens[l.have++]=ke}}if(l.mode===te)break;if(0===l.lens[256]){e.msg="invalid code -- missing end-of-block",l.mode=te;break}if(l.lenbits=9,we={bits:l.lenbits},je=f(y,l.lens,0,l.nlen,l.lencode,0,l.work,we),l.lenbits=we.bits,je){e.msg="invalid literal/lengths set",l.mode=te;break}if(l.distbits=6,l.distcode=l.distdyn,we={bits:l.distbits},je=f(x,l.lens,l.nlen,l.ndist,l.distcode,0,l.work,we),l.distbits=we.bits,je){e.msg="invalid distances set",l.mode=te;break}if(l.mode=V,t===_)break inf_leave;case V:l.mode=q;case q:if(6<=re&&258<=le){e.next_out=se,e.avail_out=le,e.next_in=oe,e.avail_in=re,l.hold=ae,l.bits=pe,g(e,ce),se=e.next_out,ne=e.output,le=e.avail_out,oe=e.next_in,a=e.input,re=e.avail_in,ae=l.hold,pe=l.bits,l.mode===O&&(l.back=-1);break}for(l.back=0;;){if(i=l.lencode[ae&(1<<l.lenbits)-1],ge=i>>>24,fe=255&i>>>16,ye=65535&i,ge<=pe)break;if(0===re)break inf_leave;re--,ae+=a[oe++]<<pe,pe+=8}if(fe&&0==(240&fe)){for(xe=ge,be=fe,_e=ye;;){if(i=l.lencode[_e+((ae&(1<<xe+be)-1)>>xe)],ge=i>>>24,fe=255&i>>>16,ye=65535&i,xe+ge<=pe)break;if(0===re)break inf_leave;re--,ae+=a[oe++]<<pe,pe+=8}ae>>>=xe,pe-=xe,l.back+=xe}if(ae>>>=ge,pe-=ge,l.back+=ge,l.length=ye,0===fe){l.mode=Q;break}if(32&fe){l.back=-1,l.mode=O;break}if(64&fe){e.msg="invalid literal/length code",l.mode=te;break}l.extra=15&fe,l.mode=$;case $:if(l.extra){for(Ce=l.extra;pe<Ce;){if(0===re)break inf_leave;re--,ae+=a[oe++]<<pe,pe+=8}l.length+=ae&(1<<l.extra)-1,ae>>>=l.extra,pe-=l.extra,l.back+=l.extra}l.was=l.length,l.mode=Z;case Z:for(;;){if(i=l.distcode[ae&(1<<l.distbits)-1],ge=i>>>24,fe=255&i>>>16,ye=65535&i,ge<=pe)break;if(0===re)break inf_leave;re--,ae+=a[oe++]<<pe,pe+=8}if(0==(240&fe)){for(xe=ge,be=fe,_e=ye;;){if(i=l.distcode[_e+((ae&(1<<xe+be)-1)>>xe)],ge=i>>>24,fe=255&i>>>16,ye=65535&i,xe+ge<=pe)break;if(0===re)break inf_leave;re--,ae+=a[oe++]<<pe,pe+=8}ae>>>=xe,pe-=xe,l.back+=xe}if(ae>>>=ge,pe-=ge,l.back+=ge,64&fe){e.msg="invalid distance code",l.mode=te;break}l.offset=ye,l.extra=15&fe,l.mode=W;case W:if(l.extra){for(Ce=l.extra;pe<Ce;){if(0===re)break inf_leave;re--,ae+=a[oe++]<<pe,pe+=8}l.offset+=ae&(1<<l.extra)-1,ae>>>=l.extra,pe-=l.extra,l.back+=l.extra}if(l.offset>l.dmax){e.msg="invalid distance too far back",l.mode=te;break}l.mode=J;case J:if(0===le)break inf_leave;if(ue=ce-le,l.offset>ue){if(ue=l.offset-ue,ue>l.whave&&l.sane){e.msg="invalid distance too far back",l.mode=te;break}ue>l.wnext?(ue-=l.wnext,he=l.wsize-ue):he=l.wnext-ue,ue>l.length&&(ue=l.length),me=l.window}else me=ne,he=se-l.offset,ue=l.length;ue>le&&(ue=le),le-=ue,l.length-=ue;do ne[se++]=me[he++];while(--ue);0===l.length&&(l.mode=q);break;case Q:if(0===le)break inf_leave;ne[se++]=l.length,le--,l.mode=q;break;case G:if(l.wrap){for(;32>pe;){if(0===re)break inf_leave;re--,ae|=a[oe++]<<pe,pe+=8}if(ce-=le,e.total_out+=ce,l.total+=ce,ce&&(e.adler=l.check=l.flags?m(l.check,ne,ce,se-ce):h(l.check,ne,ce,se-ce)),ce=le,(l.flags?ae:o(ae))!==l.check){e.msg="incorrect data check",l.mode=te;break}ae=0,pe=0}l.mode=K;case K:if(l.wrap&&l.flags){for(;32>pe;){if(0===re)break inf_leave;re--,ae+=a[oe++]<<pe,pe+=8}if(ae!==(4294967295&l.total)){e.msg="incorrect length check",l.mode=te;break}ae=0,pe=0}l.mode=ee;case ee:je=1;break inf_leave;case te:je=w;break inf_leave;case ie:return C;case 32:default:return j;}return(e.next_out=se,e.avail_out=le,e.next_in=oe,e.avail_in=re,l.hold=ae,l.bits=pe,(l.wsize||ce!==e.avail_out&&l.mode<te&&(l.mode<G||t!==b))&&c(e,e.output,e.next_out,ce-e.avail_out))?(l.mode=ie,C):(de-=e.avail_in,ce-=e.avail_out,e.total_in+=de,e.total_out+=ce,l.total+=ce,l.wrap&&ce&&(e.adler=l.check=l.flags?m(l.check,ne,ce,e.next_out-ce):h(l.check,ne,ce,e.next_out-ce)),e.data_type=l.bits+(l.last?64:0)+(l.mode===O?128:0)+(l.mode===V||l.mode===X?256:0),(0===de&&0===ce||t===b)&&je===k&&(je=-5),je)},i.inflateEnd=function(e){if(!e||!e.state)return j;var t=e.state;return t.window&&(t.window=null),e.state=null,k},i.inflateGetHeader=function(e,t){var i;return e&&e.state?(i=e.state,0==(2&i.wrap))?j:(i.head=t,t.done=!1,k):j},i.inflateSetDictionary=function(e,t){var i=t.length,n,o,s;return e&&e.state?(n=e.state,0!==n.wrap&&n.mode!==T)?j:n.mode===T&&(o=1,o=h(o,t,i,0),o!==n.check)?w:(s=c(e,t,i,i),s)?(n.mode=ie,C):(n.havedict=1,k):j},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":117,"./adler32":119,"./crc32":121,"./inffast":124,"./inftrees":126}],126:[function(e,t){"use strict";var i=e("../utils/common"),n=15,o=852,s=592,r=0,l=1,a=2,p=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],d=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],c=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],u=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,h,m,g,f,y,x){var b=x.bits,_=0,k=0,j=0,w=0,C=0,v=0,S=0,D=0,E=0,I=0,H=null,A=0,z=new i.Buf16(n+1),F=new i.Buf16(n+1),R=null,P=0,T,O,M,N,X,L,Y,U,B;for(_=0;_<=n;_++)z[_]=0;for(k=0;k<m;k++)z[t[h+k]]++;for(C=b,w=n;1<=w&&0===z[w];w--);if(C>w&&(C=w),0==w)return g[f++]=20971520,g[f++]=20971520,x.bits=1,0;for(j=1;j<w&&0===z[j];j++);for(C<j&&(C=j),D=1,_=1;_<=n;_++)if(D<<=1,D-=z[_],0>D)return-1;if(0<D&&(e===r||1!=w))return-1;for(F[1]=0,_=1;_<n;_++)F[_+1]=F[_]+z[_];for(k=0;k<m;k++)0!==t[h+k]&&(y[F[t[h+k]]++]=k);if(e===r?(H=R=y,L=19):e===l?(H=p,A-=257,R=d,P-=257,L=256):(H=c,R=u,L=-1),I=0,k=0,_=j,X=f,v=C,S=0,M=-1,E=1<<C,N=E-1,e===l&&E>o||e===a&&E>s)return 1;for(;;){Y=_-S,y[k]<L?(U=0,B=y[k]):y[k]>L?(U=R[P+y[k]],B=H[A+y[k]]):(U=96,B=0),T=1<<_-S,O=1<<v,j=O;do O-=T,g[X+(I>>S)+O]=0|(Y<<24|U<<16|B);while(0!==O);for(T=1<<_-1;I&T;)T>>=1;if(0===T?I=0:(I&=T-1,I+=T),k++,0==--z[_]){if(_==w)break;_=t[h+y[k]]}if(_>C&&(I&N)!==M){for(0==S&&(S=C),X+=j,v=_-S,D=1<<v;v+S<w&&(D-=z[v+S],!(0>=D));)v++,D<<=1;if(E+=1<<v,e===l&&E>o||e===a&&E>s)return 1;M=I&N,g[M]=0|(C<<24|v<<16|X-f)}}return 0!==I&&(g[X+I]=0|(4194304|_-S<<24)),x.bits=C,0}},{"../utils/common":117}],127:[function(e,t){"use strict";t.exports={0:"",1:"stream end",2:"need dictionary","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],128:[function(e,t,i){"use strict";function n(e){for(var t=e.length;0<=--t;)e[t]=0}function o(e,t,i,n,o){this.static_tree=e,this.extra_bits=t,this.extra_base=i,this.elems=n,this.max_length=o,this.has_stree=e&&e.length}function r(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function l(e){return 256>e?G[e]:G[256+(e>>>7)]}function a(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=255&t>>>8}function p(e,t,i){e.bi_valid>X-i?(e.bi_buf|=65535&t<<e.bi_valid,a(e,e.bi_buf),e.bi_buf=t>>X-e.bi_valid,e.bi_valid+=i-X):(e.bi_buf|=65535&t<<e.bi_valid,e.bi_valid+=i)}function d(e,t,i){p(e,i[2*t],i[2*t+1])}function s(e,t){var i=0;do i|=1&e,e>>>=1,i<<=1;while(0<--t);return i>>>1}function c(e){16===e.bi_valid?(a(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):8<=e.bi_valid&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}function u(e,t){var i=t.dyn_tree,o=t.max_code,s=t.stat_desc.static_tree,r=t.stat_desc.has_stree,l=t.stat_desc.extra_bits,a=t.stat_desc.extra_base,p=t.stat_desc.max_length,d=0,c,u,n,h,m,g;for(h=0;h<=N;h++)e.bl_count[h]=0;for(i[2*e.heap[e.heap_max]+1]=0,c=e.heap_max+1;c<M;c++)(u=e.heap[c],h=i[2*i[2*u+1]+1]+1,h>p&&(h=p,d++),i[2*u+1]=h,!(u>o))&&(e.bl_count[h]++,m=0,u>=a&&(m=l[u-a]),g=i[2*u],e.opt_len+=g*(h+m),r&&(e.static_len+=g*(s[2*u+1]+m)));if(0!=d){do{for(h=p-1;0===e.bl_count[h];)h--;e.bl_count[h]--,e.bl_count[h+1]+=2,e.bl_count[p]--,d-=2}while(0<d);for(h=p;0!==h;h--)for(u=e.bl_count[h];0!==u;)(n=e.heap[--c],!(n>o))&&(i[2*n+1]!==h&&(e.opt_len+=(h-i[2*n+1])*i[2*n],i[2*n+1]=h),u--)}}function h(e,t,i){var o=Array(N+1),r=0,l,a;for(l=1;l<=N;l++)o[l]=r=r+i[l-1]<<1;for(a=0;a<=t;a++){var n=e[2*a+1];0!==n&&(e[2*a]=s(o[n]++,n))}}function m(){var e=Array(N+1),t,i,n,r,l;for(n=0,r=0;r<F-1;r++)for(ee[r]=n,t=0;t<1<<q[r];t++)K[n++]=r;for(K[n-1]=r,l=0,r=0;16>r;r++)for(te[r]=l,t=0;t<1<<$[r];t++)G[l++]=r;for(l>>=7;r<T;r++)for(te[r]=l<<7,t=0;t<1<<$[r]-7;t++)G[256+l++]=r;for(i=0;i<=N;i++)e[i]=0;for(t=0;143>=t;)J[2*t+1]=8,t++,e[8]++;for(;255>=t;)J[2*t+1]=9,t++,e[9]++;for(;279>=t;)J[2*t+1]=7,t++,e[7]++;for(;287>=t;)J[2*t+1]=8,t++,e[8]++;for(h(J,P+1,e),t=0;t<T;t++)Q[2*t+1]=5,Q[2*t]=s(t,5);ne=new o(J,q,R+1,P,N),oe=new o(Q,$,0,T,N),se=new o([],Z,0,O,L)}function g(e){var t;for(t=0;t<P;t++)e.dyn_ltree[2*t]=0;for(t=0;t<T;t++)e.dyn_dtree[2*t]=0;for(t=0;t<O;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*Y]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function f(e){8<e.bi_valid?a(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function y(e,t,i,n){f(e),n&&(a(e,i),a(e,~i)),E.arraySet(e.pending_buf,e.window,t,i,e.pending),e.pending+=i}function x(e,t,i,n){var o=2*t,s=2*i;return e[o]<e[s]||e[o]===e[s]&&n[t]<=n[i]}function b(e,t,i){for(var n=e.heap[i],o=i<<1;o<=e.heap_len&&(o<e.heap_len&&x(t,e.heap[o+1],e.heap[o],e.depth)&&o++,!x(t,n,e.heap[o],e.depth));)e.heap[i]=e.heap[o],i=o,o<<=1;e.heap[i]=n}function _(e,t,i){var n=0,o,s,r,a;if(0!==e.last_lit)do o=e.pending_buf[e.d_buf+2*n]<<8|e.pending_buf[e.d_buf+2*n+1],s=e.pending_buf[e.l_buf+n],n++,0===o?d(e,s,t):(r=K[s],d(e,r+R+1,t),a=q[r],0!==a&&(s-=ee[r],p(e,s,a)),o--,r=l(o),d(e,r,i),a=$[r],0!==a&&(o-=te[r],p(e,o,a)));while(n<e.last_lit);d(e,Y,t)}function k(e,t){var i=t.dyn_tree,o=t.stat_desc.static_tree,s=t.stat_desc.has_stree,r=t.stat_desc.elems,l=-1,a,n,p;for(e.heap_len=0,e.heap_max=M,a=0;a<r;a++)0===i[2*a]?i[2*a+1]=0:(e.heap[++e.heap_len]=l=a,e.depth[a]=0);for(;2>e.heap_len;)p=e.heap[++e.heap_len]=2>l?++l:0,i[2*p]=1,e.depth[p]=0,e.opt_len--,s&&(e.static_len-=o[2*p+1]);for(t.max_code=l,a=e.heap_len>>1;1<=a;a--)b(e,i,a);p=r;do a=e.heap[1],e.heap[1]=e.heap[e.heap_len--],b(e,i,1),n=e.heap[1],e.heap[--e.heap_max]=a,e.heap[--e.heap_max]=n,i[2*p]=i[2*a]+i[2*n],e.depth[p]=(e.depth[a]>=e.depth[n]?e.depth[a]:e.depth[n])+1,i[2*a+1]=i[2*n+1]=p,e.heap[1]=p++,b(e,i,1);while(2<=e.heap_len);e.heap[--e.heap_max]=e.heap[1],u(e,t),h(i,l,e.bl_count)}function j(e,t,i){var o=-1,s=t[1],r=0,l=7,a=4,p,n;for(0===s&&(l=138,a=3),t[2*(i+1)+1]=65535,p=0;p<=i;p++){if(n=s,s=t[2*(p+1)+1],++r<l&&n===s)continue;else r<a?e.bl_tree[2*n]+=r:0===n?10>=r?e.bl_tree[2*B]++:e.bl_tree[2*V]++:(n!==o&&e.bl_tree[2*n]++,e.bl_tree[2*U]++);r=0,o=n,0===s?(l=138,a=3):n===s?(l=6,a=3):(l=7,a=4)}}function w(e,t,i){var o=-1,s=t[1],r=0,l=7,a=4,c,n;for(0===s&&(l=138,a=3),c=0;c<=i;c++){if(n=s,s=t[2*(c+1)+1],++r<l&&n===s)continue;else if(r<a)do d(e,n,e.bl_tree);while(0!=--r);else 0===n?10>=r?(d(e,B,e.bl_tree),p(e,r-3,3)):(d(e,V,e.bl_tree),p(e,r-11,7)):(n!==o&&(d(e,n,e.bl_tree),r--),d(e,U,e.bl_tree),p(e,r-3,2));r=0,o=n,0===s?(l=138,a=3):n===s?(l=6,a=3):(l=7,a=4)}}function C(e){var t;for(j(e,e.dyn_ltree,e.l_desc.max_code),j(e,e.dyn_dtree,e.d_desc.max_code),k(e,e.bl_desc),t=O-1;3<=t&&0===e.bl_tree[2*W[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}function v(e,t,i,n){var o;for(p(e,t-257,5),p(e,i-1,5),p(e,n-4,4),o=0;o<n;o++)p(e,e.bl_tree[2*W[o]+1],3);w(e,e.dyn_ltree,t-1),w(e,e.dyn_dtree,i-1)}function S(e){var t=4093624447,i;for(i=0;31>=i;i++,t>>>=1)if(1&t&&0!==e.dyn_ltree[2*i])return I;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return H;for(i=32;i<R;i++)if(0!==e.dyn_ltree[2*i])return H;return I}function D(e,t,i,n){p(e,(A<<1)+(n?1:0),3),y(e,t,i,!0)}var E=e("../utils/common"),I=0,H=1,A=0,z=1,F=29,R=256,P=R+1+F,T=30,O=19,M=2*P+1,N=15,X=16,L=7,Y=256,U=16,B=17,V=18,q=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],$=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],W=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],J=Array(2*(P+2));n(J);var Q=Array(2*T);n(Q);var G=Array(512);n(G);var K=Array(258-3+1);n(K);var ee=Array(F);n(ee);var te=Array(T);n(te);var ie=!1,ne,oe,se;i._tr_init=function(e){ie||(m(),ie=!0),e.l_desc=new r(e.dyn_ltree,ne),e.d_desc=new r(e.dyn_dtree,oe),e.bl_desc=new r(e.bl_tree,se),e.bi_buf=0,e.bi_valid=0,g(e)},i._tr_stored_block=D,i._tr_flush_block=function(e,t,i,n){var o=0,s,r;0<e.level?(e.strm.data_type===2&&(e.strm.data_type=S(e)),k(e,e.l_desc),k(e,e.d_desc),o=C(e),s=e.opt_len+3+7>>>3,r=e.static_len+3+7>>>3,r<=s&&(s=r)):s=r=i+5,i+4<=s&&-1!==t?D(e,t,i,n):e.strategy===4||r===s?(p(e,(z<<1)+(n?1:0),3),_(e,J,Q)):(p(e,(2<<1)+(n?1:0),3),v(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1),_(e,e.dyn_ltree,e.dyn_dtree)),g(e),n&&f(e)},i._tr_tally=function(e,t,i){return e.pending_buf[e.d_buf+2*e.last_lit]=255&t>>>8,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&i,e.last_lit++,0===t?e.dyn_ltree[2*i]++:(e.matches++,t--,e.dyn_ltree[2*(K[i]+R+1)]++,e.dyn_dtree[2*l(t)]++),e.last_lit===e.lit_bufsize-1},i._tr_align=function(e){p(e,z<<1,3),d(e,Y,J),c(e)}},{"../utils/common":117}],129:[function(e,t){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],130:[function(e,t){"use strict";function i(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function o(e){if(c===setTimeout)return setTimeout(e,0);if((c===i||!c)&&setTimeout)return c=setTimeout,setTimeout(e,0);try{return c(e,0)}catch(t){try{return c.call(null,e,0)}catch(t){return c.call(this,e,0)}}}function s(e){if(u===clearTimeout)return clearTimeout(e);if((u===n||!u)&&clearTimeout)return u=clearTimeout,clearTimeout(e);try{return u(e)}catch(t){try{return u.call(null,e)}catch(t){return u.call(this,e)}}}function r(){m&&f&&(m=!1,f.length?h=f.concat(h):g=-1,h.length&&l())}function l(){if(!m){var e=o(r);m=!0;for(var t=h.length;t;){for(f=h,h=[];++g<t;)f&&f[g].run();g=-1,t=h.length}f=null,m=!1,s(e)}}function a(e,t){this.fun=e,this.array=t}function p(){}var d=t.exports={},c,u;(function(){try{c="function"==typeof setTimeout?setTimeout:i}catch(t){c=i}try{u="function"==typeof clearTimeout?clearTimeout:n}catch(t){u=n}})();var h=[],m=!1,g=-1,f;d.nextTick=function(e){var t=Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];h.push(new a(e,t)),1!==h.length||m||o(l)},a.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=p,d.addListener=p,d.once=p,d.off=p,d.removeListener=p,d.removeAllListeners=p,d.emit=p,d.prependListener=p,d.prependOnceListener=p,d.listeners=function(){return[]},d.binding=function(){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},{}],131:[function(e,t){"use strict";function i(e,t){var i=n(t);0===i.length&&(i="\u03B4 ");var o=[],r=!0,l=!1,a;try{for(var p=e[Symbol.iterator](),d,c;!(r=(d=p.next()).done);r=!0)c=d.value,s(c,o,t)}catch(e){l=!0,a=e}finally{try{!r&&p.return&&p.return()}finally{if(l)throw a}}return 0<o.length?i+o.join(", "):""}function n(e){var t=[],i=c(e.nucleus)+" NMR";return e.solvent&&t.push(d(e.solvent)),e.frequencyObserved&&t.push((1*e.frequencyObserved).toFixed(0)+" MHz"),i+=0<t.length?" ("+t.join(", ")+"): \u03B4 ":": \u03B4 ",i}function s(e,t,i){var n="",s=[],l=[e.from,e.to];if(Array.isArray(e.signal)&&0<e.signal.length){var a=e.signal;if(1<a.length){!0===i.ascending&&a.sort((e,t)=>{return e.delta-t.delta}),n+=_(...l).toFixed(i.nbDecimalDelta)+"-"+o(...l).toFixed(i.nbDecimalDelta),n+=" ("+r(e,i);var d=!0,c=!1,h;try{for(var m=a[Symbol.iterator](),g,f;!(d=(g=m.next()).done);d=!0)f=g.value,s=[],void 0!==f.delta&&(n=u(n),n+=f.delta.toFixed(i.nbDecimalDelta)),p({},f,s,i),0<s.length&&(n+=" ("+s.join(", ")+")")}catch(e){c=!0,h=e}finally{try{!d&&m.return&&m.return()}finally{if(c)throw h}}n+=")"}else s=[],void 0===a[0].delta?(n+=_(...l).toFixed(i.nbDecimalDelta)+"-"+o(...l).toFixed(i.nbDecimalDelta),p(e,a[0],s,i),0<s.length&&(n+=" ("+s+")")):(n+=a[0].delta.toFixed(i.nbDecimalDelta),p(e,a[0],s,i),0<s.length&&(n+=" ("+s.join(", ")+")"))}else n+=_(...l).toFixed(i.nbDecimalDelta)+"-"+o(...l).toFixed(i.nbDecimalDelta),p(e,[],s,i),0<s.length&&(n+=" ("+s.join(", ")+")");t.push(n)}function r(e,t){var i="";return e.pubIntegral?i=e.pubIntegral:e.integral&&(i=e.integral.toFixed(0)+t.nucleus[t.nucleus.length-1]),i}function l(e,t,i){var n=r(e,i);0<n.length&&t.push(n)}function a(e,t){var i=e.multiplicity||f(e,0.05);0<i.length&&t.push(i)}function p(e,t,i,n){var o=!0,s=!1,r;try{for(var p=n.format[Symbol.iterator](),d,c;!(o=(d=p.next()).done);o=!0)switch(c=d.value,c.toUpperCase()){case"I":l(e,i,n);break;case"M":a(t,i);break;case"A":g(t,i);break;case"J":m(t,i,n);break;default:throw new Error("Unknow format letter: "+c);}}catch(e){s=!0,r=e}finally{try{!o&&p.return&&p.return()}finally{if(s)throw r}}}function d(e){return e.replace(/([0-9]+)/g,"<sub>$1</sub>")}function c(e){return e.replace(/([0-9]+)/g,"<sup>$1</sup>")}function u(e){return!(0<e.length)||e.match(/ $/)||e.match(/\($/)||(e+=", "),e}function h(e){return e=e.replace(/([0-9]+)/g,"<sub>$1</sub>"),e=e.replace(/"([^"]*)"/g,"<i>$1</i>"),e}function m(e,t,i){if(Array.isArray(e.j)&&0<e.j.length){e.j.sort(function(e,t){return t.coupling-e.coupling});var n=[],o=!0,s=!1,r;try{for(var l=e.j[Symbol.iterator](),a,p;!(o=(a=l.next()).done);o=!0)p=a.value,void 0!==p.coupling&&n.push(p.coupling.toFixed(i.nbDecimalJ))}catch(e){s=!0,r=e}finally{try{!o&&l.return&&l.return()}finally{if(s)throw r}}0<n.length&&t.push("<i>J</i> = "+n.join(", ")+" Hz")}}function g(e,t){e.pubAssignment?t.push(h(e.pubAssignment)):e.assignment&&t.push(h(e.assignment))}var f=e("spectra-nmr-utilities").joinCoupling,y={h:{nucleus:"1H",nbDecimalDelta:2,nbDecimalJ:1,observedFrequency:400},c:{nucleus:"13C",nbDecimalDelta:1,nbDecimalJ:1,observedFrequency:100},f:{nucleus:"19F",nbDecimalDelta:2,nbDecimalJ:1,observedFrequency:400}};t.exports=function(e,t={}){var n=(t.nucleus||"1H").toLowerCase().replace(/[0-9]/g,""),o=y[n];t=Object.assign({},o,{ascending:!1,format:"IMJA"},t),e=e.clone(),!0===t.ascending&&e.sort((e,t)=>{var i=_(e.from,e.to),n=_(t.from,t.to);return i-n});var s=i(e,t);return 0<s.length&&(s+="."),s}},{"spectra-nmr-utilities":157}],132:[function(e,t){"use strict";t.exports.GUI=e("./visualizer/annotations"),t.exports.Ranges=e("./range/Ranges")},{"./range/Ranges":133,"./visualizer/annotations":135}],133:[function(e,t){"use strict";var i=e("../acs/acs"),n=e("./peak2Vector"),s=e("../visualizer/annotations"),r=e("spectra-nmr-utilities"),a=e("ml-stat").array;class l extends Array{constructor(e){if(Array.isArray(e)){super(e.length);for(var t=0;t<e.length;t++)this[t]=e[t]}else"number"==typeof e?super(e):super()}static fromSignals(e,t){t=Object.assign({},{lineWidth:1,frequency:400,nucleus:"1H"},t),e=r.group(e,t);var n=e.length,s=Array(n),p,i,a,d,c,u;for(p=0;p<n;p++){if(a=e[p],d=0,u=a.j,u)for(i=0;i<u.length;i++)d+=u[i].coupling;d+=2*t.lineWidth,d/=t.frequency,s[p]={from:a.delta-d,to:a.delta+d,integral:a.nbAtoms,signal:[a]}}for(p=0;p<s.length;p++)for(s[p]._highlight=s[p].signal[0].diaIDs,c=(s[p].from+s[p].to)/2,d=C(s[p].from-s[p].to),i=s.length-1;i>p;i--)C(c-(s[i].from+s[i].to)/2)<=C(d+C(s[i].from-s[i].to))/2&&(s[p].from=_(s[p].from,s[i].from),s[p].to=o(s[p].to,s[i].to),s[p].integral+=s[i].integral,s[p]._highlight.push(s[i].signal[0].diaIDs[0]),s[i].signal.forEach((e)=>{s[p].signal.push(e)}),s.splice(i,1),i=s.length-1,c=(s[p].from+s[p].to)/2,d=C(s[p].from-s[p].to));return s.sort((e,t)=>{return e.from-t.from}),new l(s)}static fromSpectrum(e,t={}){return e.getRanges(t)}updateIntegrals(e={}){var t=e.factor||1,n;if(e.sum){var i=e.sum||1,o=0;for(n=0;n<this.length;n++)o+=this[n].integral;t=i/o}for(n=0;n<this.length;n++)this[n].integral*=t;return this}getVector(e){if(this[0].signal[0].peak)return n(this.getPeakList(),e);throw Error("This method is only for signals with peaks")}getPeakList(){if(this[0].signal[0].peak){for(var e=[],t=0,i;t<this.length;t++){i=this[t];for(var n=0;n<i.signal.length;n++)e=e.concat(i.signal[n].peak)}return e}throw Error("This method is only for signals with peaks")}getACS(e){return i(this,e)}getAnnotations(e){return s.annotations1D(this,e)}toIndex(e={}){var t=[];e.joinCouplings&&this.joinCouplings(e);var n=!0,o=!1,s;try{for(var p=this[Symbol.iterator](),d,c;!(n=(d=p.next()).done);n=!0)if(c=d.value,Array.isArray(c.signal)&&0<c.signal.length){for(var u=c.signal.length,l=Array(u),h=0;h<u;h++)l[h]=c.signal[h].delta;t.push({multiplicity:1<u?"m":c.signal[0].multiplicity||r.joinCoupling(c.signal[0],e.tolerance),delta:a.arithmeticMean(l)||0.5*(c.to+c.from),integral:c.integral})}else t.push({delta:0.5*(c.to+c.from),multiplicity:"m"})}catch(e){o=!0,s=e}finally{try{!n&&p.return&&p.return()}finally{if(o)throw s}}return t}joinCouplings(e={}){this.forEach((t)=>{t.signal.forEach((t)=>{t.multiplicity=r.joinCoupling(t,e.tolerance)})})}updateMultiplicity(e={}){this.forEach((t)=>{if(t.signal){var i=t.signal;1===i.length?i[0].multiplicity=r.joinCoupling(i[0],e.tolerance):i.forEach((e)=>e.multiplicity="m")}})}clone(){var e=JSON.parse(JSON.stringify(this));return new l(e)}}t.exports=l},{"../acs/acs":131,"../visualizer/annotations":135,"./peak2Vector":134,"ml-stat":102,"spectra-nmr-utilities":157}],134:[function(e,i){"use strict";i.exports=function(e,n={}){function o(e,t,i,n){var o=e*f(i,2)/4;return o/(f(n-t,2)+f(i/2,2))}function r(e,t,i,n){return e*c(-0.5*f((n-t)/(i/2),2))}var a=n.from,p=a===void 0?null:a,d=n.to,u=d===void 0?null:d,h=n.nbPoints,m=h===void 0?1024:h,g=n.functionName,b=g===void 0?"":g,_=n.nWidth,k=_===void 0?4:_,C;if(null===p){p=s;for(var v=0;v<e.length;v++)C=e[v].x-e[v].width*k,C<p&&(p=C)}if(null===u){u=l;for(var i=0;i<e.length;i++)C=e[i].x+e[i].width*k,C>u&&(u=C)}for(var S=Array(m),D=Array(m),E=(u-p)/(m-1),I=0;I<m;I++)S[I]=p+I*E,D[I]=0;var H=e[0].y?"y":"intensity",A;switch(b.toLowerCase()){case"lorentzian":A=o;break;default:A=r;}for(var z=0,F;z<e.length;z++)if(F=e[z],F.x>p&&F.x<u)for(var R=t((F.x-p)/E),P=t(F.width*k/E),w=R-P;w<R+P;w++)0<=w&&w<m&&(D[w]+=A(F[H],S[w],F.width,F.x));return{x:S,y:D}}},{}],135:[function(e,t){"use strict";var n={type:"rect",line:0,lineLabel:1,labelColor:"red",strokeColor:"red",strokeWidth:"1px",fillColor:"green",width:0.05,height:10,toFixed:1,maxLines:s,selectable:!0,fromToc:!1},i={type:"rect",labelColor:"red",strokeColor:"red",strokeWidth:"1px",fillColor:"green",width:"6px",height:"6px"};t.exports={annotations2D:function(e,t){for(var n=Object.assign({},i,t),o=[],s=e.length-1;0<=s;s--){var r=e[s],l={};l.type=n.type,l._highlight=r._highlight,l._highlight&&0!==l._highlight.length||(l._highlight=[r.signalID]),r._highlight=l._highlight,l.position=[{x:r.fromTo[0].from-0.01,y:r.fromTo[1].from-0.01,dx:n.width,dy:n.height},{x:r.fromTo[0].to+0.01,y:r.fromTo[1].to+0.01}],l.fillColor=n.fillColor,l.label={text:r.remark,position:{x:r.signal[0].delta[0],y:r.signal[0].delta[1]-0.025}},l.strokeColor=1===r.integral?n.strokeColor:"rgb(0,128,0)",l.strokeWidth=n.strokeWidth,l.width=n.width,l.height=n.height,l.info=r,o.push(l)}return o},annotations1D:function(e,t){for(var o=Object.assign({},n,t),s=o.height,r=[],l=0;l<e.length;l++){var i=e[l],a={};if(r.push(a),a.line=o.line,a._highlight=i._highlight,o.fromToc){var p=o.line<o.maxLines?o.line:o.maxLines-1;a._highlight=[o.line],a.position=[{x:i.delta-o.width,y:p*s+"px"},{x:i.delta+o.width,y:p*s+3+"px"}]}else a._highlight&&0!==a._highlight.length||(a._highlight=[i.signalID],i.signal.forEach(function(e){for(var t=0;t<e.diaID.length;t++)a._highlight.push(e.diaID[t])})),a.position=i.to&&i.from&&i.to!==i.from?[{x:i.to,y:o.line*s+"px"},{x:i.from,y:o.line*s+3+"px"}]:[{x:i.signal[0].delta-o.width,y:o.line*s+"px"},{x:i.signal[0].delta+o.width,y:o.line*s+3+"px"}];i._highlight=a._highlight,a.type=o.type,!o.noLabel&&i.integral&&(a.label={text:i.integral.toFixed(o.toFixed),size:"11px",anchor:"middle",color:o.labelColor,position:{x:(a.position[0].x+a.position[1].x)/2,y:(o.line+o.lineLabel)*s+"px",dy:"5px"}}),a.selectable=o.selectable,a.strokeColor=o.strokeColor,a.strokeWidth=o.strokeWidth,a.fillColor=o.fillColor,a.info=i}return r}}},{}],136:[function(e,t){t.exports={_args:[["spectra-data@3.1.11","/Users/lpatiny/git/cheminfo/eln-plugin"]],_from:"spectra-data@3.1.11",_id:"spectra-data@3.1.11",_inBundle:!1,_integrity:"sha1-pw2bocSkB+Vn/taXABIoIOaL/Lc=",_location:"/spectra-data",_phantomChildren:{},_requested:{type:"version",registry:!0,raw:"spectra-data@3.1.11",name:"spectra-data",escapedName:"spectra-data",rawSpec:"3.1.11",saveSpec:null,fetchSpec:"3.1.11"},_requiredBy:["/nmr-metadata"],_resolved:"https://registry.npmjs.org/spectra-data/-/spectra-data-3.1.11.tgz",_spec:"3.1.11",_where:"/Users/lpatiny/git/cheminfo/eln-plugin",author:{name:"Andres Castillo"},bugs:{url:"https://github.com/cheminfo-js/spectra/issues"},contributors:[{name:"Micha\xEBl Zasso"},{name:"Luc Patiny"}],dependencies:{brukerconverter:"^1.0.1",jcampconverter:"^2.4.5","ml-array-utils":"^0.3.0","ml-curve-fitting":"^0.0.7","ml-fft":"^1.3.5","ml-gsd":"^2.0.1","ml-matrix-peaks-finder":"^0.2.1","ml-simple-clustering":"^0.1.0","ml-stat":"^1.3.0","nmr-simulation":"^1.0.7","spectra-data-ranges":"^0.0.7","spectra-nmr-utilities":"^0.0.5"},description:"spectra-data project - manipulate spectra",devDependencies:{"nmr-predictor":"^1.1.0"},files:["src"],homepage:"https://github.com/cheminfo-js/spectra/packages/spectra-data",jest:{testEnvironment:"node"},keywords:["spectra-data","project"],license:"MIT",main:"./src/index.js",name:"spectra-data",repository:{type:"git",url:"git+https://github.com/cheminfo-js/spectra.git"},version:"3.1.11"}},{}],137:[function(e,t){"use strict";var i=e("./SD"),n=e("./filters/Filters.js"),o=e("brukerconverter"),s=e("./peakPicking/peaks2Ranges"),r=e("nmr-simulation"),l=e("./peakPicking/impurities.json");class a extends i{constructor(e){super(e)}static fromSignals(e,t={}){t=Object.assign({},{nbPoints:16384,maxClusterSize:8,output:"xy"},t);var i=r.SpinSystem.fromPrediction(e);i.ensureClusterSize(t);var n=r.simulate1D(i,t);return a.fromXY(n.x,n.y,t)}static fromXY(e,t,n){n=Object.assign({},n,{xUnit:"PPM",yUnit:"Intensity",dataType:"NMR SPECTRUM"});var o=i.fromXY(e,t,n),s=o.sd.spectra[0];return s.observeFrequency=n.frequency||400,o.putParam("observefrequency",s.observeFrequency),o.putParam(".SOLVENTNAME",n.solvent||"none"),o.putParam(".$SW_h",C(s.lastX-s.firstX)*s.observeFrequency),o.putParam(".$SW",C(s.lastX-s.firstX)),o.putParam(".$TD",s.nbPoints),o.sd.xType=n.nucleus||"1H",new a(o.sd)}static fromBruker(e,t){t=Object.assign({},{xy:!0,keepSpectra:!0,keepRecordsRegExp:/^.+$/},t);var i=null;return i=Array.isArray(e)?o.converFolder(e,t):o.convertZip(e,t),i?i.map(function(e){return new a(e)}):null}getNucleus(e){return e&&0!==e&&1!==e?"":this.sd.xType}getSolventName(){return(this.sd.info[".SOLVENTNAME"]||this.sd.info.$SOLVENT||"").replace("<","").replace(">","")}observeFrequencyX(){return this.sd.spectra[0].observeFrequency}getNMRPeakThreshold(e){return"1H"===e?3:"13C"===e?5:1}fourierTransform(){return n.fourierTransform(this)}postFourierTransform(e){return n.phaseCorrection(0,e)}zeroFilling(e,t){return n.zeroFilling(this,e,t)}brukerFilter(){return n.digitalFilter(this,{brukerFilter:!0})}digitalFilter(e){return n.digitalFilter(this,e)}apodization(e,t){return n.apodization(this,{functionName:e,lineBroadening:t})}echoAntiechoFilter(){return this}SNVFilter(){return this}powerFilter(e){var t=this.getMinY();return 1>e&&0>t&&this.YShift(-1*t),this}phaseCorrection(e,t){return n.phaseCorrection(this,e,t)}getRanges(e={}){if(this.ranges)return this.ranges;var t=this.getPeaks(e),i=s(this,t,e);return i}createRanges(e){return this.ranges=null,this.peaks=null,this.ranges=this.getRanges(e),this.ranges}getResidual(e){return this.getImpurity(e,"solvent_residual_peak")}getImpurities(e){return this.getImpurity(e,null)}getImpurity(e,t){e=e.toLowerCase(),"(cd3)2so"===e&&(e="dmso");var i=l[e];return t&&(i=i[t.toLocaleLowerCase()]),i}}t.exports=a},{"./SD":139,"./filters/Filters.js":140,"./peakPicking/impurities.json":151,"./peakPicking/peaks2Ranges":156,brukerconverter:3,"nmr-simulation":108}],138:[function(e,i){"use strict";var n=e("./SD"),s=e("./peakPicking/peakPicking2D"),r=e("./peakPicking/peakOptimizer"),l=e("brukerconverter"),a=e("./filters/Filters.js"),p=e("ml-stat").array,d=e("nmr-simulation").simulate2D;class c extends n{constructor(e){super(e)}static fromPrediction(e,t){var i=d(e,t),n=c.fromMatrix(i,t),o=n.toJcamp({type:"NTUPLES"});return c.fromJcamp(o)}static fromBruker(e,t){t=Object.assign({},{xy:!0,keepSpectra:!0,keepRecordsRegExp:/^.+$/},t);var i=null;return i=Array.isArray(e)?l.converFolder(e,t):l.convertZip(e,t),i?i.map(function(e){return new c(e)}):null}static fromMatrix(e,t){var n={profiling:[],logs:[]},s=[],r=e[0].length;n.spectra=s,n.info={};var l=t.firstY||0,a=t.lastY||e.length-1,d=(a-l)/(e.length-1),u=t.firstX||0,h=t.lastX||r-1,m=t.x;if(!m){m=Array(r);for(var g=0;g<r;g++)m[g]=u+(a-l)/(r-1)*g}var i=t.frequencyX||400,f=Number.MAX_SAFE_INTEGER,b=Number.MIN_SAFE_INTEGER;return e.forEach((e,a)=>{var c={};c.isXYdata=!0,c.nbPoints=r,c.firstX=u,c.firstY=e[0],c.lastX=h,c.lastY=e[c.nbPoints-1],c.xFactor=1,c.yFactor=1,c.deltaX=(c.lastX-c.firstX)/(c.nbPoints-1),c.title=t.title||"spectra-data from matrix",c.dataType=t.dataType||"nD NMR SPECTRUM",c.observeFrequency=i,c.data=[{x:m,y:e}],c.page=l+a*d,n.xType=t.xType||t.nucleusX||"1H",s.push(c);var g=p.minMax(e);f=_(f,g.min),b=o(b,g.max)}),n.ntuples=[{units:t.xUnit||"PPM"},{units:t.yUnit||"PPM"},{units:t.zUnit||"Intensity"}],n.info["2D_Y_FREQUENCY"]=t.frequencyY||400,n.info["2D_X_FREQUENCY"]=t.frequencyX||400,n.info.observefrequency=n.info["2D_X_FREQUENCY"],n.info.$BF1=n.info.observefrequency,n.info[".SOLVENTNAME"]=t.solvent||"none",n.info.$SW_h=C(h-u)*i,n.info.$SW=C(h-u),n.info.$TD=r,n.info.firstY=l,n.info.lastY=a,n.minMax={minY:l,maxY:a,minX:u,maxX:h,minZ:f,maxZ:b},n.yType=t.yType||t.nucleusY||"1H",n.twoD=!0,new c(n)}isHomoNuclear(){return this.sd.xType===this.sd.yType}observeFrequencyX(){return this.sd.spectra[0].observeFrequency}observeFrequencyY(){return this.sd.indirectFrequency}getSolventName(){return(this.sd.info[".SOLVENTNAME"]||this.sd.info.$SOLVENT).replace("<","").replace(">","")}getXUnits(){return this.sd.ntuples[1].units}getYUnits(){return this.sd.ntuples[0].units}getZUnits(){return this.sd.ntuples[2].units}getLastY(){return this.sd.minMax.maxY}getFirstY(){return this.sd.minMax.minY}getDeltaY(){return(this.getLastY()-this.getFirstY())/(this.getNbSubSpectra()-1)}getMinZ(){return this.sd.minMax.minZ}getMaxZ(){return this.sd.minMax.maxZ}getZones(e){e=e||{},e.thresholdFactor||(e.thresholdFactor=1);var n=t(255*Math.random());e.idPrefix&&(n=e.idPrefix);for(var o=s(this,e.thresholdFactor),l=0;l<o.length;l++)o[l]._highlight=[n+"_"+l],o[l].signalID=n+"_"+l;if(e.references&&r.alignDimensions(o,e.references),"new"===e.format){for(var i=Array(o.length),a=o.length-1,p;0<=a;a--)p=o[a],i[a]={fromTo:p.fromTo,integral:p.intensity||1,remark:"",signal:[{peak:p.peaks,delta:[p.shiftX,p.shiftY]}],_highlight:p._highlight,signalID:p.signalID};o=i}return this.zones=o,this.zones}getNMRPeakThreshold(e){return"1H"===e?3:"13C"===e?5:1}getNucleus(e){return 1===e?this.sd.xType:2===e?this.sd.yType:this.sd.xType}zeroFilling(e,t){return a.zeroFilling(this,e,t)}brukerFilter(){return a.digitalFilter(this,{brukerFilter:!0})}digitalFilter(e){return a.digitalFilter(this,e)}fourierTransform(){return a.fourierTransform(this)}postFourierTransform(e){return a.phaseCorrection(0,e)}}i.exports=c},{"./SD":139,"./filters/Filters.js":140,"./peakPicking/peakOptimizer":153,"./peakPicking/peakPicking2D":155,brukerconverter:3,"ml-stat":102,"nmr-simulation":108}],139:[function(e,i){"use strict";var n=e("ml-stat").array,o=e("ml-array-utils"),s=e("jcampconverter"),r=e("./jcampEncoder/JcampCreator"),l=e("./peakPicking/peakPicking"),a=2;class d{constructor(e){this.sd=e,this.activeElement=0}static fromJcamp(e,t){t=Object.assign({},{keepSpectra:!0,keepRecordsRegExp:/^.+$/},t,{xy:!0});var i=s.convert(e,t);return new this(i)}static fromXY(e,t,i={}){var n={profiling:[],logs:[],info:{}},o={};return o.isXYdata=!0,o.nbPoints=e.length,o.firstX=e[0],o.firstY=t[0],o.lastX=e[o.nbPoints-1],o.lastY=t[o.nbPoints-1],o.xFactor=1,o.yFactor=1,o.xUnit=i.xUnit,o.yUnit=i.yUnit,o.deltaX=(o.lastX-o.firstX)/(o.nbPoints-1),o.title=i.title||"spectra-data from xy",o.dataType=i.dataType,o.data=[{x:e,y:t}],n.twoD=!1,n.spectra=[o],new this(n)}setActiveElement(e){this.activeElement=e}getActiveElement(){return this.activeElement}getXUnits(){return this.getSpectrum().xUnit}setXUnits(e){this.getSpectrum().xUnit=e}getYUnits(){return this.getSpectrum().yUnit}getSpectraVariable(e){return this.sd.ntuples[e]}getPage(e){return this.sd.spectra[e].page}getNbPoints(e){return this.getSpectrumData(e).y.length}getFirstX(e=this.activeElement){return this.sd.spectra[e].firstX}setFirstX(e,t=this.activeElement){this.sd.spectra[t].firstX=e}getLastX(e=this.activeElement){return this.sd.spectra[e].lastX}setLastX(e,t=this.activeElement){this.sd.spectra[t].lastX=e}getFirstY(e=this.activeElement){return this.sd.spectra[e].firstY}setFirstY(e,t=this.activeElement){this.sd.spectra[t].firstY=e}getLastY(e=this.activeElement){return this.sd.spectra[e].lastY}setLastY(e,t=this.activeElement){this.sd.spectra[t].lastY=e}setDataClass(e){e===a&&(this.getSpectrum().isPeaktable=!0,this.getSpectrum().isXYdata=!1),e===1&&(this.getSpectrum().isXYdata=!0,this.getSpectrum().isPeaktable=!1)}isDataClassPeak(){return!!this.getSpectrum().isPeaktable&&this.getSpectrum().isPeaktable}isDataClassXY(){return!!this.getSpectrum().isXYdata&&this.getSpectrum().isXYdata}setDataType(e){this.getSpectrum().dataType=e}getDataType(){return this.getSpectrum().dataType}getSpectrumData(e=this.activeElement){return this.sd.spectra[e].data[0]}getSpectrum(e=this.activeElement){return this.sd.spectra[e]}getNbSubSpectra(){return this.sd.spectra.length}getXData(e){return this.getSpectrumData(e).x}getYData(e){return this.getSpectrumData(e).y}getX(e){return this.getXData()[e]}getY(e){return this.getYData()[e]}getXYData(e){return[this.getXData(e),this.getYData(e)]}getTitle(e){return this.getSpectrum(e).title}setTitle(e,t){this.getSpectrum(t).title=e}getMinY(e){return n.min(this.getYData(e))}getMaxY(e){return n.max(this.getYData(e))}getMinMaxY(e){return n.minMax(this.getYData(e))}getNoiseLevel(e={}){var t=e.from&&e.to?this.getVector(e.from,e.to):this.getYData();var i=n.median(t);return i*this.getNMRPeakThreshold(this.getNucleus(1))}arrayPointToUnits(e){return this.getFirstX()-e*(this.getFirstX()-this.getLastX())/(this.getNbPoints()-1)}unitsToArrayPoint(e){if(this.isDataClassXY())return t((this.getFirstX()-e)*(-1/this.getDeltaX()));if(this.isDataClassPeak()){var i=0,n=this.getNbPoints()-1,o=0,s;if(this.getFirstX()>this.getLastX()){if(n=0,o=this.getNbPoints()-1,e>this.getFirstX())return this.getNbPoints();if(e<this.getLastX())return-1}else{if(e<this.getFirstX())return-1;if(e>this.getLastX())return this.getNbPoints()}for(;1<C(n-o);){if(s=t(p((n+o)/2)),this.getX(s)===e)return s;this.getX(s)>e?n=s:o=s}return i=o,C(this.getX(o)-e)>C(this.getX(n)-e)&&(i=n),i}return 0}getDeltaX(){return(this.getLastX()-this.getFirstX())/(this.getNbPoints()-1)}setMinMax(e,t){o.scale(this.getYData(),{min:e,max:t,inPlace:!0})}setMin(e){o.scale(this.getYData(),{min:e,inPlace:!0})}setMax(e){o.scale(this.getYData(),{max:e,inPlace:!0})}yShift(e){for(var t=this.getSpectrumData().y,n=this.getNbPoints(),o=0;o<n;o++)t[o]+=e;this.getSpectrum().firstY+=e,this.getSpectrum().lastY+=e}shift(e){for(var t=0;t<this.getNbSubSpectra();t++){this.setActiveElement(t);for(var i=this.getSpectrumData().x,n=this.getNbPoints(),o=0;o<n;o++)i[o]+=e;this.getSpectrum().firstX+=e,this.getSpectrum().lastX+=e}}fill(e,t,n){for(var o=0,i,s,r,l;o<this.getNbSubSpectra();o++){if(this.setActiveElement(o),r=this.getXData(),l=this.getYData(),i=this.unitsToArrayPoint(e),s=this.unitsToArrayPoint(t),i>s){var a=[s,i];i=a[0],s=a[1]}if("number"!=typeof n)l.splice(i,s-i),r.splice(i,s-i);else for(o=i;o<=s;o++)l[o]=n}}suppressZone(e,t){this.fill(e,t),this.setDataClass(a)}suppressZones(e=[]){for(var t=0;t<e.length;t++)this.suppressZone(e[t].from,e[t].to)}getMaxPeak(){for(var e=this.getSpectraDataY(),t=e[0],n=0,o=0;o<e.length;o++)t<e[o]&&(t=e[o],n=o);return[this.getX(n),t]}getParamDouble(e,t){var i=this.sd.info[e];return i||(i=t),i}getParamString(e,t){var i=this.sd.info[e];return i||(i=t),i+""}getParamInt(e,t){var i=this.sd.info[e];return i||(i=t),i}getParam(e,t){var i=this.sd.info[e];return i||(i=t),i}containsParam(e){return!!this.sd.info[e]}getSpectraDataY(){return this.getYData()}getSpectraDataX(){return this.getXData()}resetMinMax(){}putParam(e,t){this.sd.info[e]=t}getArea(e,t){var n=this.unitsToArrayPoint(e),o=this.unitsToArrayPoint(t),s=0;if(n>o){var r=[o,n];n=r[0],o=r[1]}for(var l=n;l<o;l++)s+=this.getY(l);return s*C(this.getDeltaX())}updateIntegrals(e,t){var i=0;if(e.forEach((e)=>{e.integral=this.getArea(e.from,e.to),i+=e.integral}),0!==t.nH){var n=t.nH/i;e.forEach((e)=>{e.integral*=n})}}getVector(e,t,i){return i?o.getEquallySpacedData(this.getSpectraDataX(),this.getSpectraDataY(),{from:e,to:t,numberOfPoints:i}):this.getPointsInWindow(e,t)}reduceData(e,t,n={}){if(!this.isDataClassXY())throw Error("reduceData can only apply on equidistant data");for(var s=0;s<this.getNbSubSpectra();s++)if(this.setActiveElement(s),"hz"!==this.getXUnits().toLowerCase())if(n.nbPoints){var i=this.getSpectraDataX(),r=this.getSpectraDataY();if(i[0]>i[1]&&e<t){var l=[t,e];e=l[0],t=l[1]}else if(e>t){var a=[t,e];e=a[0],t=a[1]}r=o.getEquallySpacedData(i,r,{from:e,to:t,numberOfPoints:n.nbPoints});var p=(t-e)/(r.length-1);i=Array(r.length).fill(e);for(var d=0;d<r.length;d++)i[d]+=p*d;this.sd.spectra[s].data[0].x=i,this.sd.spectra[s].data[0].y=r,this.setFirstX(i[0]),this.setLastX(i[i.length-1]),this.sd.spectra[s].nbPoints=r.length}else{var c=this.getPointsInWindow(e,t);this.sd.spectra[s].data[0].x=c[0],this.sd.spectra[s].data[0].y=c[1],this.setFirstX(c[0][0]),this.setLastX(c[0][c[0].length-1]),this.sd.spectra[s].nbPoints=c[1].length}return this.setActiveElement(0),this}getPointsInWindow(e,t,i={}){if(!this.isDataClassXY())throw Error("getPointsInWindow can only apply on equidistant data");var n=this.unitsToArrayPoint(e),o=this.unitsToArrayPoint(t);if(n>o){var s=[o,n];n=s[0],o=s[1]}if(0<=n&&o<=this.getNbPoints()-2){var r=this.getSpectraDataY().slice(n,o+1);if(!i.withoutX){var l=this.getSpectraDataX().slice(n,o+1);r=[l,r]}return r}throw Error("values outside this in range")}is2D(){return"undefined"!=typeof this.sd.twoD&&this.sd.twoD}setTotalIntegral(e){this.totalIntegralValue=e}get totalIntegral(){if(this.totalIntegralValue)return this.totalIntegralValue;if(this.molecule){if(this.getNucleus(0).indexOf("H"))return 1*this.mf.replace(/.*H([0-9]+).*/,"$1");if(this.getNucleus(0).indexOf("C"))return 1*this.mf.replace(/.*C([0-9]+).*/,"$1")}else return 100;return 1}setMolfile(e){this.molfile=e}setMF(e){this.mf=e}createPeaks(e={}){return this.peaks=l(this,e),this.peaks}getPeaks(e={}){var t;return t=this.peaks?this.peaks:l(this,e),t}toJcamp(e={}){var t=new r;return t.convert(this,Object.assign({},{yFactor:1,encode:"DIFDUP",type:"SIMPLE"},e))}}i.exports=d},{"./jcampEncoder/JcampCreator":148,"./peakPicking/peakPicking":154,jcampconverter:10,"ml-array-utils":38,"ml-stat":102}],140:[function(e,t){"use strict";t.exports.fourierTransform=e("./fourierTransform"),t.exports.zeroFilling=e("./zeroFilling"),t.exports.apodization=e("./apodization"),t.exports.phaseCorrection=e("./phaseCorrection"),t.exports.digitalFilter=e("./digitalFilter")},{"./apodization":141,"./digitalFilter":142,"./fourierTransform":143,"./phaseCorrection":144,"./zeroFilling":146}],141:[function(e,t){"use strict";t.exports=function(e,t){var i=Object.assign({},t);return i?e:e}},{}],142:[function(e,t){"use strict";var i=e("./rotate");t.exports=function(e,t){var n=e.activeElement,o=0;t.nbPoints?o=t.nbPoints:t.brukerFilter&&(o=0);var s=e.getNbSubSpectra();if(0!==o)for(var r=0;r<s;r++)e.setActiveElement(r),i(e.getYData(),o),t.rotateX&&(i(e.getXData(),o),e.setFirstX(e.getX(0)),e.setLastX(e.getX(e.getNbPoints()-1)));return e.setActiveElement(n),e}},{"./rotate":145}],143:[function(e,t){"use strict";function i(e,t){var n=e.getParamDouble("$BF1",NaN),o=e.getParamDouble("$SFO1",NaN),s=e.getParamDouble("$SW",NaN),r=1e6*((o-n)/n),l=0.5*s*o/n;e.setDataType(t),e.setFirstX(r+l),e.setLastX(r-l),e.setXUnits("PPM");var a=e.getXData(),p=r+l;l=-2*l/(a.length-1);for(var d=0;d<a.length;d++)a[d]=p,p+=l}var n=e("ml-fft");t.exports=function(e){var t=e.getNbPoints(),o=e.getNbSubSpectra()/2,s="NMR SPECTRUM",r=n.FFT;1<o&&(s="nD NMR SPECTRUM"),r.init(t);for(var l=e.getParamDouble("$FCOR",0),a=0;a<o;a++){var p=e.getYData(2*a),d=e.getYData(2*a+1);p[0]*=l,d[0]*=l,r.fft(p,d),p=p.concat(p.slice(0,(t+1)/2)),p.splice(0,(t+1)/2),d=d.concat(d.slice(0,(t+1)/2)),d.splice(0,(t+1)/2),e.setActiveElement(2*a),i(e,s),e.setActiveElement(2*a+1),i(e,s)}return e.is2D(),e.setActiveElement(0),e}},{"ml-fft":45}],144:[function(e,t){"use strict";t.exports=function(e,t,n){var o=Number.isFinite;t=o(t)?t:0,n=o(n)?n:0;for(var s=e.getNbPoints(),l=e.getYData(0),a=e.getYData(1),p=n/s,d=2*f(r(p/2),2),c=r(p),u=Math.cos(t),h=r(t),m=0,i,g,y,x,b;m<s;m++)b=s-m-1,b=m,y=l[b]*u-a[b]*h,x=l[b]*h+a[b]*u,l[b]=y,a[b]=x,i=u-(d*u+c*h),g=h-(d*h-c*u),u=i,h=g;return e.resetMinMax(),e.putParam("PHC0",t),e.putParam("PHC1",n),e}},{}],145:[function(e,t){"use strict";function i(e,t){return 0>e&&(e+=t),e>=t&&(e-=t),e}t.exports=function(e,t){var n=e.length;if(t%=n,C(t)>n/2&&(t=0<t?t-n:t+n),0!==t)for(var o=0,s=t,r=n,l=e[o],a=t,p=0<t?1:-1,d;0<r;)s=i(s,n),d=e[s],e[s]=l,s+=t,l=d,r--,s===a&&(s=i(s+p,n),a=s,o=i(s-t,n),l=e[o])}},{}],146:[function(e,t){"use strict";t.exports=function(e,t){var i=e.getNbSubSpectra(),n,o,s,r,l,a;if(0!==t)for(var p=0;p<i;p++){for(e.setActiveElement(p),n=e.getNbPoints(),a=e.getYData(),l=e.getXData(),o=e.getLastX(),s=(o-l[0])/(n-1),r=n;r<t;r++)a.push(0),l.push(o+s);t<n&&(a.splice(t,a.length-1),l.splice(t,l.length-1)),e.setFirstX(l[0]),e.setLastX(l[l.length-1])}return e.setActiveElement(0),e}},{}],147:[function(e,t,i){"use strict";i.SD=e("./SD"),i.NMR=e("./NMR"),i.NMR2D=e("./NMR2D"),i.Ranges=e("spectra-data-ranges").Ranges,i.GUI=e("spectra-data-ranges").GUI},{"./NMR":137,"./NMR2D":138,"./SD":139,"spectra-data-ranges":132}],148:[function(e,i){"use strict";function n(e,n,o,l,a){var d="",c=e.getSpectraVariable(0),u=e.getSpectraVariable(1),h=e.getSpectraVariable(2);d+="##DATA CLASS= NTUPLES"+r,d+="##NUM DIM= 2"+r;var m=e.getDataType().trim(),g={},f;for(f=0;f<e.getNbSubSpectra();f++)e.setActiveElement(f),g[e.getXUnits()]?g[e.getXUnits()].value++:g[e.getXUnits()]={value:1,index:f};var y=Object.keys(g),x=y[0],b=0;for(f=1;f<y.length;f++)g[y[f]].value>g[x].value&&(x=y[f],b=g[y[f]].index);var _=!1;e.setActiveElement(b);var k=0<=e.getDataType().indexOf("NMR");k&&(d+="##.OBSERVE FREQUENCY= "+e.getParamDouble("observefrequency",0)+r,d+="##.OBSERVE NUCLEUS= ^"+e.getNucleus()+r,d+="##$DECIM= "+e.getParamDouble("$DECIM",0)+r,d+="##$DSPFVS= "+e.getParamDouble("$DSPFVS",0)+r,d+="##$FCOR= "+p(e.getParamDouble("$FCOR",0))+r,e.containsParam("$SW_h")?d+="##$SW_h= "+e.getParamDouble("$SW_h",0)+r:e.containsParam("$SW_p")&&(d+="##$SW_p= "+e.getParamDouble("$SW_p",0)+r),d+="##$SW= "+e.getParamDouble("$SW",0)+r,d+="##$TD= "+p(e.getParamDouble("$TD",0))+r,d+="##$BF1= "+e.getParamDouble("$BF1",0)+r,d+="##$GRPDLY= "+e.getParamDouble("$GRPDLY",0)+r,d+="##.DIGITISER RES= "+e.getParamInt(".DIGITISER RES",0)+r,d+="##.PULSE SEQUENCE= "+e.getParamString(".PULSE SEQUENCE","")+r,d+="##.SOLVENT NAME= "+e.getSolventName()+r,d+="##$NUC1= <"+e.getNucleus()+">"+r,d+=e.containsParam("2D_X_FREQUENCY")?"##$SFO1= "+e.getParamDouble("2D_X_FREQUENCY",0)+r:"##$SFO1= "+e.getParamDouble("$SFO1",0)+r,e.containsParam("2D_X_OFFSET")&&(d+="##$OFFSET= "+e.getParamDouble("2D_X_OFFSET",0)+r),e.is2D()&&(d+="$$Parameters for 2D NMR Spectrum"+r,d+="##$NUC1= <"+e.getNucleus(2)+">"+r,e.containsParam("2D_Y_FREQUENCY")&&(d+="##$SFO1= "+e.getParamDouble("2D_Y_FREQUENCY",0)+r,d+="##$SFO2= "+e.getParamDouble("2D_Y_FREQUENCY",0)+r,d+="##$BF2= "+e.getParamDouble("2D_Y_FREQUENCY",0)+r),e.containsParam("2D_Y_OFFSET")&&(d+="##$OFFSET= "+e.getParamDouble("2D_Y_OFFSET",0)+r),d+="$$End of Parameters for 2D NMR Spectrum"+r)),d+="##NTUPLES=\t"+m+r;var j=1,w=1;if(!e.is2D()&&1<e.getNbSubSpectra()&&k&&(_=!0),_?(d+="##VAR_NAME=\t"+e.getXUnits()+",\t"+m.substring(4)+"/REAL,\t"+m.substring(4)+"/IMAG"+r,d+="##SYMBOL=\tX,\tR,\tI"+r,d+="##VAR_TYPE=\tINDEPENDENT,\tDEPENDENT,\tDEPENDENT"+r,d+="CSV"!==l||"PAC"!==l?"##VAR_FORM=\tAFFN,\tASDF,\tASDF"+r:"##VAR_FORM=\tAFFN,\tAFFN,\tAFFN"+r,d+="##VAR_DIM=\t"+e.getNbPoints()+",\t"+e.getNbPoints()+",\t"+e.getNbPoints()+r,d+="##UNITS=\tHZ,\t"+e.getYUnits()+",\t"+h.units+r,d+="##FACTOR=\t"+1/o+",\t"+1/n+",\t"+1/n+r,"PPM"===e.getXUnits()&&(j=e.observeFrequencyX()),d+="##FIRST=\t"+e.getFirstX()*j+",\t"+e.getY(0)+",\t0"+r,d+="##LAST=\t"+e.getLastX()*j+",\t"+e.getLastY()+",\t0"+r):(j=1,e.is2D()?(d+="##VAR_NAME=\tFREQUENCY1,\tFREQUENCY2,\tSPECTRUM"+r,d+="##SYMBOL=\tF1,\tF2,\tY"+r,d+="##.NUCLEUS=\t"+e.getNucleus(2)+",\t"+e.getNucleus(1)+r,d+="##VAR_TYPE=\tINDEPENDENT,\tINDEPENDENT,\tDEPENDENT"+r,d+="CSV"!==l||"PAC"!==l?"##VAR_FORM=\tAFFN,\tAFFN,\tASDF"+r:"##VAR_FORM=\tAFFN,\tAFFN,\tASDF"+r,d+="##VAR_DIM=\t"+e.getNbSubSpectra()+",\t"+e.getNbPoints()+",\t"+e.getNbPoints()+r,d+="##UNITS=\tHZ,\tHZ,\t"+e.getZUnits()+r,"PPM"===e.getXUnits()&&(j=e.getParamDouble("2D_Y_FREQUENCY",1)),"PPM"===e.getYUnits()&&(w=e.getParamDouble("2D_X_FREQUENCY",1)),d+="##FACTOR=\t1,\t"+w/o+",\t"+1/n+r,d+="##FIRST=\t"+e.getParamDouble("firstY",0)*j+",\t"+e.getFirstX()*w+",\t"+e.getY(0)+r,d+="##LAST=\t"+e.getParamDouble("lastY",0)*j+",\t"+e.getLastX()*w+",\t"+e.getY(e.getNbPoints()-1)+r):(d+="##VAR_NAME=\t"+c.varname+",\t"+u.varname+",\t"+c.varname+r,d+="##SYMBOL=\t"+c.symbol+",\t"+u.symbol+",\t"+h.symbol+r,d+="##VAR_TYPE=\t"+c.vartype+",\t"+u.vartype+",\t"+h.vartype+r,d+="CSV"!==l||"PAC"!==l?"##VAR_FORM=\tAFFN,\tASDF,\tASDF"+r:"##VAR_FORM=\tAFFN,\tAFFN,\tAFFN"+r,d+="##VAR_DIM=\t"+c.vardim+",\t"+u.vardim+",\t"+h.vardim+r,d+="##UNITS=\tHZ,\t"+e.getYUnits()+",\t"+h.units+r,"PPM"===e.getXUnits()&&(j=e.observeFrequencyX()),d+="##FACTOR=\t"+1/o+",\t"+1/n+r,d+="##FIRST=\t"+c.first*j+",\t"+u.first+",\t"+h.first+r,d+="##LAST=\t"+c.last*j+",\t"+u.last+",\t"+h.last+r)),null!==a)for(var C=a.length-1;0<=C;C--)e.containsParam(a[C])&&(d+="##"+a[C]+"= "+e.getParam(a[C],"")+r);var i=0,v=0,S=1;for(e.is2D()&&k&&(i=e.getParamDouble("firstY",0)*j,v=e.getParamDouble("lastY",0)*j,S=(v-i)/(e.getNbSubSpectra()-1)),f=0;f<e.getNbSubSpectra();f++)if(e.setActiveElement(f),i=e.getParamDouble("firstY",0)*j+S*f,d+="##PAGE= "+i+r,e.is2D()&&k&&(d+="##FIRST=\t"+e.getParamDouble("firstY",0)*j+",\t"+e.getFirstX()*w+",\t"+e.getY(0)+r),d+="##DATA TABLE= ",e.isDataClassPeak()){d+="(XY..XY), PEAKS"+r;for(var D=0;D<e.getNbPoints();D++)d+=e.getX(D)+", "+e.getY(D)+r}else if(e.isDataClassXY()){d+=k?e.is2D()?"(F2++(Y..Y)), PROFILE"+r:0==f%2?"(X++(R..R)), XYDATA"+r:"(X++(I..I)), XYDATA"+r:"(X++(Y..Y)), XYDATA"+r;for(var E="",I=Array(e.getNbPoints()),H=I.length-1;0<=H;H--)I[H]=t(e.getY(H)*n);E+=s.encode(I,e.getFirstX()*o,e.getDeltaX()*o,l),d+=E+r}return d+="##END NTUPLES= "+m+r,d+="##END= ",e.setActiveElement(0),d}function o(e,n,o,l,a){var p="";if(e.isDataClassPeak()&&(p+="##DATA CLASS= PEAK TABLE"+r),e.isDataClassXY()&&(p+="##DATA CLASS= XYDATA"+r),e.setActiveElement(0),0<=e.getDataType().indexOf("NMR")&&(p+="##.OBSERVE FREQUENCY= "+e.getParamDouble("observefrequency",0)+r,p+="##.OBSERVE NUCLEUS= ^"+e.getNucleus()+r,p+="##$DECIM= "+t(e.getParamDouble("$DECIM",0))+r,p+="##$DSPFVS= "+t(e.getParamDouble("$DSPFVS",0))+r,p+="##$FCOR= "+t(e.getParamDouble("$FCOR",0))+r,p+="##$SW_h= "+e.getParamDouble("$SW_h",0)+r,p+="##$SW= "+e.getParamDouble("$SW",0)+r,p+="##$TD= "+t(e.getParamDouble("$TD",0))+r,p+="##$GRPDLY= "+e.getParamDouble("$GRPDLY",0)+r,p+="##$BF1= "+e.getParamDouble("$BF1",0)+r,p+="##$SFO1= "+e.getParamDouble("$SFO1",0)+r,p+="##$NUC1= <"+e.getNucleus()+">"+r,p+="##.SOLVENT NAME= "+e.getSolventName()+r),p+="##XUNITS=\t"+e.getXUnits()+r,p+="##YUNITS=\t"+e.getYUnits()+r,p+="##NPOINTS=\t"+e.getNbPoints()+r,p+="##FIRSTX=\t"+e.getFirstX()+r,p+="##LASTX=\t"+e.getLastX()+r,p+="##FIRSTY=\t"+e.getFirstY()+r,p+="##LASTY=\t"+e.getLastY()+r,e.isDataClassPeak()?(p+="##XFACTOR=1"+r,p+="##YFACTOR=1"+r):e.isDataClassXY()&&(p+="##XFACTOR= "+1/o+r,p+="##YFACTOR= "+1/n+r),p+="##MAXY= "+e.getMaxY()+r,p+="##MINY= "+e.getMinY()+r,null!==a)for(var d=a.length-1;0<=d;d--)e.containsParam(a[d])&&(p+="##"+a[d]+"= "+e.getParam(a[d],"")+r);if(e.isDataClassPeak()){p+="##PEAK TABLE= (XY..XY)"+r;for(var i=0;i<e.getNbPoints();i++)p+=e.getX(i)+", "+e.getY(i)+r;p+="##END "}else if(e.isDataClassXY()){p+="##DELTAX= "+e.getDeltaX()+r,p+="##XYDATA=(X++(Y..Y))"+r;for(var c="",u=Array(e.getNbPoints()),h=u.length-1;0<=h;h--)u[h]=t(e.getY(h)*n);c+=s.encode(u,e.getFirstX()*o,e.getDeltaX()*o,l),p+=c+r,p+="##END= "}return e.setActiveElement(0),p}var s=e("./VectorEncoder"),r="\r\n",l="Cheminfo tools "+e("../../package.json").version,a={encode:"DIFDUP",yFactor:1,type:"SIMPLE",keep:[]};i.exports=class{convert(e,t){t=Object.assign({},a,t);var i=t.encode.toUpperCase().trim(),s=t.yFactor||1,p=2147483648,d=t.type,c=t.keep;(null===d||0===d.length)&&(d="SIMPLE");var u="";e.setActiveElement(0);var h=s/e.getParamDouble("YFACTOR",1),m={};m=e.is2D()?{min:e.getMinZ(),max:e.getMaxZ()}:e.getMinMaxY(),m.max*h>=p&&(h=p/m.max);var g=C(1/e.getDeltaX());return u+="##TITLE= "+e.getTitle()+r,u+="##JCAMP-DX= 5.00\t$$"+l+r,u+="##OWNER= "+e.getParamString("##OWNER=","")+r,u+="##DATA TYPE= "+e.getDataType()+r,"NTUPLES"===d&&(u+=n(e,h,g,i,c)),"SIMPLE"===d&&(u+=o(e,h,g,i,c)),u}}},{"../../package.json":136,"./VectorEncoder":149}],149:[function(t,i){"use strict";function n(e,t,i){return o(e,t,i,",")}function o(t,n,o,s){s||(s=" ");for(var r="",l=0,a=t.length,p;l<a-7;){for(r+=e(n+l*o),p=0;8>p;p++)r+=s+t[l++];r+=u}if(l<a)for(r+=e(n+l*o),p=l;p<a;p++)r+=s+t[p];return r}function s(t,n,o){for(var s="",r=0,l=t.length,a;r<l-7;){for(s+=e(n+r*o),a=0;8>a;a++)s+=0>t[r]?"-"+t[r++]:"+"+t[r++];s+=u}if(r<l)for(s+=e(n+r*o),a=r;a<l;a++)s+=0>t[a]?"-"+t[a]:"+"+t[a];return s}function r(t,n,o){for(var s="",r=0,l=t.length,a;r<l-10;){for(s+=e(n+r*o),a=0;10>a;a++)s+=p(t[r++].toString());s+=u}if(r<l)for(s+=e(n+r*o),a=r;a<l;a++)s+=p(t[a].toString());return s}function l(t,n,o){var s=0,r=0,l=0,a="",h="",m="",g=Array(t.length-1),f;for(f=0;f<g.length;f++)g[f]=t[f+1]-t[f];for(var i=g.length;r<i;)0==l?(h=e(n+r*o)+p(t[r].toString())+d(g[r].toString()),a+=h,l+=h.length):g[r-1]===g[r]?s++:0<s?(s++,h=c(s.toString()),a+=h,l+=h.length,s=0,r--):(h=d(g[r].toString()),h.length+l<b?(a+=h,l+=h.length):(a+=u,m=e(n+r*o)+p(t[r].toString())+h,a+=m,l=m.length)),r++;return 0<s&&(a+=c((s+1).toString())),a+=u+e(n+r*o)+p(t[r].toString()),a}function a(t,n,o){var s=0,r=0,l="",a="",c="",h=Array(t.length-1),m;for(m=0;m<h.length;m++)h[m]=t[m+1]-t[m];for(var i=h.length;s<i;)0==r?(a=e(n+s*o)+p(t[s].toString())+d(h[s].toString()),l+=a,r+=a.length):(a=d(h[s].toString()),a.length+r<b?(l+=a,r+=a.length):(l+=u,c=e(n+s*o)+p(t[s].toString())+a,l+=c,r=c.length)),s++;return l+=u+e(n+s*o)+p(t[s].toString()),l}function p(e){var t="";return"-"===e.charAt(0)?(t+=h[g][e.charAt(1)],2<e.length&&(t+=e.substring(2))):(t+=h[m][e.charAt(0)],1<e.length&&(t+=e.substring(1))),t}function d(e){var t="";return"-"===e.charAt(0)?(t+=h[y][e.charAt(1)],2<e.length&&(t+=e.substring(2))):(t+=h[f][e.charAt(0)],1<e.length&&(t+=e.substring(1))),t}function c(e){var t="";return t+=h[x][e.charAt(0)],1<e.length&&(t+=e.substring(1)),t}var u="\r\n",h=[["0","1","2","3","4","5","6","7","8","9"],["@","A","B","C","D","E","F","G","H","I"],["@","a","b","c","d","e","f","g","h","i"],["%","J","K","L","M","N","O","P","Q","R"],["%","j","k","l","m","n","o","p","q","r"],[" ","S","T","U","V","W","X","Y","Z","s"]],m=1,g=2,f=3,y=4,x=5,b=100;i.exports={encode:function(e,t,i,p){return"FIX"===p?o(e,t,i):"SQZ"===p?r(e,t,i):"DIF"===p?a(e,t,i):"DIFDUP"===p?l(e,t,i):"CSV"===p?n(e,t,i):"PAC"===p?s(e,t,i):a(e,t,i)},fixEncoding:o,commaSeparatedValuesEncoding:n,packedEncoding:s,squeezedEncoding:r,differenceDuplicateEncoding:l,differenceEncoding:a}},{}],150:[function(e,t){"use strict";function i(e,t,n){for(var o=t.length,i,s,r;o--;)for(i=e.length;i--;)e[i].asymmetric||(s=n.error+e[i].width,r=C(t[o].shift-e[i].x),r<s&&e.splice(i,1))}var n=e("./impurities.json"),o=["solvent_residual_peak","H2O","TMS"];t.exports=function(e,t={}){var s=t.solvent,r=s===void 0?"":s,l=t.error,a=l===void 0?0.025:l;r=r.toLowerCase(),"(cd3)2so"===r&&(r="dmso");var p=n[r];if(p){var d=!0,c=!1,u;try{for(var h=o[Symbol.iterator](),m;!(d=(m=h.next()).done);d=!0){var g=m.value,f=p[g.toLowerCase()];i(e,f,{error:a})}}catch(e){c=!0,u=e}finally{try{!d&&h.return&&h.return()}finally{if(c)throw u}}}return e}},{"./impurities.json":151}],151:[function(e,t){t.exports={cdcl3:{tms:[{proton:"X",coupling:0,multiplicity:"",shift:0}],solvent_residual_peak:[{proton:"X",coupling:0,multiplicity:"ds",shift:7.26}],h2o:[{proton:"H2O",coupling:0,multiplicity:"bs",shift:1.56}],acetic_acid:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.1}],acetone:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.17}],acetonitrile:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.1}],benzene:[{proton:"CH",coupling:0,multiplicity:"s",shift:7.36}],"tert-butyl_alcohol":[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.28}],"tert-butyl_methyl_ether":[{proton:"CCH3",coupling:0,multiplicity:"s",shift:1.19},{proton:"OCH3",coupling:0,multiplicity:"s",shift:3.22}],bhtb:[{proton:"ArH",coupling:0,multiplicity:"s",shift:6.98},{proton:"OHc",coupling:0,multiplicity:"s",shift:5.01},{proton:"ArCH3",coupling:0,multiplicity:"s",shift:2.27},{proton:"ArC(CH3)3",coupling:0,multiplicity:"s",shift:1.43}],chloroform:[{proton:"CH",coupling:0,multiplicity:"s",shift:7.26}],cyclohexane:[{proton:"CH2",coupling:0,multiplicity:"s",shift:1.43}],"1,2-dichloroethane":[{proton:"CH2",coupling:0,multiplicity:"s",shift:3.73}],dichloromethane:[{proton:"CH2",coupling:0,multiplicity:"s",shift:5.3}],diethyl_ether:[{proton:"CH3",coupling:7,multiplicity:"t",shift:1.21},{proton:"CH2",coupling:7,multiplicity:"q",shift:3.48}],diglyme:[{proton:"CH2",coupling:0,multiplicity:"m",shift:3.65},{proton:"CH2",coupling:0,multiplicity:"m",shift:3.57},{proton:"OCH3",coupling:0,multiplicity:"s",shift:3.39}],"1,2-dimethoxyethane":[{proton:"CH3",coupling:0,multiplicity:"s",shift:3.4},{proton:"CH2",coupling:0,multiplicity:"s",shift:3.55}],dimethylacetamide:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:2.09},{proton:"NCH3",coupling:0,multiplicity:"s",shift:3.02},{proton:"NCH3",coupling:0,multiplicity:"s",shift:2.94}],dimethylformamide:[{proton:"CH",coupling:0,multiplicity:"s",shift:8.02},{proton:"CH3",coupling:0,multiplicity:"s",shift:2.96},{proton:"CH3",coupling:0,multiplicity:"s",shift:2.88}],dimethyl_sulfoxide:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.62}],dioxane:[{proton:"CH2",coupling:0,multiplicity:"s",shift:3.71}],ethanol:[{proton:"CH3",coupling:7,multiplicity:"t",shift:1.25},{proton:"CH2",coupling:7,multiplicity:"q",shift:3.72},{proton:"OH",coupling:5,multiplicity:"s,t",shift:1.32}],ethyl_acetate:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:2.05},{proton:"CH2CH3",coupling:7,multiplicity:"q",shift:4.12},{proton:"CH2CH3",coupling:7,multiplicity:"t",shift:1.26}],ethyl_methyl_ketone:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:2.14},{proton:"CH2CH3",coupling:7,multiplicity:"q",shift:2.46},{proton:"CH2CH3",coupling:7,multiplicity:"t",shift:1.06}],ethylene_glycol:[{proton:"CH",coupling:0,multiplicity:"s",shift:3.76}],"grease^f":[{proton:"CH3",coupling:0,multiplicity:"m",shift:0.86},{proton:"CH2",coupling:0,multiplicity:"br_s",shift:1.26}],"n-hexane":[{proton:"CH3",coupling:0,multiplicity:"t",shift:0.88},{proton:"CH2",coupling:0,multiplicity:"m",shift:1.26}],hmpag:[{proton:"CH3",coupling:9.5,multiplicity:"d",shift:2.65}],methanol:[{proton:"CH3",coupling:0,multiplicity:"s",shift:3.49},{proton:"OH",coupling:0,multiplicity:"s",shift:1.09}],nitromethane:[{proton:"CH3",coupling:0,multiplicity:"s",shift:4.33}],"n-pentane":[{proton:"CH3",coupling:7,multiplicity:"t",shift:7},{proton:"CH2",coupling:0,multiplicity:"m",shift:1.27}],"2-propanol":[{proton:"CH3",coupling:6,multiplicity:"d",shift:1.22},{proton:"CH",coupling:6,multiplicity:"sep",shift:4.04}],pyridine:[{proton:"CH(2)",coupling:0,multiplicity:"m",shift:8.62},{proton:"CH(3)",coupling:0,multiplicity:"m",shift:7.29},{proton:"CH(4)",coupling:0,multiplicity:"m",shift:7.68}],silicone_greasei:[{proton:"CH3",coupling:0,multiplicity:"s",shift:0.07}],tetrahydrofuran:[{proton:"CH2",coupling:0,multiplicity:"m",shift:1.85},{proton:"CH2O",coupling:0,multiplicity:"m",shift:3.76}],toluene:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.36},{proton:"CH(o/p)",coupling:0,multiplicity:"m",shift:7.17},{proton:"CH(m)",coupling:0,multiplicity:"m",shift:7.25}],triethylamine:[{proton:"CH3",coupling:7,multiplicity:"t",shift:1.03},{proton:"CH2",coupling:7,multiplicity:"q",shift:2.53}]},"(cd3)2co":{tms:[{proton:"X",coupling:0,multiplicity:"",shift:0}],solvent_residual_peak:[{proton:"X",coupling:0,multiplicity:"",shift:2.05}],h2o:[{proton:"H2O",coupling:0,multiplicity:"s",shift:2.84}],acetic_acid:[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.96}],acetone:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.09}],acetonitrile:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.05}],benzene:[{proton:"CH",coupling:0,multiplicity:"s",shift:7.36}],"tert-butyl_alcohol":[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.18}],"tert-butyl_methyl_ether":[{proton:"CCH3",coupling:0,multiplicity:"s",shift:1.13},{proton:"OCH3",coupling:0,multiplicity:"s",shift:3.13}],bhtb:[{proton:"ArH",coupling:0,multiplicity:"s",shift:6.96},{proton:"ArCH3",coupling:0,multiplicity:"s",shift:2.22},{proton:"ArC(CH3)3",coupling:0,multiplicity:"s",shift:1.41}],chloroform:[{proton:"CH",coupling:0,multiplicity:"s",shift:8.02}],cyclohexane:[{proton:"CH2",coupling:0,multiplicity:"s",shift:1.43}],"1,2-dichloroethane":[{proton:"CH2",coupling:0,multiplicity:"s",shift:3.87}],dichloromethane:[{proton:"CH2",coupling:0,multiplicity:"s",shift:5.63}],diethyl_ether:[{proton:"CH3",coupling:7,multiplicity:"t",shift:1.11},{proton:"CH2",coupling:7,multiplicity:"q",shift:3.41}],diglyme:[{proton:"CH2",coupling:0,multiplicity:"m",shift:3.56},{proton:"CH2",coupling:0,multiplicity:"m",shift:3.47},{proton:"OCH3",coupling:0,multiplicity:"s",shift:3.28}],"1,2-dimethoxyethane":[{proton:"CH3",coupling:0,multiplicity:"s",shift:3.28},{proton:"CH2",coupling:0,multiplicity:"s",shift:3.46}],dimethylacetamide:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:1.97},{proton:"NCH3",coupling:0,multiplicity:"s",shift:3},{proton:"NCH3",coupling:0,multiplicity:"s",shift:2.83}],dimethylformamide:[{proton:"CH",coupling:0,multiplicity:"s",shift:7.96},{proton:"CH3",coupling:0,multiplicity:"s",shift:2.94},{proton:"CH3",coupling:0,multiplicity:"s",shift:2.78}],dimethyl_sulfoxide:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.52}],dioxane:[{proton:"CH2",coupling:0,multiplicity:"s",shift:3.59}],ethanol:[{proton:"CH3",coupling:7,multiplicity:"t",shift:1.12},{proton:"CH2",coupling:7,multiplicity:"q",shift:3.57},{proton:"OH",coupling:5,multiplicity:"s,t",shift:3.39}],ethyl_acetate:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:1.97},{proton:"CH2CH3",coupling:7,multiplicity:"q",shift:4.05},{proton:"CH2CH3",coupling:7,multiplicity:"t",shift:1.2}],ethyl_methyl_ketone:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:2.07},{proton:"CH2CH3",coupling:7,multiplicity:"q",shift:2.45},{proton:"CH2CH3",coupling:7,multiplicity:"t",shift:0.96}],ethylene_glycol:[{proton:"CH",coupling:0,multiplicity:"s",shift:3.28}],"grease^f":[{proton:"CH3",coupling:0,multiplicity:"m",shift:0.87},{proton:"CH2",coupling:0,multiplicity:"br_s",shift:1.29}],"n-hexane":[{proton:"CH3",coupling:0,multiplicity:"t",shift:0.88},{proton:"CH2",coupling:0,multiplicity:"m",shift:1.28}],hmpag:[{proton:"CH3",coupling:9.5,multiplicity:"d",shift:2.59}],methanol:[{proton:"CH3",coupling:0,multiplicity:"s",shift:3.31},{proton:"OH",coupling:0,multiplicity:"s",shift:3.12}],nitromethane:[{proton:"CH3",coupling:0,multiplicity:"s",shift:4.43}],"n-pentane":[{proton:"CH3",coupling:7,multiplicity:"t",shift:0.88},{proton:"CH2",coupling:0,multiplicity:"m",shift:1.27}],"2-propanol":[{proton:"CH3",coupling:6,multiplicity:"d",shift:1.1},{proton:"CH",coupling:6,multiplicity:"sep",shift:3.9}],pyridine:[{proton:"CH(2)",coupling:0,multiplicity:"m",shift:8.58},{proton:"CH(3)",coupling:0,multiplicity:"m",shift:7.35},{proton:"CH(4)",coupling:0,multiplicity:"m",shift:7.76}],silicone_greasei:[{proton:"CH3",coupling:0,multiplicity:"s",shift:0.13}],tetrahydrofuran:[{proton:"CH2",coupling:0,multiplicity:"m",shift:1.79},{proton:"CH2O",coupling:0,multiplicity:"m",shift:3.63}],toluene:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.32},{proton:"CH(o/p)",coupling:0,multiplicity:"m",shift:7.5},{proton:"CH(m)",coupling:0,multiplicity:"m",shift:7.5}],triethylamine:[{proton:"CH3",coupling:7,multiplicity:"t",shift:0.96},{proton:"CH2",coupling:7,multiplicity:"q",shift:2.45}]},dmso:{tms:[{proton:"X",coupling:0,multiplicity:"",shift:0}],solvent_residual_peak:[{proton:"X",coupling:0,multiplicity:"quint",shift:2.5}],h2o:[{proton:"H2O",coupling:0,multiplicity:"s",shift:3.33}],acetic_acid:[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.91}],acetone:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.09}],acetonitrile:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.07}],benzene:[{proton:"CH",coupling:0,multiplicity:"s",shift:7.37}],"tert-butyl_alcohol":[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.11},{proton:"OHc",coupling:0,multiplicity:"s",shift:4.19}],"tert-butyl_methyl_ether":[{proton:"CCH3",coupling:0,multiplicity:"s",shift:1.11},{proton:"OCH3",coupling:0,multiplicity:"s",shift:3.08}],bhtb:[{proton:"ArH",coupling:0,multiplicity:"s",shift:6.87},{proton:"OHc",coupling:0,multiplicity:"s",shift:6.65},{proton:"ArCH3",coupling:0,multiplicity:"s",shift:2.18},{proton:"ArC(CH3)3",coupling:0,multiplicity:"s",shift:1.36}],chloroform:[{proton:"CH",coupling:0,multiplicity:"s",shift:8.32}],cyclohexane:[{proton:"CH2",coupling:0,multiplicity:"s",shift:1.4}],"1,2-dichloroethane":[{proton:"CH2",coupling:0,multiplicity:"s",shift:3.9}],dichloromethane:[{proton:"CH2",coupling:0,multiplicity:"s",shift:5.76}],diethyl_ether:[{proton:"CH3",coupling:7,multiplicity:"t",shift:1.09},{proton:"CH2",coupling:7,multiplicity:"q",shift:3.38}],diglyme:[{proton:"CH2",coupling:0,multiplicity:"m",shift:3.51},{proton:"CH2",coupling:0,multiplicity:"m",shift:3.38},{proton:"OCH3",coupling:0,multiplicity:"s",shift:3.24}],"1,2-dimethoxyethane":[{proton:"CH3",coupling:0,multiplicity:"s",shift:3.24},{proton:"CH2",coupling:0,multiplicity:"s",shift:3.43}],dimethylacetamide:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:1.96},{proton:"NCH3",coupling:0,multiplicity:"s",shift:2.94},{proton:"NCH3",coupling:0,multiplicity:"s",shift:2.78}],dimethylformamide:[{proton:"CH",coupling:0,multiplicity:"s",shift:7.95},{proton:"CH3",coupling:0,multiplicity:"s",shift:2.89},{proton:"CH3",coupling:0,multiplicity:"s",shift:2.73}],dimethyl_sulfoxide:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.54}],dioxane:[{proton:"CH2",coupling:0,multiplicity:"s",shift:3.57}],ethanol:[{proton:"CH3",coupling:7,multiplicity:"t",shift:1.06},{proton:"CH2",coupling:7,multiplicity:"q",shift:3.44},{proton:"OH",coupling:5,multiplicity:"s,t",shift:4.63}],ethyl_acetate:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:1.99},{proton:"CH2CH3",coupling:7,multiplicity:"q",shift:4.03},{proton:"CH2CH3",coupling:7,multiplicity:"t",shift:1.17}],ethyl_methyl_ketone:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:2.07},{proton:"CH2CH3",coupling:7,multiplicity:"q",shift:2.43},{proton:"CH2CH3",coupling:7,multiplicity:"t",shift:0.91}],ethylene_glycol:[{proton:"CH",coupling:0,multiplicity:"s",shift:3.34}],"grease^f":[],"n-hexane":[{proton:"CH3",coupling:0,multiplicity:"t",shift:0.86},{proton:"CH2",coupling:0,multiplicity:"m",shift:1.25}],hmpag:[{proton:"CH3",coupling:9.5,multiplicity:"d",shift:2.53}],methanol:[{proton:"CH3",coupling:0,multiplicity:"s",shift:3.16},{proton:"OH",coupling:0,multiplicity:"s",shift:4.01}],nitromethane:[{proton:"CH3",coupling:0,multiplicity:"s",shift:4.42}],"n-pentane":[{proton:"CH3",coupling:7,multiplicity:"t",shift:0.88},{proton:"CH2",coupling:0,multiplicity:"m",shift:1.27}],"2-propanol":[{proton:"CH3",coupling:6,multiplicity:"d",shift:1.04},{proton:"CH",coupling:6,multiplicity:"sep",shift:3.78}],pyridine:[{proton:"CH(2)",coupling:0,multiplicity:"m",shift:8.58},{proton:"CH(3)",coupling:0,multiplicity:"m",shift:7.39},{proton:"CH(4)",coupling:0,multiplicity:"m",shift:7.79}],silicone_greasei:[],tetrahydrofuran:[{proton:"CH2",coupling:0,multiplicity:"m",shift:1.76},{proton:"CH2O",coupling:0,multiplicity:"m",shift:3.6}],toluene:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.3},{proton:"CH(o/p)",coupling:0,multiplicity:"m",shift:7.18},{proton:"CH(m)",coupling:0,multiplicity:"m",shift:7.25}],triethylamine:[{proton:"CH3",coupling:7,multiplicity:"t",shift:0.93},{proton:"CH2",coupling:7,multiplicity:"q",shift:2.43}]},c6d6:{tms:[{proton:"X",coupling:0,multiplicity:"",shift:0}],solvent_residual_peak:[{proton:"X",coupling:0,multiplicity:"",shift:7.16}],h2o:[{proton:"H2O",coupling:0,multiplicity:"s",shift:0.4}],acetic_acid:[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.55}],acetone:[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.55}],acetonitrile:[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.55}],benzene:[{proton:"CH",coupling:0,multiplicity:"s",shift:7.15}],"tert-butyl_alcohol":[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.05},{proton:"OHc",coupling:0,multiplicity:"s",shift:1.55}],"tert-butyl_methyl_ether":[{proton:"CCH3",coupling:0,multiplicity:"s",shift:1.07},{proton:"OCH3",coupling:0,multiplicity:"s",shift:3.04}],bhtb:[{proton:"ArH",coupling:0,multiplicity:"s",shift:7.05},{proton:"OHc",coupling:0,multiplicity:"s",shift:4.79},{proton:"ArCH3",coupling:0,multiplicity:"s",shift:2.24},{proton:"ArC(CH3)3",coupling:0,multiplicity:"s",shift:1.38}],chloroform:[{proton:"CH",coupling:0,multiplicity:"s",shift:6.15}],cyclohexane:[{proton:"CH2",coupling:0,multiplicity:"s",shift:1.4}],"1,2-dichloroethane":[{proton:"CH2",coupling:0,multiplicity:"s",shift:2.9}],dichloromethane:[{proton:"CH2",coupling:0,multiplicity:"s",shift:4.27}],diethyl_ether:[{proton:"CH3",coupling:7,multiplicity:"t",shift:1.11},{proton:"CH2",coupling:7,multiplicity:"q",shift:3.26}],diglyme:[{proton:"CH2",coupling:0,multiplicity:"m",shift:3.46},{proton:"CH2",coupling:0,multiplicity:"m",shift:3.34},{proton:"OCH3",coupling:0,multiplicity:"s",shift:3.11}],"1,2-dimethoxyethane":[{proton:"CH3",coupling:0,multiplicity:"s",shift:3.12},{proton:"CH2",coupling:0,multiplicity:"s",shift:3.33}],dimethylacetamide:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:1.6},{proton:"NCH3",coupling:0,multiplicity:"s",shift:2.57},{proton:"NCH3",coupling:0,multiplicity:"s",shift:2.05}],dimethylformamide:[{proton:"CH",coupling:0,multiplicity:"s",shift:7.63},{proton:"CH3",coupling:0,multiplicity:"s",shift:2.36},{proton:"CH3",coupling:0,multiplicity:"s",shift:1.86}],dimethyl_sulfoxide:[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.68}],dioxane:[{proton:"CH2",coupling:0,multiplicity:"s",shift:3.35}],ethanol:[{proton:"CH3",coupling:7,multiplicity:"t",shift:0.96},{proton:"CH2",coupling:7,multiplicity:"q",shift:3.34}],ethyl_acetate:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:1.65},{proton:"CH2CH3",coupling:7,multiplicity:"q",shift:3.89},{proton:"CH2CH3",coupling:7,multiplicity:"t",shift:0.92}],ethyl_methyl_ketone:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:1.58},{proton:"CH2CH3",coupling:7,multiplicity:"q",shift:1.81},{proton:"CH2CH3",coupling:7,multiplicity:"t",shift:0.85}],ethylene_glycol:[{proton:"CH",coupling:0,multiplicity:"s",shift:3.41}],"grease^f":[{proton:"CH3",coupling:0,multiplicity:"m",shift:0.92},{proton:"CH2",coupling:0,multiplicity:"br_s",shift:1.36}],"n-hexane":[{proton:"CH3",coupling:0,multiplicity:"t",shift:0.89},{proton:"CH2",coupling:0,multiplicity:"m",shift:1.24}],hmpag:[{proton:"CH3",coupling:9.5,multiplicity:"d",shift:2.4}],methanol:[{proton:"CH3",coupling:0,multiplicity:"s",shift:3.07}],nitromethane:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.94}],"n-pentane":[{proton:"CH3",coupling:7,multiplicity:"t",shift:0.86},{proton:"CH2",coupling:0,multiplicity:"m",shift:1.23}],"2-propanol":[{proton:"CH3",coupling:6,multiplicity:"d",shift:0.95},{proton:"CH",coupling:6,multiplicity:"sep",shift:3.67}],pyridine:[{proton:"CH(2)",coupling:0,multiplicity:"m",shift:8.53},{proton:"CH(3)",coupling:0,multiplicity:"m",shift:6.66},{proton:"CH(4)",coupling:0,multiplicity:"m",shift:6.98}],silicone_greasei:[{proton:"CH3",coupling:0,multiplicity:"s",shift:0.29}],tetrahydrofuran:[{proton:"CH2",coupling:0,multiplicity:"m",shift:1.4},{proton:"CH2O",coupling:0,multiplicity:"m",shift:3.57}],toluene:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.11},{proton:"CH(o/p)",coupling:0,multiplicity:"m",shift:7.02},{proton:"CH(m)",coupling:0,multiplicity:"m",shift:7.13}],triethylamine:[{proton:"CH3",coupling:7,multiplicity:"t",shift:0.96},{proton:"CH2",coupling:7,multiplicity:"q",shift:2.4}]},cd3cn:{tms:[{proton:"X",coupling:0,multiplicity:"",shift:0}],solvent_residual_peak:[{proton:"X",coupling:0,multiplicity:"",shift:1.94}],h2o:[{proton:"H2O",coupling:0,multiplicity:"s",shift:2.13}],acetic_acid:[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.96}],acetone:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.08}],acetonitrile:[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.96}],benzene:[{proton:"CH",coupling:0,multiplicity:"s",shift:7.37}],"tert-butyl_alcohol":[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.16},{proton:"OHc",coupling:0,multiplicity:"s",shift:2.18}],"tert-butyl_methyl_ether":[{proton:"CCH3",coupling:0,multiplicity:"s",shift:1.14},{proton:"OCH3",coupling:0,multiplicity:"s",shift:3.13}],bhtb:[{proton:"ArH",coupling:0,multiplicity:"s",shift:6.97},{proton:"OHc",coupling:0,multiplicity:"s",shift:5.2},{proton:"ArCH3",coupling:0,multiplicity:"s",shift:2.22},{proton:"ArC(CH3)3",coupling:0,multiplicity:"s",shift:1.39}],chloroform:[{proton:"CH",coupling:0,multiplicity:"s",shift:7.58}],cyclohexane:[{proton:"CH2",coupling:0,multiplicity:"s",shift:1.44}],"1,2-dichloroethane":[{proton:"CH2",coupling:0,multiplicity:"s",shift:3.81}],dichloromethane:[{proton:"CH2",coupling:0,multiplicity:"s",shift:5.44}],diethyl_ether:[{proton:"CH3",coupling:7,multiplicity:"t",shift:1.12},{proton:"CH2",coupling:7,multiplicity:"q",shift:3.42}],diglyme:[{proton:"CH2",coupling:0,multiplicity:"m",shift:3.53},{proton:"CH2",coupling:0,multiplicity:"m",shift:3.45},{proton:"OCH3",coupling:0,multiplicity:"s",shift:3.29}],"1,2-dimethoxyethane":[{proton:"CH3",coupling:0,multiplicity:"s",shift:3.28},{proton:"CH2",coupling:0,multiplicity:"s",shift:3.45}],dimethylacetamide:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:1.97},{proton:"NCH3",coupling:0,multiplicity:"s",shift:2.96},{proton:"NCH3",coupling:0,multiplicity:"s",shift:2.83}],dimethylformamide:[{proton:"CH",coupling:0,multiplicity:"s",shift:7.92},{proton:"CH3",coupling:0,multiplicity:"s",shift:2.89},{proton:"CH3",coupling:0,multiplicity:"s",shift:2.77}],dimethyl_sulfoxide:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.5}],dioxane:[{proton:"CH2",coupling:0,multiplicity:"s",shift:3.6}],ethanol:[{proton:"CH3",coupling:7,multiplicity:"t",shift:1.12},{proton:"CH2",coupling:7,multiplicity:"q",shift:3.54},{proton:"OH",coupling:5,multiplicity:"s,t",shift:2.47}],ethyl_acetate:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:1.97},{proton:"CH2CH3",coupling:7,multiplicity:"q",shift:4.06},{proton:"CH2CH3",coupling:7,multiplicity:"t",shift:1.2}],ethyl_methyl_ketone:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:2.06},{proton:"CH2CH3",coupling:7,multiplicity:"q",shift:2.43},{proton:"CH2CH3",coupling:7,multiplicity:"t",shift:0.96}],ethylene_glycol:[{proton:"CH",coupling:0,multiplicity:"s",shift:3.51}],"grease^f":[{proton:"CH3",coupling:0,multiplicity:"m",shift:0.86},{proton:"CH2",coupling:0,multiplicity:"br_s",shift:1.27}],"n-hexane":[{proton:"CH3",coupling:0,multiplicity:"t",shift:0.89},{proton:"CH2",coupling:0,multiplicity:"m",shift:1.28}],hmpag:[{proton:"CH3",coupling:9.5,multiplicity:"d",shift:2.57}],methanol:[{proton:"CH3",coupling:0,multiplicity:"s",shift:3.28},{proton:"OH",coupling:0,multiplicity:"s",shift:2.16}],nitromethane:[{proton:"CH3",coupling:0,multiplicity:"s",shift:4.31}],"n-pentane":[{proton:"CH3",coupling:7,multiplicity:"t",shift:0.87},{proton:"CH2",coupling:0,multiplicity:"m",shift:1.29}],"2-propanol":[{proton:"CH3",coupling:6,multiplicity:"d",shift:1.09},{proton:"CH",coupling:6,multiplicity:"sep",shift:3.87}],pyridine:[{proton:"CH(2)",coupling:0,multiplicity:"m",shift:8.57},{proton:"CH(3)",coupling:0,multiplicity:"m",shift:7.33},{proton:"CH(4)",coupling:0,multiplicity:"m",shift:7.73}],silicone_greasei:[{proton:"CH3",coupling:0,multiplicity:"s",shift:0.08}],tetrahydrofuran:[{proton:"CH2",coupling:0,multiplicity:"m",shift:1.8},{proton:"CH2O",coupling:0,multiplicity:"m",shift:3.64}],toluene:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.33},{proton:"CH(o/p)",coupling:0,multiplicity:"m",shift:7.2},{proton:"CH(m)",coupling:0,multiplicity:"m",shift:7.2}],triethylamine:[{proton:"CH3",coupling:7,multiplicity:"t",shift:0.96},{proton:"CH2",coupling:7,multiplicity:"q",shift:2.45}]},cd3od:{tms:[{proton:"X",coupling:0,multiplicity:"",shift:0}],solvent_residual_peak:[{proton:"X",coupling:0,multiplicity:"",shift:3.31}],h2o:[{proton:"H2O",coupling:0,multiplicity:"s",shift:4.87}],acetic_acid:[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.99}],acetone:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.15}],acetonitrile:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.03}],benzene:[{proton:"CH",coupling:0,multiplicity:"s",shift:7.33}],"tert-butyl_alcohol":[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.4}],"tert-butyl_methyl_ether":[{proton:"CCH3",coupling:0,multiplicity:"s",shift:1.15},{proton:"OCH3",coupling:0,multiplicity:"s",shift:3.2}],bhtb:[{proton:"ArH",coupling:0,multiplicity:"s",shift:6.92},{proton:"ArCH3",coupling:0,multiplicity:"s",shift:2.21},{proton:"ArC(CH3)3",coupling:0,multiplicity:"s",shift:1.4}],chloroform:[{proton:"CH",coupling:0,multiplicity:"s",shift:7.9}],cyclohexane:[{proton:"CH2",coupling:0,multiplicity:"s",shift:1.45}],"1,2-dichloroethane":[{proton:"CH2",coupling:0,multiplicity:"s",shift:3.78}],dichloromethane:[{proton:"CH2",coupling:0,multiplicity:"s",shift:5.49}],diethyl_ether:[{proton:"CH3",coupling:7,multiplicity:"t",shift:1.18},{proton:"CH2",coupling:7,multiplicity:"q",shift:3.49}],diglyme:[{proton:"CH2",coupling:0,multiplicity:"m",shift:3.61},{proton:"CH2",coupling:0,multiplicity:"m",shift:3.58},{proton:"OCH3",coupling:0,multiplicity:"s",shift:3.35}],"1,2-dimethoxyethane":[{proton:"CH3",coupling:0,multiplicity:"s",shift:3.35},{proton:"CH2",coupling:0,multiplicity:"s",shift:3.52}],dimethylacetamide:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:2.07},{proton:"NCH3",coupling:0,multiplicity:"s",shift:3.31},{proton:"NCH3",coupling:0,multiplicity:"s",shift:2.92}],dimethylformamide:[{proton:"CH",coupling:0,multiplicity:"s",shift:7.97},{proton:"CH3",coupling:0,multiplicity:"s",shift:2.99},{proton:"CH3",coupling:0,multiplicity:"s",shift:2.86}],dimethyl_sulfoxide:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.65}],dioxane:[{proton:"CH2",coupling:0,multiplicity:"s",shift:3.66}],ethanol:[{proton:"CH3",coupling:7,multiplicity:"t",shift:1.19},{proton:"CH2",coupling:7,multiplicity:"q",shift:3.6}],ethyl_acetate:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:2.01},{proton:"CH2CH3",coupling:7,multiplicity:"q",shift:4.09},{proton:"CH2CH3",coupling:7,multiplicity:"t",shift:1.24}],ethyl_methyl_ketone:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:2.12},{proton:"CH2CH3",coupling:7,multiplicity:"q",shift:2.5},{proton:"CH2CH3",coupling:7,multiplicity:"t",shift:1.01}],ethylene_glycol:[{proton:"CH",coupling:0,multiplicity:"s",shift:3.59}],"grease^f":[{proton:"CH3",coupling:0,multiplicity:"m",shift:0.88},{proton:"CH2",coupling:0,multiplicity:"br_s",shift:1.29}],"n-hexane":[{proton:"CH3",coupling:0,multiplicity:"t",shift:0.9},{proton:"CH2",coupling:0,multiplicity:"m",shift:1.29}],hmpag:[{proton:"CH3",coupling:9.5,multiplicity:"d",shift:2.64}],methanol:[{proton:"CH3",coupling:0,multiplicity:"s",shift:3.34}],nitromethane:[{proton:"CH3",coupling:0,multiplicity:"s",shift:4.34}],"n-pentane":[{proton:"CH3",coupling:7,multiplicity:"t",shift:0.89},{proton:"CH2",coupling:0,multiplicity:"m",shift:1.29}],"2-propanol":[{proton:"CH3",coupling:6,multiplicity:"d",shift:1.5},{proton:"CH",coupling:6,multiplicity:"sep",shift:3.92}],pyridine:[{proton:"CH(2)",coupling:0,multiplicity:"m",shift:8.53},{proton:"CH(3)",coupling:0,multiplicity:"m",shift:7.44},{proton:"CH(4)",coupling:0,multiplicity:"m",shift:7.85}],silicone_greasei:[{proton:"CH3",coupling:0,multiplicity:"s",shift:0.1}],tetrahydrofuran:[{proton:"CH2",coupling:0,multiplicity:"m",shift:1.87},{proton:"CH2O",coupling:0,multiplicity:"m",shift:3.71}],toluene:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.32},{proton:"CH(o/p)",coupling:0,multiplicity:"m",shift:7.16},{proton:"CH(m)",coupling:0,multiplicity:"m",shift:7.16}],triethylamine:[{proton:"CH3",coupling:7,multiplicity:"t",shift:1.05},{proton:"CH2",coupling:7,multiplicity:"q",shift:2.58}]},d2o:{tms:[{proton:"X",coupling:0,multiplicity:"",shift:0}],solvent_residual_peak:[{proton:"X",coupling:0,multiplicity:"",shift:4.79}],h2o:[],acetic_acid:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.08}],acetone:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.22}],acetonitrile:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.06}],benzene:[],"tert-butyl_alcohol":[{proton:"CH3",coupling:0,multiplicity:"s",shift:1.24}],"tert-butyl_methyl_ether":[{proton:"CCH3",coupling:0,multiplicity:"s",shift:1.21},{proton:"OCH3",coupling:0,multiplicity:"s",shift:3.22}],bhtb:[],chloroform:[],cyclohexane:[],"1,2-dichloroethane":[],dichloromethane:[],diethyl_ether:[{proton:"CH3",coupling:7,multiplicity:"t",shift:1.17},{proton:"CH2",coupling:7,multiplicity:"q",shift:3.56}],diglyme:[{proton:"CH2",coupling:0,multiplicity:"m",shift:3.67},{proton:"CH2",coupling:0,multiplicity:"m",shift:3.61},{proton:"OCH3",coupling:0,multiplicity:"s",shift:3.37}],"1,2-dimethoxyethane":[{proton:"CH3",coupling:0,multiplicity:"s",shift:3.37},{proton:"CH2",coupling:0,multiplicity:"s",shift:3.6}],dimethylacetamide:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:2.08},{proton:"NCH3",coupling:0,multiplicity:"s",shift:3.06},{proton:"NCH3",coupling:0,multiplicity:"s",shift:2.9}],dimethylformamide:[{proton:"CH",coupling:0,multiplicity:"s",shift:7.92},{proton:"CH3",coupling:0,multiplicity:"s",shift:3.01},{proton:"CH3",coupling:0,multiplicity:"s",shift:2.85}],dimethyl_sulfoxide:[{proton:"CH3",coupling:0,multiplicity:"s",shift:2.71}],dioxane:[{proton:"CH2",coupling:0,multiplicity:"s",shift:3.75}],ethanol:[{proton:"CH3",coupling:7,multiplicity:"t",shift:1.17},{proton:"CH2",coupling:7,multiplicity:"q",shift:3.65}],ethyl_acetate:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:2.07},{proton:"CH2CH3",coupling:7,multiplicity:"q",shift:4.14},{proton:"CH2CH3",coupling:7,multiplicity:"t",shift:1.24}],ethyl_methyl_ketone:[{proton:"CH3CO",coupling:0,multiplicity:"s",shift:2.19},{proton:"CH2CH3",coupling:7,multiplicity:"q",shift:3.18},{proton:"CH2CH3",coupling:7,multiplicity:"t",shift:1.26}],ethylene_glycol:[{proton:"CH",coupling:0,multiplicity:"s",shift:3.65}],"grease^f":[],"n-hexane":[],hmpag:[{proton:"CH3",coupling:9.5,multiplicity:"d",shift:2.61}],methanol:[{proton:"CH3",coupling:0,multiplicity:"s",shift:3.34}],nitromethane:[{proton:"CH3",coupling:0,multiplicity:"s",shift:4.4}],"n-pentane":[{proton:"CH3",coupling:7,multiplicity:"t",shift:0.9}],"2-propanol":[{proton:"CH3",coupling:6,multiplicity:"d",shift:1.17},{proton:"CH",coupling:6,multiplicity:"sep",shift:4.02}],pyridine:[{proton:"CH(2)",coupling:0,multiplicity:"m",shift:8.52},{proton:"CH(3)",coupling:0,multiplicity:"m",shift:7.45},{proton:"CH(4)",coupling:0,multiplicity:"m",shift:7.87}],silicone_greasei:[],tetrahydrofuran:[{proton:"CH2",coupling:0,multiplicity:"m",shift:1.88},{proton:"CH2O",coupling:0,multiplicity:"m",shift:3.74}],toluene:[],triethylamine:[{proton:"CH3",coupling:7,multiplicity:"t",shift:0.99},{proton:"CH2",coupling:7,multiplicity:"q",shift:2.57}]}}},{}],152:[function(i,n){"use strict";function s(e,t){var i=e.peaksComp,n=i.length;e.startX=i[0].x/e.observe-i[0].width,e.stopX=i[n-1].x/e.observe+i[n-1].width,e.integralData.from=i[0].x/e.observe-3*i[0].width,e.integralData.to=i[n-1].x/e.observe+3*i[n-1].width,e.maskPattern=e.mask2,e.multiplicity=r(e,t),e.pattern=e.multiplicity}function r(e,t){var n="",o=1,s=[],r;if(t&&0<t.length){for(t.sort(function(e,t){return t-e}),r=0;r<t.length-1;r++)C(t[r]-t[r+1])<0.05?o++:(s.push({coupling:C(t[r]),multiplicity:y[o]}),n+=y[o],o=1);s.push({coupling:C(t[r]),multiplicity:y[o]}),n+=y[o],e.nmrJs=s}else n="s",16<C(e.startX-e.stopX)*e.observe&&(n="br s");return n}function l(e){var t=f(2,e.length),n=[{x:0,intensity:t}],o,i;for(o=0;o<e.length;o++)for(i=n.length-1;0<=i;i--)n.push({x:n[i].x+e[o]/2,intensity:n[i].intensity/2}),n[i].x-=e[o]/2,n[i].intensity/=2;for(n.sort(function(e,t){return e.x-t.x}),i=n.length-2;0<=i;i--)0.1>C(n[i].x-n[i+1].x)&&(n[i].intensity+=n[i+1].intensity,n.splice(i+1,1));return n}function a(t,n){for(var o=e(0.5*t.values.length),s=t.values.length,r=0,l,i;r!==n;){for(i=!1;!i;)if(i=!0,t.currentIndex[t.active]++,t.currentIndex[t.active]>=t.values[t.active].length){if(t.active+1===o)return null;t.currentIndex[t.active]=0,i=!1,t.active++}else t.active=0;for(r=0,l=0;l<o;l++)r+=2*t.values[l][t.currentIndex[l]];0!=t.values.length%2&&(r-=t.values[o-1][t.currentIndex[o-1]])}if(r===n){var a=Array(s);for(l=0;l<o;l++)a[l]=t.values[l][t.currentIndex[l]],a[s-l-1]=t.values[l][t.currentIndex[l]];return a}return null}function p(e){var n=Array(e.length),o=Array(e.length),s,r;n[0]=[1],n[e.length-1]=[1],o[0]=-1,o[e.length-1]=0;for(var l=1;l<e.length-1;l++){s=t(0.85*e[l].intensity),r=t(1.15*e[l].intensity),n[l]=[];for(var i=s;i<=r;i++)n[l].push(i);o[l]=0}return{values:n,currentIndex:o,active:0}}function d(e,t,i){var n=c(e,t,i),o=e.peaksComp,s=e.mask,r=e.delta1;e.delta1=(e.peaks[0].x+e.peaks[e.peaks.length-1].x)/2;var l=c(e,t,i);return e.peaksComp.length>o.length?l:(e.delta1=r,e.peaksComp=o,e.mask=s,n)}function c(t,n,s){var r=Array(t.peaks.length),l,a,p,d,h,g;for(g=0;g<r.length;g++)r[g]={x:t.peaks[g].x*t.observe,intensity:t.peaks[g].intensity,width:t.peaks[g].width};for(g=r.length-2;0<=g;g--)0.25>C(r[g].x-r[g+1].x)&&(r[g].x=r[g].x*r[g].intensity+r[g+1].x*r[g+1].intensity,r[g].intensity+=r[g+1].intensity,r[g].x/=r[g].intensity,r[g].intensity/=2,r[g].width+=r[g+1].width,r.splice(g+1,1));t.peaksComp=r;var i=r.length,f=Array(i);t.mask=f;var y=0,k=r.length-1,j=t.delta1*t.observe,w=[(r[0].x+r[i-1].x)/2,1];n=u(C(j-w[0]));var v=0;for(g=0;g<i;g++)f[g]=!0,v+=t.peaks[g].intensity;for(;y<=k;){if(f[y]=!0,f[k]=!0,y==k)2<i&&C(r[y].x-j)>n&&(f[y]=!1);else if(l=o(r[y].intensity,r[k].intensity),a=_(r[y].intensity,r[k].intensity),d=l/a,d>x)r[y].intensity===a?(f[y]=!1,k++):(f[k]=!1,y--);else{var S=C(r[y].x-j),D=C(r[k].x-j);C(S-D)<n?(p=_(r[y].intensity,r[k].intensity),h=_(r[y].width,r[k].width),r[y].intensity=r[k].intensity=p,r[y].width=r[k].width=h,w=[w[0]+(r[k].x+r[y].x)/2,w[1]+1]):o(S,D)===D?(f[k]=!1,y--):(f[y]=!1,k++)}if(y++,k--,1===s&&(j=m(r,f),isNaN(j)))return 0;n=u(C(j-w[0]/w[1]))}for(g=i-1;0<=g;g--)!1===f[g]&&r.splice(g,1);if(j=m(r),isNaN(j))return 0;t.delta1=j/t.observe;var E=0,I=0;if(1<r.length){for(g=e(r.length/2)-1;0<=g;g--)E+=(3+_(C(r[g].x-j),C(r[r.length-1-g].x-j)))/(3+o(C(r[g].x-j),C(r[r.length-1-g].x-j)))*r[g].intensity,I+=r[g].intensity;E/=I}else 1===r.length&&(E=1);var H=0;for(g=0;g<r.length;g++)H+=r[g].intensity;if(E-=0.12*((v-H)/v),0.8<E&&0.97>E&&2>s)return c(t,b,2);if(1<r.length){var A;for(g=e(r.length/2)-1;0<=g;g--)A=(r[g].x-r[r.length-1-g].x)/2,r[g].x=j+A,r[r.length-1-g].x=j-A}return E}function u(e){var t=2.5*e;return 0.75>t&&(t=0.75),3<t&&(t=3),t}function h(e,t){for(var n=JSON.parse(JSON.stringify(e.peaksComp)),o=0,s=0,r=0;r<n.length;r++)o+=n[r].intensity;o=f(2,t)/o,e.mask2=JSON.parse(JSON.stringify(e.mask));var i=e.mask2.length-1;for(r=n.length-1;0<=r;r--){for(n[r].intensity*=o;0<=i&&!1===e.mask2[i];)i--;0.75>n[r].intensity?(n.splice(r,1),e.mask2[i]=!1):s+=n[r].intensity,i--}for(s=f(2,t)/s,r=n.length-1;0<=r;r--)n[r].intensity*=s;return n}function m(e,t){var n=0,o=0,s,i;if(t)for(s=0;s<e.length;s++)!0===t[s]&&(i=g(e[s]),n+=i,o+=i*e[s].x);else for(s=0;s<e.length;s++)i=g(e[s]),n+=i,o+=i*e[s].x;return o/n}function g(e){return C(1.57*(e.intensity*e.width))}var y=["s","d","t","q","quint","h","sept","o","n"],x=1.5,b=1;n.exports={compilePattern:function(e){if(e.multiplicity="m",e.symRank=d(e,2.5,1),e.asymmetric=!0,0.95<=e.symRank&&32>e.peaksComp.length){e.asymmetric=!1;var t=1,o=[],r,i,c,n,m,g;for(c=0;9>c;c++){var y=h(e,c),x=!1;if(1===y.length&&0===c)x=!0;else if(1>=y.length)continue;var b=p(y);m=f(2,c);for(var _=null,k=1,j;!x&&null!==(_=a(b,m))&&400>k;){for(j=Array(_.length),t=1,r=0;r<_.length;r++)for(j[r]=Array(_[r]),i=0;i<_[r];i++)j[r][i]=t++;o=[],i=1,o.push(y[1].x-y[0].x),n=y[0].x,j[0].splice(0,1),j[1].splice(0,1),t=1;var w=2;for(g=f(2,c)-1;o.length<c&&w<g&&t<y.length;){for(k+=1,i++;t<y.length&&0===j[t].length;)t++;if(t<y.length){o.push(y[t].x-y[0].x),j[t].splice(0,1),w++;for(var v=2,u;v<=i;v++){for(u=0,r=0;r<v;r++)u+=o[r];for(r=1;r<j.length;r++)if(0.25>C(y[r].x-(n+u))){j[r].splice(0,1),w++;break}}}}var S=l(o);for(x=!0,r=0;r<S.length;r++)S[r].intensity!==_[r]&&(x=!1)}x&&s(e,o)}}for(r=0;r<e.peaksComp.length;r++)e.peaksComp[r].x/=e.observe}}},{}],153:[function(e,t){"use strict";function n(e,t,i,n){var o=s(e,t,i,-n[0],!0),r=0,l=null,a=null;0>o&&(l={nucleusX:i.nucleusX,nucleusY:i.nucleusY},l.resolutionX=i.resolutionX,l.resolutionY=i.resolutionY,l.shiftX=i.shiftY,l.shiftY=i.shiftX,l.peaks=[{x:i.shiftY,y:i.shiftX,z:1}],e.push(l),a=[-n[0],n[1]],t.push(a),r++);var d=!1,c=!1,u,h;for(u=e.length-1;0<=u;u--)h=e[u],0===t[u][0]&&(C(h.shiftX-i.shiftX)<p&&(d=!0),C(h.shiftY-i.shiftY)<p&&(c=!0));return!1==d&&(l={nucleusX:i.nucleusX,nucleusY:i.nucleusY},l.resolutionX=i.resolutionX,l.resolutionY=i.resolutionY,l.shiftX=i.shiftX,l.shiftY=i.shiftX,l.peaks=[{x:i.shiftX,y:i.shiftX,z:1}],e.push(l),a=[0,n[1]],t.push(a),r++),!1==c&&(l={nucleusX:i.nucleusX,nucleusY:i.nucleusY},l.resolutionX=i.resolutionX,l.resolutionY=i.resolutionY,l.shiftX=i.shiftY,l.shiftY=i.shiftY,l.peaks=[{x:i.shiftY,y:i.shiftY,z:1}],e.push(l),a=[0,n[1]],t.push(a),r++),r}function o(e,t,n,o){for(var s=0,r=4*n.shiftX,l=[],a=[],d=e.length-1,i;0<=d;d--)i=e[d],0!==t[d][0]&&(C(i.shiftX-n.shiftX)<p?(s++,o&&t[d][1]++,l.push(d),r+=i.shiftX):C(i.shiftY-n.shiftY)<p&&(s++,o&&t[d][1]++,a.push(d),r+=i.shiftY));if(r/=l.length+a.length+4,0<l.length)for(d=l.length-1;0<=d;d--)e[l[d]].shiftX=r;if(0<a.length)for(d=a.length-1;0<=d;d--)e[a[d]].shiftY=r;return n.shiftX=r,n.shiftY=r,s}function s(e,t,n,o,s){for(var r=e.length-1;0<=r;r--)if(t[r][0]===o&&l(n,e[r],s)<d){if(!s){var i=(e[r].shiftX+n.shiftX)/2,a=(e[r].shiftY+n.shiftY)/2;e[r].shiftX=i,e[r].shiftY=a,n.shiftX=i,n.shiftY=a}else{var p=n.shiftX,c=e[r].shiftX;e[r].shiftY=p,n.shiftY=c}return r}return-1}function r(e){for(var t=Array(e.length),n=e.length-1;0<=n;n--)if(t[n]=[0,0],C(e[n].shiftX-e[n].shiftY)<=p){t[n][1]=1;var i=(2*e[n].shiftX+e[n].shiftY)/3;e[n].shiftX=i,e[n].shiftY=i}else t[n][0]=0<e[n].shiftX-e[n].shiftY?1:-1;return t}function l(e,t,i){return i?u(f(e.shiftX-t.shiftY,2)+f(e.shiftY-t.shiftX,2)):u(f(e.shiftX-t.shiftX,2)+f(e.shiftY-t.shiftY,2))}function a(e,t){var n=0,o=0,s,i;for(s=0;s<e.length;s++){var r=e[s];for(i=0;i<t.length;i++)n=(t[i].startX+t[i].stopX)/2,o=C(t[i].startX-t[i].stopX)/2,r.nucleusX===t[i].nucleus&&C(r.shiftX-n)<=o&&r._highlight.push(t[i]._highlight[0]),r.nucleusY===t[i].nucleus&&C(r.shiftY-n)<=o&&r._highlight.push(t[i]._highlight[0])}}var p=0.05,d=0.05;t.exports={clean:function(e,t){var n=Number.NEGATIVE_INFINITY,o;for(o=e.length-1;0<=o;o--)C(e[o].z)>n&&(n=C(e[o].z));for(n*=t,o=e.length-1;0<=o;o--)C(e[o].z)<n&&e.splice(o,1);return e},enhanceSymmetry:function(e){var t=r(e),l=e,a,i,p,d;for(a=l.length-1;0<=a;a--)d=l[a],1<d.peaks.length&&t[a][1]++,1===t[a][0]&&(p=s(l,t,d,-1,!0),0<=p&&(t[a][1]+=2,t[p][1]+=2));for(a=l.length-1;0<=a;a--)d=l[a],0===t[a][0]&&(i=o(l,t,d,!0),t[a][1]+=i);var c=0;for(a=l.length-1;0<=a;a--)0!==t[a][0]&&2<t[a][1]&&(c++,c+=n(l,t,l[a],t[a])),2<=t[a][1]&&0===t[a][0]&&c++;var u=Array(c);for(c--,a=l.length-1;0<=a;a--)(0!==t[a][0]&&2<t[a][1]||0===t[a][0]&&1<t[a][1])&&(u[c--]=l[a]);return u},alignDimensions:function(e,t){for(var n=0,i;n<t.length;n++)i=t[n],i&&a(e,i)}}},{}],154:[function(e,t){"use strict";function i(e,t){for(var n=0,i=e.length;n<i;n++)C(e[n].y)<t&&e.splice(n,1);return e}var n=e("ml-gsd"),o={thresholdFactor:1,optimize:!1,minMaxRatio:0.01,broadRatio:2.5e-4,smoothY:!0,widthFactor:4,realTop:!0,functionName:"gaussian",broadWidth:0.25,sgOptions:{windowSize:9,polynomial:3}};t.exports=function(e,t={}){t=Object.assign({},o,t,{optimize:!1,broadWidth:!1}),t.noiseLevel||(t.noiseLevel=C(e.getNoiseLevel())*t.thresholdFactor);var s=e.getXYData();t.from&&t.to&&(s=e.getVector(t.from,t.to));var r=n.gsd(s[0],s[1],t);return t.broadWidth&&(r=n.post.joinBroadPeaks(r,{width:t.broadWidth})),t.optimize&&(r=n.post.optimizePeaks(r,s[0],s[1],t)),i(r,t.noiseLevel)}},{"ml-gsd":47}],155:[function(e,t){"use strict";function n(e){return e.isHomoNuclear()?1.5:3}function o(e,t,n){var o=t.observeFrequencyX(),r=t.observeFrequencyY(),a=t.getFirstY(),p=t.getDeltaY(),d;for(d=e.length-1;0<=d;d--)e[d].x=t.arrayPointToUnits(e[d].x),e[d].y=a+p*e[d].y,(-1>e[d].y||210<=e[d].y)&&e.splice(d,1);var i=[],c=0;for(n*=n,d=0;d<e.length;d++)for(var u=d;u<e.length;u++)c=f((e[d].x-e[u].x)*o,2)+f((e[d].y-e[u].y)*r,2),c<n?i.push(1):i.push(0);var h=l(i),m=[];if(null!=e)for(var g=0,y;g<h.length;g++){y={nucleusX:t.getNucleus(1),nucleusY:t.getNucleus(2)},y.resolutionX=(t.getLastX()-t.getFirstX())/t.getNbPoints(),y.resolutionY=p;var x=[];y.shiftX=0,y.shiftY=0;for(var b=[s,0],_=[s,0],k=0,j=h[g].length-1;0<=j;j--)1===h[g][j]&&(x.push({x:e[j].x,y:e[j].y,z:e[j].z}),y.shiftX+=e[j].x*e[j].z,y.shiftY+=e[j].y*e[j].z,k+=e[j].z,e[j].x<b[0]&&(b[0]=e[j].x),e[j].x>b[1]&&(b[1]=e[j].x),e[j].y<_[0]&&(_[0]=e[j].y),e[j].y>_[1]&&(_[1]=e[j].y));y.fromTo=[{from:b[0],to:b[1]},{from:_[0],to:_[1]}],y.shiftX/=k,y.shiftY/=k,y.peaks=x,m.push(y)}return m}var r=e("./peakOptimizer"),l=e("ml-simple-clustering"),a=e("ml-matrix-peaks-finder"),p=e("ml-fft").FFTUtils,d=[[0,0,1,2,2,2,1,0,0],[0,1,4,7,7,7,4,1,0],[1,4,5,3,0,3,5,4,1],[2,7,3,-12,-23,-12,3,7,2],[2,7,0,-23,-40,-23,0,7,2],[2,7,3,-12,-23,-12,3,7,2],[1,4,5,3,0,3,5,4,1],[0,1,3,7,7,7,3,1,0],[0,0,1,2,2,2,1,0,0]];t.exports=function(e,t){0===t&&(t=1),0>t&&(t=-t);for(var s=e.getNbPoints(),l=e.getNbSubSpectra(),c=Array(s*l),u=e.isHomoNuclear(),h=0,m;h<l;h++){m=e.getYData(h);for(var g=0;g<s;g++)c[h*s+g]=u?0<m[g]?m[g]:0:C(m[g])}var f=n(e);if(u){for(var y=p.convolute(c,d,l,s),x=a.findPeaks2DRegion(c,{filteredData:y,rows:l,cols:s,nStdDev:f*t}),b=a.findPeaks2DMax(c,{filteredData:y,rows:l,cols:s,nStdDev:(f+0.5)*t}),_=0;_<x.length;_++)b.push(x[_]);return r.enhanceSymmetry(o(b,e,24))}var i=p.convolute(c,d,l,s),k=a.findPeaks2DRegion(c,{filteredData:i,rows:l,cols:s,nStdDev:f*t});return o(r.clean(k,0.05),e,24)}},{"./peakOptimizer":153,"ml-fft":45,"ml-matrix-peaks-finder":61,"ml-simple-clustering":99}],156:[function(e,i){"use strict";function n(e,t,n={}){var r=n.nH,l=r===void 0?100:r,a=n.integralType,p=a===void 0?"sum":a,d=n.frequencyCluster,c=d===void 0?16:d,u=n.frequency,h=u===void 0?e.observeFrequencyX():u,m=[],g={x:1e5},f=0,y,i,x,b;for(c/=h,y=0;y<t.length;y++){if(C(t[y].x-g.x)>c)x={nbPeaks:1,units:"PPM",startX:t[y].x-t[y].width,stopX:t[y].x+t[y].width,multiplicity:"",pattern:"",observe:h,nucleus:e.getNucleus(1),integralData:{from:t[y].x-3*t[y].width,to:t[y].x+3*t[y].width},peaks:[{x:t[y].x,intensity:t[y].y,width:t[y].width}]},m.push(x);else{var k=t[y].x+t[y].width;x.stopX=o(x.stopX,k),x.startX=_(x.startX,k),x.nbPeaks++,x.peaks.push({x:t[y].x,intensity:t[y].y,width:t[y].width}),x.integralData.from=_(x.integralData.from,t[y].x-3*t[y].width),x.integralData.to=o(x.integralData.to,t[y].x+3*t[y].width)}g=t[y]}for(y=0;y<m.length;y++){b=m[y].peaks;var j=m[y].integralData,w=0,v=0;for(i=0;i<b.length;i++){var S=s(b[i]);w+=b[i].x*S,v+=S}m[y].delta1=w/v,j.value="sum"===p?e.getArea(j.from,j.to):v,f+=j.value}if(0<l){var D=l/f;for(y=0;y<m.length;y++){var E=m[y].integralData;E.value*=D}}return m}function s(e){return C(1.57*(e.intensity*e.width))}var r=e("./jAnalyzer"),l=e("spectra-data-ranges").Ranges,a=e("./ImpurityRemover"),p={nH:100,idPrefix:"",clean:0.5,thresholdFactor:1,compile:!0,integralType:"sum",optimize:!0,frequencyCluster:16};i.exports=function(e,o,d){d=Object.assign({},p,d);var c=d.nH,u,i;o=a(o,d.removeImpurity);var h=n(e,o,d);if(d.clean)for(u=0;u<h.length;u++)h[u].integralData.value<d.clean&&h.splice(u,1);if(d.compile){var m,g;for(u=0;u<h.length;u++)if(r.compilePattern(h[u]),h[u].maskPattern&&"m"!==h[u].multiplicity&&""!==h[u].multiplicity){m=0,g=0;var f=[];for(i=h[u].maskPattern.length-1;0<=i;i--)if(g+=s(h[u].peaks[i]),!1===h[u].maskPattern[i]){var y=h[u].peaks.splice(i,1)[0];f.push({x:y.x,y:y.intensity,width:y.width}),h[u].mask.splice(i,1),h[u].mask2.splice(i,1),h[u].maskPattern.splice(i,1),h[u].nbPeaks--,m+=s(y)}if(0<f.length){m=m*h[u].integralData.value/g,h[u].integralData.value-=m;var x=[];for(i=f.length-1;0<=i;i--)x.push(f[i]);d.nH=m;var b=n(e,x,d);for(i=0;i<b.length;i++)h.push(b[i])}}var _=0,k=0;for(u=0;u<h.length;u++)k+=t(h[u].integralData.value);if(k!==c)for(_=c/k,u=0;u<h.length;u++)h[u].integralData.value*=_}if(h.sort(function(e,t){return t.delta1-e.delta1}),d.clean)for(u=h.length-1;0<=u;u--)h[u].integralData.value<d.clean&&h.splice(u,1);for(u=0;u<h.length;u++)h[u].signalID=d.idPrefix&&0<d.idPrefix.length?d.idPrefix+"_"+(u+1):u+1+"",h[u]._highlight=[h[u].signalID];var j=Array(h.length);for(u=0;u<h.length;u++){var w=h[u];j[u]={from:w.integralData.from,to:w.integralData.to,integral:w.integralData.value,signal:[{nbAtoms:0,diaID:[],multiplicity:w.multiplicity,peak:w.peaks,kind:"",remark:""}],signalID:w.signalID,_highlight:w._highlight},w.nmrJs&&(j[u].signal[0].j=w.nmrJs),w.asymmetric&&"m"!==w.multiplicity||(j[u].signal[0].delta=w.delta1)}return new l(j)}},{"./ImpurityRemover":150,"./jAnalyzer":152,"spectra-data-ranges":132}],157:[function(e,t){"use strict";var n=["s","d","t","q","quint","h","sept","o","n"];t.exports.nmrJ=function(e,t={}){var n="";t=Object.assign({},{separator:", ",nbDecimal:2},t);var o,s;for(s=0;s<e.length;s++)o=e[s],11<o.length&&(o+=t.separator),n+=o.multiplicity+" "+o.coupling.toFixed(t.nbDecimal);return n},t.exports.joinCoupling=function(e,t=0.05){var o=e.j;if(o&&0<o.length){var s=o[0].assignment?o[0].assignment.length:1,r="",l=[],a=[],p=[];o.sort(function(e,t){return t.coupling-e.coupling}),o[0].diaID&&(a=[o[0].diaID]),o[0].assignment&&(p=o[0].assignment);for(var d=0;d<o.length-1;d++)if(C(o[d].coupling-o[d+1].coupling)<t)s+=o[d+1].assignment?o[d+1].assignment.length:1,a.push(o[d].diaID),p=p.concat(o[d+1].assignment);else{var i={coupling:C(o[d].coupling),multiplicity:n[s]};0<a.length&&(i.diaID=a),0<p.length&&(i.assignment=p),l.push(i),o[0].diaID&&(a=[o[d].diaID]),o[0].assignment&&(p=o[d].assignment),r+=n[s],s=o[d+1].assignment?o[d+1].assignment.length:1}var c={coupling:C(o[d].coupling),multiplicity:n[s]};0<a.length&&(c.diaID=a),0<p.length&&(c.assignment=p),l.push(c),r+=n[s],e.j=l}else r=e.delta?"s":"m";return r},t.exports.group=function(e,o={}){var s,i;for(s=0;s<e.length;s++){var r=e[s].j;if(r&&0<r.lengthpublish)for(i=r.length-2;0<=i;i--)for(var l=r.length-1;l>i;l--)r[i].diaID===r[l].diaID&&r[i].coupling===r[l].coupling&&r[i].distance===r[l].distance&&(r[i].assignment=r[i].assignment.concat(r[l].assignment),r.splice(l,1))}for(e.sort((e,t)=>{return e.diaIDs[0]<t.diaIDs[0]?-1:e.diaIDs[0]>t.diaIDs[0]?1:0}),s=e.length-2;0<=s;s--)e[s].diaIDs[0]===e[s+1].diaIDs[0]&&(e[s].nbAtoms+=e[s+1].nbAtoms,e[s].atomIDs=e[s].atomIDs.concat(e[s+1].atomIDs),e.splice(s+1,1));for(s=0;s<e.length;s++){for(r=e[s].j,i=0;i<r.length;i++)r[i].multiplicity=n[r[i].assignment.length];e[s].multiplicity=t.exports.compilePattern(e[s],o.tolerance)}return e},t.exports.compilePattern=function(e,t=0.05){var o=e.j,s="";if(o&&0<o.length){var r=o[0].assignment?o[0].assignment.length:0;o.sort(function(e,t){return t.coupling-e.coupling});for(var l=0;l<o.length-1;l++)C(o[l].coupling-o[l+1].coupling)<t?r+=o[l+1].assignment?o[l+1].assignment.length:1:(s+=n[r],r=o[l+1].assignment?o[l+1].assignment.length:1);s+=n[r]}else s=e.delta?"s":"m";return s}},{}],158:[function(e,t){"use strict";t.exports="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}},{}],159:[function(e,t){"use strict";t.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},{}],160:[function(e,t,i){(function(t,n){"use strict";function o(e,t){var n={seen:[],stylize:r};return 3<=arguments.length&&(n.depth=arguments[2]),4<=arguments.length&&(n.colors=arguments[3]),g(t)?n.showHidden=t:t&&i._extend(n,t),x(n.showHidden)&&(n.showHidden=!1),x(n.depth)&&(n.depth=2),x(n.colors)&&(n.colors=!1),x(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=s),a(n,e,n.depth)}function s(e,t){var i=o.styles[t];return i?"\x1B["+o.colors[i][0]+"m"+e+"\x1B["+o.colors[i][1]+"m":e}function r(e){return e}function l(e){var t={};return e.forEach(function(e){t[e]=!0}),t}function a(e,t,o){if(e.customInspect&&t&&C(t.inspect)&&t.inspect!==i.inspect&&!(t.constructor&&t.constructor.prototype===t)){var s=t.inspect(o,e);return b(s)||(s=a(e,s,o)),s}var r=p(e,t);if(r)return r;var g=Object.keys(t),f=l(g);if(e.showHidden&&(g=Object.getOwnPropertyNames(t)),w(t)&&(0<=g.indexOf("message")||0<=g.indexOf("description")))return d(t);if(0===g.length){if(C(t)){var y=t.name?": "+t.name:"";return e.stylize("[Function"+y+"]","special")}if(_(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(j(t))return e.stylize(Date.prototype.toString.call(t),"date");if(w(t))return d(t)}var x="",k=!1,v=["{","}"];if(m(t)&&(k=!0,v=["[","]"]),C(t)){var S=t.name?": "+t.name:"";x=" [Function"+S+"]"}if(_(t)&&(x=" "+RegExp.prototype.toString.call(t)),j(t)&&(x=" "+Date.prototype.toUTCString.call(t)),w(t)&&(x=" "+d(t)),0===g.length&&(!k||0==t.length))return v[0]+x+v[1];if(0>o)return _(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special");e.seen.push(t);var n;return n=k?c(e,t,o,f,g):g.map(function(i){return u(e,t,o,f,i,k)}),e.seen.pop(),h(n,x,v)}function p(e,t){if(x(t))return e.stylize("undefined","undefined");if(b(t)){var i="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,"\"")+"'";return e.stylize(i,"string")}return f(t)?e.stylize(""+t,"number"):g(t)?e.stylize(""+t,"boolean"):y(t)?e.stylize("null","null"):void 0}function d(e){return"["+Error.prototype.toString.call(e)+"]"}function c(e,t,n,o,s){for(var r=[],a=0,i=t.length;a<i;++a)E(t,a+"")?r.push(u(e,t,n,o,a+"",!0)):r.push("");return s.forEach(function(i){i.match(/^\d+$/)||r.push(u(e,t,n,o,i,!0))}),r}function u(e,t,i,n,o,s){var r,l,p;if(p=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]},p.get?p.set?l=e.stylize("[Getter/Setter]","special"):l=e.stylize("[Getter]","special"):p.set&&(l=e.stylize("[Setter]","special")),E(n,o)||(r="["+o+"]"),l||(0>e.seen.indexOf(p.value)?(l=y(i)?a(e,p.value,null):a(e,p.value,i-1),-1<l.indexOf("\n")&&(s?l=l.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):l="\n"+l.split("\n").map(function(e){return"   "+e}).join("\n"))):l=e.stylize("[Circular]","special")),x(r)){if(s&&o.match(/^\d+$/))return l;r=JSON.stringify(""+o),r.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(r=r.substr(1,r.length-2),r=e.stylize(r,"name")):(r=r.replace(/'/g,"\\'").replace(/\\"/g,"\"").replace(/(^"|"$)/g,"'"),r=e.stylize(r,"string"))}return r+": "+l}function h(e,t,i){var n=0,o=e.reduce(function(e,t){return n++,0<=t.indexOf("\n")&&n++,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0);return 60<o?i[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+i[1]:i[0]+t+" "+e.join(", ")+" "+i[1]}function m(e){return Array.isArray(e)}function g(e){return"boolean"==typeof e}function y(e){return null===e}function f(e){return"number"==typeof e}function b(e){return"string"==typeof e}function x(e){return void 0===e}function _(e){return k(e)&&"[object RegExp]"===v(e)}function k(e){return"object"==typeof e&&null!==e}function j(e){return k(e)&&"[object Date]"===v(e)}function w(t){return k(t)&&("[object Error]"===v(t)||t instanceof Error)}function C(e){return"function"==typeof e}function v(e){return Object.prototype.toString.call(e)}function S(e){return 10>e?"0"+e.toString(10):e.toString(10)}function D(){var e=new Date,t=[S(e.getHours()),S(e.getMinutes()),S(e.getSeconds())].join(":");return[e.getDate(),z[e.getMonth()],t].join(" ")}function E(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var I=/%[sdj%]/g;i.format=function(e){if(!b(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(o(arguments[n]));return t.join(" ")}for(var n=1,i=arguments,s=i.length,r=(e+"").replace(I,function(e){if("%%"===e)return"%";if(n>=s)return e;switch(e){case"%s":return i[n++]+"";case"%d":return+i[n++];case"%j":try{return JSON.stringify(i[n++])}catch(e){return"[Circular]"}default:return e;}}),l=i[n];n<s;l=i[++n])r+=y(l)||!k(l)?" "+l:" "+o(l);return r},i.deprecate=function(e,o){if(x(n.process))return function(){return i.deprecate(e,o).apply(this,arguments)};if(!0===t.noDeprecation)return e;var s=!1;return function(){if(!s){if(t.throwDeprecation)throw new Error(o);else t.traceDeprecation?console.trace(o):console.error(o);s=!0}return e.apply(this,arguments)}};var H={},A;i.debuglog=function(e){if(x(A)&&(A=t.env.NODE_DEBUG||""),e=e.toUpperCase(),!H[e])if(new RegExp("\\b"+e+"\\b","i").test(A)){var n=t.pid;H[e]=function(){var t=i.format.apply(i,arguments);console.error("%s %d: %s",e,n,t)}}else H[e]=function(){};return H[e]},i.inspect=o,o.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},o.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},i.isArray=m,i.isBoolean=g,i.isNull=y,i.isNullOrUndefined=function(e){return null==e},i.isNumber=f,i.isString=b,i.isSymbol=function(e){return"symbol"==typeof e},i.isUndefined=x,i.isRegExp=_,i.isObject=k,i.isDate=j,i.isError=w,i.isFunction=C,i.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||"undefined"==typeof e},i.isBuffer=e("./support/isBuffer");var z=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];i.log=function(){console.log("%s - %s",D(),i.format.apply(i,arguments))},i.inherits=e("inherits"),i._extend=function(e,t){if(!t||!k(t))return e;for(var n=Object.keys(t),o=n.length;o--;)e[n[o]]=t[n[o]];return e}}).call(this,e("_process"),"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{"./support/isBuffer":159,_process:130,inherits:158}],161:[function(e,t){"use strict";function n(e,t){var n=t.jpath;if(!n)throw new Error("createFromJpath: undefined jpath argument");for(var o=0;o<n.length;o++)void 0===e[n[o]]&&(o===n.length-1?e[n[o]]=t.getEmpty():e[n[o]]={}),e=e[n[o]];return 0===n.length&&(e=Object.assign(e,t.getEmpty())),e}function i(e,t){if(e){var n=t.jpath;if(!n)throw new Error("getFromJpath: undefined jpath argument");for(var o=0;o<n.length;o++){if(void 0===e[n[o]])return;e=e[n[o]]}return e}}function o(e){switch(e.encoding){case"base64":return atob(e.content);default:return e.content;}}var s=e("./types"),r=e("./util/defaults"),l=e("./types/common");t.exports={util:l,process:function(e,i,r,l){var a=r.filename,p=o(r),d=s.getType(e),c=n(i,d),u=d.find(c,a),h=d.getProperty(a,r);if(void 0===h)throw new Error(`Could not get property of ${a} (type ${e}`);var m=d.process(a,p);return m[h]={filename:t.exports.getFilename(e,r.filename)},u?Object.assign(u,m,l):(Object.assign(m,l),c.push(m)),i},getType:function(e,t,n){var o=s.getType(e,n);return i(t,o)},getFilename(e,t){var i=/[^\/]*$/.exec(t);i&&(t=i[0]);var n=s.getType(e),o=n.jpath;if(!o)throw new Error("No such type or no jpath");return o.concat(t).join("/")},getEmpty(e,t){var o=s.getAllTypes(e);t||(t={});for(var r=0;r<o.length;r++)n(t,o[r]);return t},defaults(e,i){var n=t.exports.getEmpty(e);return r(!0,i,n),i}}},{"./types":162,"./types/common":163,"./util/defaults":176}],162:[function(e,t){"use strict";var i={types:{common:e("./types/common.js"),default:e("./types/default.js"),nmr:e("./types/nmr.js"),reaction:{general:e("./types/reaction/general.js")},sample:{chromatogram:e("./types/sample/chromatogram.js"),general:e("./types/sample/general.js"),image:e("./types/sample/image.js"),ir:e("./types/sample/ir.js"),mass:e("./types/sample/mass.js"),nmr:e("./types/sample/nmr.js"),physical:e("./types/sample/physical.js"),raman:e("./types/sample/raman.js"),xray:e("./types/sample/xray.js")}}};t.exports={getType(e,t,n){if(!t){for(var t in i.types)if(i.types[t][e])return Object.assign({},i.types.default,i.types[t].default,i.types[t][e],n);}else if(i.types[t][e])return Object.assign({},i.types.default,i.types[t].default,i.types[t][e],n);return Object.assign({},i.types.default)},getAllTypes(e,n){var o=[];for(var s in i.types[e])"default"!=s&&o.push(t.exports.getType(s,e,n));return o}}},{"./types/common.js":163,"./types/default.js":164,"./types/nmr.js":165,"./types/reaction/general.js":166,"./types/sample/chromatogram.js":167,"./types/sample/general.js":168,"./types/sample/image.js":169,"./types/sample/ir.js":170,"./types/sample/mass.js":171,"./types/sample/nmr.js":172,"./types/sample/physical.js":173,"./types/sample/raman.js":174,"./types/sample/xray.js":175}],163:[function(e,t){"use strict";var i=t.exports={};i.getBasename=function(e){var t=e.replace(/.*\//,"");return t.replace(/\.[0-9]+$/,"")},i.getExtension=function(e){var t=i.getBasename(e);return t.replace(/.*\./,"").toLowerCase()},i.getFilename=function(e){for(var t=Object.keys(e),n=0;n<t.length;n++)if(e[t[n]]&&e[t[n]].filename)return e[t[n]].filename},i.basenameFind=function(e,t){var n=i.getBasename(t);return e.find((e)=>{return i.getBasename(i.getFilename(e))===n})},i.getTargetProperty=function(e){switch(i.getExtension(e)){case"jdx":case"dx":case"jcamp":return"jcamp";case"png":case"jpg":case"jpeg":case"tif":case"tiff":return"image";case"cif":return"cif";case"pdb":return"pdb";case"xml":return"xml";case"cdf":case"nc":case"netcdf":return"cdf";case"pdf":return"pdf";default:return"file";}}},{}],164:[function(e,t){"use strict";t.exports={process(){return{}},getEmpty(){return[]}}},{}],165:[function(e,t,i){"use strict";var n=e("nmr-metadata");i.getMetadata=n.parseJcamp,i.getSpectrumType=n.getSpectrumType,i.getNucleusFrom2DExperiment=n.getNucleusFrom2DExperiment},{"nmr-metadata":106}],166:[function(e,t){"use strict";t.exports={jpath:[],getEmpty(){return{code:"",date:Date.now(),procedure:"",products:[],reagents:[],conditions:"",keywords:[],remarks:"",title:"",reactionRXN:"$RXN\n\n\n\n  0  0\n"}}}},{}],167:[function(e,t){"use strict";var i=e("../common");t.exports={jpath:["spectra","chromatogram"],find:i.basenameFind,getProperty:i.getTargetProperty}},{"../common":163}],168:[function(e,t){"use strict";t.exports={jpath:["general"],getEmpty(){return{description:"",title:"",name:[],mf:"",molfile:"",mw:0,keyword:[],sequence:"",kind:""}}}},{}],169:[function(e,t){"use strict";var i=e("../common");t.exports={jpath:["image"],find:i.basenameFind,getProperty:i.getTargetProperty}},{"../common":163}],170:[function(e,t){"use strict";var i=e("../common");t.exports={jpath:["spectra","ir"],find:i.basenameFind,getProperty:i.getTargetProperty}},{"../common":163}],171:[function(e,t){"use strict";var i=e("../common");t.exports={jpath:["spectra","mass"],find:i.basenameFind,getProperty:i.getTargetProperty}},{"../common":163}],172:[function(e,t){"use strict";function i(e){if("undefined"!=typeof e){var t=s.getBasename(e);return t=t.replace(l,"$1"),n.test(e)&&(t=t.replace(o,"")),t}}var n=/[^a-z]fid[^a-z]/i,o=/[^a-z]fid[^a-z]?/i,s=e("../common"),r=e("../nmr");t.exports={find(e,t){var n=i(t);return e.find((e)=>{return i(s.getFilename(e))===n})},getProperty(e){var t=s.getExtension(e);return("jdx"===t||"dx"===t)&&n.test(e)?"jcampFID":s.getTargetProperty(e)},process(e,t){var i=s.getExtension(e),n={};return("jdx"===i||"dx"===i)&&(n=r.getMetadata(t)),n},jpath:["spectra","nmr"]};var l=/(.*)\.(.*)/},{"../common":163,"../nmr":165}],173:[function(e,t){"use strict";t.exports={jpath:["physical"],getEmpty(){return{}}}},{}],174:[function(e,t){"use strict";var i=e("../common");t.exports={jpath:["spectra","raman"],find:i.basenameFind,getProperty:i.getTargetProperty}},{"../common":163}],175:[function(e,t){"use strict";var i=e("../common");t.exports={jpath:["spectra","xray"],find:i.basenameFind,getProperty:i.getTargetProperty}},{"../common":163}],176:[function(e,t){"use strict";var i=Object.prototype.hasOwnProperty,n=Object.prototype.toString,o=function(e){return"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===n.call(e)},s=function(e){if(!e||"[object Object]"!==n.call(e))return!1;var t=i.call(e,"constructor"),o=e.constructor&&e.constructor.prototype&&i.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!t&&!o)return!1;for(var s in e);return"undefined"==typeof s||i.call(e,s)};t.exports=function e(){var t=arguments[0],n=1,i=arguments.length,r=!1,l,a,p,d,c,u;for("boolean"==typeof t?(r=t,t=arguments[1]||{},n=2):("object"!=typeof t&&"function"!=typeof t||null==t)&&(t={});n<i;++n)if(l=arguments[n],null!=l)for(a in l)p=t[a],d=l[a],t!==d&&(r&&d&&(s(d)||(c=o(d)))?(c?(c=!1,u=p&&o(p)?p:[]):u=p&&s(p)?p:{},"undefined"==typeof t[a]?t[a]=e(r,u,d):e(r,u,d)):"undefined"!=typeof d&&"undefined"==typeof t[a]&&(t[a]=d));return t}},{}]},{},[161])(161)});

